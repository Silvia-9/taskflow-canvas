{"ast":null,"code":"import _objectSpread from\"C:/Users/silvi/Desktop/React project/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useRef,useEffect}from'react';import*as XLSX from'xlsx';// html2canvas and jsPDF are expected to be loaded via CDN in the HTML environment,\n// so direct imports are removed to resolve compilation errors.\n// They will be accessed as global variables (html2canvas, jsPDF).\n// Type declarations for global variables\n// Define interfaces for our data structures\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";// Main App Component\nconst App=()=>{// State to manage the currently active tab\nconst[activeTab,setActiveTab]=useState('mom');// Function to track section views in Google Analytics\nconst trackSectionView=sectionName=>{// Track page view for specific section\nif(typeof window!=='undefined'&&window.gtag){window.gtag('event','page_view',{page_title:\"TaskFlow Canvas - \".concat(sectionName),page_location:\"\".concat(window.location.origin).concat(window.location.pathname,\"#\").concat(sectionName.toLowerCase().replace(' ','-')),custom_parameter_1:sectionName});// Track custom event for section engagement\nwindow.gtag('event','section_view',{event_category:'Navigation',event_label:sectionName,custom_parameter_1:'tab_navigation'});}};// Enhanced function to handle tab changes with analytics\nconst handleTabChange=(tabName,sectionLabel)=>{setActiveTab(tabName);trackSectionView(sectionLabel);};// State to store Minutes of Meeting data\nconst[momData,setMomData]=useState([]);// State to store Timeline data\nconst[projectScheduleData,setProjectScheduleData]=useState([]);// State to store Task Board data\nconst[taskBoardData,setTaskBoardData]=useState([]);// State to store Budget data\nconst[budgetData,setBudgetData]=useState([]);// State to store Risk Register data\nconst[riskRegisterData,setRiskRegisterData]=useState([]);// State to manage temporary success messages for downloads/emails\nconst[message,setMessage]=useState('');// Refs to target the content areas for PDF generation\nconst momContentRef=useRef(null);const projectScheduleContentRef=useRef(null);const taskBoardContentRef=useRef(null);const budgetContentRef=useRef(null);const riskRegisterContentRef=useRef(null);// Effect to clear messages after a short delay\nuseEffect(()=>{if(message){const timer=setTimeout(()=>{setMessage('');},3000);// Message disappears after 3 seconds\nreturn()=>clearTimeout(timer);}},[message]);// Function to handle adding new Minutes of Meeting\nconst handleAddMom=newMom=>{setMomData(prev=>[...prev,_objectSpread(_objectSpread({},newMom),{},{id:Date.now()})]);setMessage('The meeting note has been successfully added!');// Track user engagement\nif(typeof window!=='undefined'&&window.gtag){window.gtag('event','item_created',{event_category:'User Engagement',event_label:'Meeting Notes',custom_parameter_1:'content_creation'});}};// Function to handle adding new Timeline\nconst handleAddProjectSchedule=newSchedule=>{setProjectScheduleData(prev=>[...prev,_objectSpread(_objectSpread({},newSchedule),{},{id:Date.now()})]);setMessage('The project schedule has been successfully updated!');// Track user engagement\nif(typeof window!=='undefined'&&window.gtag){window.gtag('event','item_created',{event_category:'User Engagement',event_label:'Gantt Chart',custom_parameter_1:'content_creation'});}};// Function to handle adding new Task\nconst handleAddTask=newTask=>{setTaskBoardData(prev=>[...prev,_objectSpread(_objectSpread({},newTask),{},{id:Date.now()})]);setMessage('The task has been successfully added!');// Track user engagement\nif(typeof window!=='undefined'&&window.gtag){window.gtag('event','item_created',{event_category:'User Engagement',event_label:'Kanban Board',custom_parameter_1:'content_creation'});}};// Function to handle updating task status\nconst handleUpdateTaskStatus=(taskId,newStatus)=>{setTaskBoardData(prev=>prev.map(task=>task.id===taskId?_objectSpread(_objectSpread({},task),{},{status:newStatus}):task));setMessage('The task status has been successfully updated!');};// Function to handle adding new Budget\nconst handleAddBudget=newBudget=>{setBudgetData(prev=>[...prev,_objectSpread(_objectSpread({},newBudget),{},{id:Date.now()})]);setMessage('The budget has been successfully added!');// Track user engagement\nif(typeof window!=='undefined'&&window.gtag){window.gtag('event','item_created',{event_category:'User Engagement',event_label:'Budget Calculator',custom_parameter_1:'content_creation'});}};// Function to handle adding new Risk Register\nconst handleAddRiskRegister=newRiskRegister=>{setRiskRegisterData(prev=>[...prev,_objectSpread(_objectSpread({},newRiskRegister),{},{id:Date.now()})]);setMessage('The risk register has been successfully added!');// Track user engagement\nif(typeof window!=='undefined'&&window.gtag){window.gtag('event','item_created',{event_category:'User Engagement',event_label:'Risk Log',custom_parameter_1:'content_creation'});}};// Delete handler functions\nconst handleDeleteMom=id=>{setMomData(prev=>prev.filter(mom=>mom.id!==id));setMessage('The meeting note has been successfully deleted!');};const handleDeleteProjectSchedule=id=>{setProjectScheduleData(prev=>prev.filter(schedule=>schedule.id!==id));setMessage('The project schedule has been successfully deleted!');};const handleDeleteTask=id=>{setTaskBoardData(prev=>prev.filter(task=>task.id!==id));setMessage('The task has been successfully deleted!');};const handleDeleteBudget=id=>{setBudgetData(prev=>prev.filter(budget=>budget.id!==id));setMessage('The budget has been successfully deleted!');};const handleDeleteRiskRegister=id=>{setRiskRegisterData(prev=>prev.filter(register=>register.id!==id));setMessage('The risk register has been successfully deleted!');};// Function to generate and download PDF with unified text-based format\nconst downloadPdf=async(contentRef,filename)=>{setMessage('Generating PDF...');// Track PDF download attempt\nif(typeof window!=='undefined'&&window.gtag){window.gtag('event','file_download',{event_category:'Downloads',event_label:\"PDF - \".concat(filename),file_extension:'pdf',custom_parameter_1:'pdf_generation'});}try{// Use unified text-based PDF generation for all sections\nawait generateTextBasedPDF(filename,contentRef);// Track successful PDF generation\nif(typeof window!=='undefined'&&window.gtag){window.gtag('event','download_complete',{event_category:'Downloads',event_label:\"PDF Success - \".concat(filename),custom_parameter_1:'pdf_success'});}}catch(error){console.error('Error generating PDF:',error);setMessage(\"\\u274C Failed to generate PDF: \".concat(error instanceof Error?error.message:'Unknown error'));// Track PDF generation failure\nif(typeof window!=='undefined'&&window.gtag){window.gtag('event','download_error',{event_category:'Errors',event_label:\"PDF Error - \".concat(filename),custom_parameter_1:'pdf_error'});}}};// Fallback text-based PDF generation when html2canvas fails\nconst generateTextBasedPDF=async(filename,contentRef)=>{try{// Get jsPDF constructor\nlet jsPDFConstructor=null;if(typeof window.jsPDF==='function'){jsPDFConstructor=window.jsPDF;}else if(window.jsPDF&&typeof window.jsPDF.jsPDF==='function'){jsPDFConstructor=window.jsPDF.jsPDF;}else if(window.jsPDF&&typeof window.jsPDF.default==='function'){jsPDFConstructor=window.jsPDF.default;}else if(typeof window.jspdf==='object'&&window.jspdf.jsPDF){jsPDFConstructor=window.jspdf.jsPDF;}if(!jsPDFConstructor){setMessage('❌ Error: jsPDF library is not loaded for fallback generation.');return;}const currentDate=new Date().toISOString().split('T')[0];const filenameWithDate=\"\".concat(filename,\"_\").concat(currentDate);const pdf=new jsPDFConstructor('p','mm','a4');const pageWidth=210;const pageHeight=297;const margin=15;const lineHeight=6;let yPosition=margin;// Helper function to add text with word wrapping\nconst addWrappedText=function(text,x,y,maxWidth){let fontSize=arguments.length>4&&arguments[4]!==undefined?arguments[4]:10;pdf.setFontSize(fontSize);const lines=pdf.splitTextToSize(text,maxWidth);lines.forEach((line,index)=>{if(y+index*lineHeight>pageHeight-margin){pdf.addPage();y=margin;}pdf.text(line,x,y+index*lineHeight);});return y+lines.length*lineHeight+3;};// Add header\npdf.setFontSize(18);pdf.setTextColor(40,116,166);if(filename.includes('Timeline')){pdf.text('PROJECT SCHEDULE REPORT',pageWidth/2,yPosition,{align:'center'});}else if(filename.includes('MeetingNotes')){pdf.text('MEETING REPORT',pageWidth/2,yPosition,{align:'center'});}else if(filename.includes('TaskBoard')){pdf.text('KANBAN BOARD REPORT',pageWidth/2,yPosition,{align:'center'});}else if(filename.includes('Budget')){pdf.text('PROJECT BUDGET REPORT',pageWidth/2,yPosition,{align:'center'});}else if(filename.includes('Risk')){pdf.text('RISK REGISTER REPORT',pageWidth/2,yPosition,{align:'center'});}else{pdf.text('PROJECT REPORT',pageWidth/2,yPosition,{align:'center'});}yPosition+=10;pdf.setFontSize(10);pdf.setTextColor(100,100,100);pdf.text(\"Generated on: \".concat(new Date().toLocaleDateString()),pageWidth/2,yPosition,{align:'center'});yPosition+=15;pdf.setTextColor(0,0,0);// Add content based on data type\nif(filename.includes('Timeline')&&projectScheduleData.length>0){projectScheduleData.forEach((schedule,index)=>{if(yPosition>pageHeight-50){pdf.addPage();yPosition=margin;}// Project header\npdf.setFontSize(14);pdf.setTextColor(40,116,166);yPosition=addWrappedText(\"Project: \".concat(schedule.projectName||\"Project \".concat(index+1)),margin,yPosition,pageWidth-2*margin,14);pdf.setFontSize(10);pdf.setTextColor(0,0,0);yPosition=addWrappedText(\"Duration: \".concat(schedule.startDate,\" to \").concat(schedule.endDate),margin,yPosition,pageWidth-2*margin);yPosition+=5;// Tasks\npdf.setFontSize(12);pdf.setTextColor(0,0,0);yPosition=addWrappedText('Tasks:',margin,yPosition,pageWidth-2*margin,12);schedule.tasks.forEach((task,taskIndex)=>{if(yPosition>pageHeight-30){pdf.addPage();yPosition=margin;}pdf.setFontSize(10);yPosition=addWrappedText(\"\".concat(taskIndex+1,\". \").concat(task.description),margin+10,yPosition,pageWidth-2*margin-10);yPosition=addWrappedText(\"   Start: \".concat(task.taskStartDate,\" | End: \").concat(task.taskEndDate),margin+10,yPosition,pageWidth-2*margin-10);yPosition=addWrappedText(\"   Status: \".concat(task.status,\" | Assigned: \").concat(task.assignedTo),margin+10,yPosition,pageWidth-2*margin-10);yPosition+=3;});yPosition+=10;});}else if(filename.includes('MeetingNotes')&&momData.length>0){momData.forEach((mom,index)=>{if(yPosition>pageHeight-50){pdf.addPage();yPosition=margin;}pdf.setFontSize(14);pdf.setTextColor(40,116,166);yPosition=addWrappedText(\"Meeting: \".concat(mom.title),margin,yPosition,pageWidth-2*margin,14);pdf.setFontSize(10);pdf.setTextColor(0,0,0);yPosition=addWrappedText(\"Date: \".concat(mom.date,\" | Time: \").concat(mom.time),margin,yPosition,pageWidth-2*margin);yPosition=addWrappedText(\"Attendees: \".concat(mom.attendees),margin,yPosition,pageWidth-2*margin);yPosition=addWrappedText(\"Agenda: \".concat(mom.agenda),margin,yPosition,pageWidth-2*margin);yPosition=addWrappedText(\"Discussion: \".concat(mom.discussion),margin,yPosition,pageWidth-2*margin);if(mom.actionItems.length>0){yPosition+=3;pdf.setFontSize(12);yPosition=addWrappedText('Action Items:',margin,yPosition,pageWidth-2*margin,12);mom.actionItems.forEach((item,itemIndex)=>{pdf.setFontSize(10);yPosition=addWrappedText(\"\".concat(itemIndex+1,\". \").concat(item.task,\" (Owner: \").concat(item.owner,\", Due: \").concat(item.dueDate,\")\"),margin+10,yPosition,pageWidth-2*margin-10);});}yPosition=addWrappedText(\"Next Meeting: \".concat(mom.nextMeeting),margin,yPosition,pageWidth-2*margin);yPosition+=10;});}else if(filename.includes('TaskBoard')&&taskBoardData.length>0){// Group tasks by status for better organization\nconst statusColumns=['Not Started','In Progress','Review','Done'];statusColumns.forEach(status=>{const tasksInStatus=taskBoardData.filter(task=>task.status===status);if(tasksInStatus.length>0){if(yPosition>pageHeight-50){pdf.addPage();yPosition=margin;}// Status header\npdf.setFontSize(14);pdf.setTextColor(40,116,166);yPosition=addWrappedText(\"\".concat(status,\" (\").concat(tasksInStatus.length,\" tasks)\"),margin,yPosition,pageWidth-2*margin,14);yPosition+=5;tasksInStatus.forEach((task,taskIndex)=>{if(yPosition>pageHeight-40){pdf.addPage();yPosition=margin;}pdf.setFontSize(12);pdf.setTextColor(0,0,0);yPosition=addWrappedText(\"\".concat(taskIndex+1,\". \").concat(task.title),margin+10,yPosition,pageWidth-2*margin-10,12);pdf.setFontSize(10);yPosition=addWrappedText(\"   Description: \".concat(task.description),margin+10,yPosition,pageWidth-2*margin-10);yPosition=addWrappedText(\"   Assigned To: \".concat(task.assignedTo),margin+10,yPosition,pageWidth-2*margin-10);yPosition=addWrappedText(\"   Priority: \".concat(task.priority,\" | Due Date: \").concat(task.dueDate),margin+10,yPosition,pageWidth-2*margin-10);if(task.tags&&task.tags.length>0){yPosition=addWrappedText(\"   Category: \".concat(task.tags.join(', ')),margin+10,yPosition,pageWidth-2*margin-10);}yPosition+=3;});yPosition+=8;}});}else if(filename.includes('Budget')&&budgetData.length>0){budgetData.forEach((budget,index)=>{if(yPosition>pageHeight-50){pdf.addPage();yPosition=margin;}// Project Budget Report Header\npdf.setFontSize(16);pdf.setTextColor(40,116,166);yPosition=addWrappedText(\"PROJECT BUDGET REPORT\",margin,yPosition,pageWidth-2*margin,16);yPosition+=5;pdf.setFontSize(14);pdf.setTextColor(0,0,0);yPosition=addWrappedText(\"Project: \".concat(budget.projectName),margin,yPosition,pageWidth-2*margin,14);yPosition+=8;// Calculate totals and EVM metrics\nconst totalEstimated=budget.items.reduce((sum,item)=>sum+item.estimatedCost,0);const totalActual=budget.items.reduce((sum,item)=>sum+item.actualCost,0);const totalEarnedValue=budget.items.reduce((sum,item)=>sum+item.earnedValue,0);const scheduleVariance=totalEarnedValue-totalEstimated;const costVariance=totalEarnedValue-totalActual;const spi=totalEstimated!==0?totalEarnedValue/totalEstimated:0;const cpi=totalActual!==0?totalEarnedValue/totalActual:0;const variance=totalActual-totalEstimated;// Budget Summary Section\npdf.setFontSize(13);pdf.setTextColor(40,116,166);yPosition=addWrappedText('BUDGET SUMMARY',margin,yPosition,pageWidth-2*margin,13);yPosition+=3;// Add underline for section\npdf.setDrawColor(40,116,166);pdf.setLineWidth(0.5);pdf.line(margin,yPosition,pageWidth-margin,yPosition);yPosition+=5;pdf.setFontSize(11);pdf.setTextColor(0,0,0);yPosition=addWrappedText(\"Budget at Completion (BAC): $\".concat(budget.totalBudget.toLocaleString()),margin+5,yPosition,pageWidth-2*margin-5,11);yPosition=addWrappedText(\"Planned Value (PV): $\".concat(totalEstimated.toLocaleString()),margin+5,yPosition,pageWidth-2*margin-5,11);yPosition=addWrappedText(\"Earned Value (EV): $\".concat(totalEarnedValue.toLocaleString()),margin+5,yPosition,pageWidth-2*margin-5,11);yPosition=addWrappedText(\"Actual Cost (AC): $\".concat(totalActual.toLocaleString()),margin+5,yPosition,pageWidth-2*margin-5,11);yPosition+=8;// EVM Metrics Section\npdf.setFontSize(13);pdf.setTextColor(40,116,166);yPosition=addWrappedText('EARNED VALUE MANAGEMENT (EVM) METRICS',margin,yPosition,pageWidth-2*margin,13);yPosition+=3;// Add underline for section\npdf.setDrawColor(40,116,166);pdf.setLineWidth(0.5);pdf.line(margin,yPosition,pageWidth-margin,yPosition);yPosition+=5;// Variance Metrics\npdf.setFontSize(12);pdf.setTextColor(70,70,70);yPosition=addWrappedText('Variance Analysis:',margin+5,yPosition,pageWidth-2*margin-5,12);pdf.setFontSize(10);pdf.setTextColor(0,0,0);yPosition=addWrappedText(\"\\u2022 Schedule Variance (SV): $\".concat(scheduleVariance.toLocaleString(),\" \").concat(scheduleVariance>=0?'(Ahead of Schedule)':'(Behind Schedule)'),margin+10,yPosition,pageWidth-2*margin-10);yPosition=addWrappedText(\"\\u2022 Cost Variance (CV): $\".concat(costVariance.toLocaleString(),\" \").concat(costVariance>=0?'(Under Budget)':'(Over Budget)'),margin+10,yPosition,pageWidth-2*margin-10);yPosition+=3;// Performance Indices\npdf.setFontSize(12);pdf.setTextColor(70,70,70);yPosition=addWrappedText('Performance Indices:',margin+5,yPosition,pageWidth-2*margin-5,12);pdf.setFontSize(10);pdf.setTextColor(0,0,0);yPosition=addWrappedText(\"\\u2022 Schedule Performance Index (SPI): \".concat(spi.toFixed(3),\" \").concat(spi>=1?'(On/Ahead Schedule)':'(Behind Schedule)'),margin+10,yPosition,pageWidth-2*margin-10);yPosition=addWrappedText(\"\\u2022 Cost Performance Index (CPI): \".concat(cpi.toFixed(3),\" \").concat(cpi>=1?'(On/Under Budget)':'(Over Budget)'),margin+10,yPosition,pageWidth-2*margin-10);yPosition+=8;// Project Status Summary\npdf.setFontSize(12);pdf.setTextColor(70,70,70);yPosition=addWrappedText('Project Status:',margin+5,yPosition,pageWidth-2*margin-5,12);pdf.setFontSize(10);pdf.setTextColor(0,0,0);const projectStatus=spi>=1&&cpi>=1?'ON TRACK':spi<1&&cpi>=1?'BEHIND SCHEDULE':spi>=1&&cpi<1?'OVER BUDGET':'CRITICAL - BEHIND SCHEDULE & OVER BUDGET';yPosition=addWrappedText(\"\\u2022 Overall Status: \".concat(projectStatus),margin+10,yPosition,pageWidth-2*margin-10);yPosition=addWrappedText(\"\\u2022 Budget Remaining: $\".concat((budget.totalBudget-totalActual).toLocaleString()),margin+10,yPosition,pageWidth-2*margin-10);yPosition+=10;// Detailed Cost Categories Section\nif(yPosition>pageHeight-60){pdf.addPage();yPosition=margin;}pdf.setFontSize(13);pdf.setTextColor(40,116,166);yPosition=addWrappedText('DETAILED COST CATEGORIES BREAKDOWN',margin,yPosition,pageWidth-2*margin,13);yPosition+=3;// Add underline for section\npdf.setDrawColor(40,116,166);pdf.setLineWidth(0.5);pdf.line(margin,yPosition,pageWidth-margin,yPosition);yPosition+=5;budget.items.forEach((item,itemIndex)=>{if(yPosition>pageHeight-45){pdf.addPage();yPosition=margin;}// Item header\npdf.setFontSize(11);pdf.setTextColor(70,70,70);yPosition=addWrappedText(\"\".concat(itemIndex+1,\". \").concat(item.category.toUpperCase()),margin+5,yPosition,pageWidth-2*margin-5,11);pdf.setFontSize(10);pdf.setTextColor(0,0,0);yPosition=addWrappedText(\"   Description: \".concat(item.description),margin+10,yPosition,pageWidth-2*margin-10);// Financial details in structured format\nyPosition=addWrappedText(\"   \\u2022 Planned Value (PV): $\".concat(item.estimatedCost.toLocaleString()),margin+10,yPosition,pageWidth-2*margin-10);yPosition=addWrappedText(\"   \\u2022 Earned Value (EV): $\".concat(item.earnedValue.toLocaleString()),margin+10,yPosition,pageWidth-2*margin-10);yPosition=addWrappedText(\"   \\u2022 Actual Cost (AC): $\".concat(item.actualCost.toLocaleString()),margin+10,yPosition,pageWidth-2*margin-10);// Item-level variance\nconst itemSV=item.earnedValue-item.estimatedCost;const itemCV=item.earnedValue-item.actualCost;yPosition=addWrappedText(\"   \\u2022 Schedule Variance: $\".concat(itemSV.toLocaleString(),\" \").concat(itemSV>=0?'(Ahead)':'(Behind)'),margin+10,yPosition,pageWidth-2*margin-10);yPosition=addWrappedText(\"   \\u2022 Cost Variance: $\".concat(itemCV.toLocaleString(),\" \").concat(itemCV>=0?'(Under Budget)':'(Over Budget)'),margin+10,yPosition,pageWidth-2*margin-10);if(item.notes&&item.notes.trim()){yPosition=addWrappedText(\"   \\u2022 Notes: \".concat(item.notes),margin+10,yPosition,pageWidth-2*margin-10);}yPosition+=5;});// Add footer section\nyPosition+=5;pdf.setFontSize(8);pdf.setTextColor(100,100,100);yPosition=addWrappedText(\"Report generated on \".concat(new Date().toLocaleDateString(),\" at \").concat(new Date().toLocaleTimeString()),margin,yPosition,pageWidth-2*margin,8);yPosition=addWrappedText(\"Page \".concat(pdf.internal.getNumberOfPages(),\" | TaskFlow Canvas Budget Report\"),margin,yPosition,pageWidth-2*margin,8);if(index<budgetData.length-1){pdf.addPage();yPosition=margin;}});}else if(filename.includes('Risk')&&riskRegisterData.length>0){riskRegisterData.forEach((riskRegister,index)=>{if(yPosition>pageHeight-50){pdf.addPage();yPosition=margin;}// Risk register header\npdf.setFontSize(14);pdf.setTextColor(40,116,166);yPosition=addWrappedText(\"Project: \".concat(riskRegister.projectName),margin,yPosition,pageWidth-2*margin,14);pdf.setFontSize(12);pdf.setTextColor(0,0,0);yPosition=addWrappedText(\"Total Risks: \".concat(riskRegister.risks.length),margin,yPosition,pageWidth-2*margin,12);yPosition+=5;// Risk statistics\nconst riskStats={open:riskRegister.risks.filter(r=>r.status==='Open').length,mitigated:riskRegister.risks.filter(r=>r.status==='Mitigated').length,closed:riskRegister.risks.filter(r=>r.status==='Closed').length,high:riskRegister.risks.filter(r=>r.probability==='High'||r.impact==='High').length};pdf.setFontSize(10);yPosition=addWrappedText(\"Open: \".concat(riskStats.open,\" | Mitigated: \").concat(riskStats.mitigated,\" | Closed: \").concat(riskStats.closed),margin,yPosition,pageWidth-2*margin);yPosition=addWrappedText(\"High Priority Risks: \".concat(riskStats.high),margin,yPosition,pageWidth-2*margin);yPosition+=8;// Group risks by status\nconst riskStatuses=['Open','Mitigated','Closed'];riskStatuses.forEach(status=>{const risksInStatus=riskRegister.risks.filter(risk=>risk.status===status);if(risksInStatus.length>0){if(yPosition>pageHeight-40){pdf.addPage();yPosition=margin;}pdf.setFontSize(12);pdf.setTextColor(40,116,166);yPosition=addWrappedText(\"\".concat(status,\" Risks (\").concat(risksInStatus.length,\")\"),margin,yPosition,pageWidth-2*margin,12);yPosition+=3;risksInStatus.forEach((risk,riskIndex)=>{if(yPosition>pageHeight-35){pdf.addPage();yPosition=margin;}pdf.setFontSize(10);pdf.setTextColor(0,0,0);yPosition=addWrappedText(\"\".concat(riskIndex+1,\". \").concat(risk.riskDescription),margin+10,yPosition,pageWidth-2*margin-10);yPosition=addWrappedText(\"   Category: \".concat(risk.category,\" | Owner: \").concat(risk.owner),margin+10,yPosition,pageWidth-2*margin-10);yPosition=addWrappedText(\"   Probability: \".concat(risk.probability,\" | Impact: \").concat(risk.impact),margin+10,yPosition,pageWidth-2*margin-10);yPosition=addWrappedText(\"   Mitigation: \".concat(risk.mitigation),margin+10,yPosition,pageWidth-2*margin-10);yPosition+=3;});yPosition+=5;}});yPosition+=10;});}else{// Generic fallback for other types or empty data\npdf.setFontSize(12);pdf.setTextColor(100,100,100);yPosition=addWrappedText('No data available for this section.',margin,yPosition,pageWidth-2*margin,12);yPosition+=10;yPosition=addWrappedText('Content could not be captured automatically. Please check the application and try again.',margin,yPosition,pageWidth-2*margin);yPosition=addWrappedText('This is a fallback text-based PDF. For full visual content, please ensure your browser supports html2canvas.',margin,yPosition,pageWidth-2*margin);}pdf.save(\"\".concat(filenameWithDate,\".pdf\"));setMessage(\"\\uD83D\\uDCC4 Fallback PDF generated successfully! File: \".concat(filenameWithDate,\".pdf\"));}catch(error){console.error('Error in fallback PDF generation:',error);setMessage(\"\\u274C Failed to generate fallback PDF: \".concat(error instanceof Error?error.message:'Unknown error'));}};// Function to generate and download Excel file\nconst downloadExcel=(data,filename,sheetName)=>{try{setMessage('Generating Excel file...');// Track Excel download attempt\nif(typeof window!=='undefined'&&window.gtag){window.gtag('event','file_download',{event_category:'Downloads',event_label:\"Excel - \".concat(filename),file_extension:'xlsx',custom_parameter_1:'excel_generation'});}// Generate current date for filename\nconst currentDate=new Date().toISOString().split('T')[0];// Format: YYYY-MM-DD\nconst filenameWithDate=\"\".concat(filename,\"_\").concat(currentDate);let worksheetData=[];if(data.length===0){setMessage('No data available for Excel export.');// Track Excel generation failure\nif(typeof window!=='undefined'&&window.gtag){window.gtag('event','download_error',{event_category:'Errors',event_label:\"Excel Error - \".concat(filename,\" (No Data)\"),custom_parameter_1:'excel_no_data'});}return;}// Format data based on type\nif(filename.includes('MeetingNotes')){const momData=data;worksheetData=momData.map(mom=>({'Meeting Title':mom.title,'Date':mom.date,'Time':mom.time,'Attendees':mom.attendees,'Agenda':mom.agenda,'Discussion':mom.discussion,'Future Actions':mom.actionItems.map(item=>\"\".concat(item.task,\" (Owner: \").concat(item.owner,\", Due: \").concat(item.dueDate,\")\")).join('; '),'Next Meeting':mom.nextMeeting}));}else if(filename.includes('ProjectSchedule')||filename.includes('ProjectTimeline')){const scheduleData=data;worksheetData=[];scheduleData.forEach(schedule=>{schedule.tasks.forEach(task=>{worksheetData.push({'Project Name':schedule.projectName,'Project Start':schedule.startDate,'Project End':schedule.endDate,'Task Description':task.description,'Task Start Date':task.taskStartDate,'Task End Date':task.taskEndDate,'Status':task.status,'Assigned To':task.assignedTo});});});}else if(filename.includes('TaskBoard')){const taskData=data;worksheetData=taskData.map(task=>({'Title':task.title,'Description':task.description,'Assigned To':task.assignedTo,'Priority':task.priority,'Status':task.status,'Due Date':task.dueDate,'Category':task.tags.join(', ')}));}else if(filename.includes('ProjectBudget')){const budgetData=data;worksheetData=[];budgetData.forEach(budget=>{// Calculate EVM metrics for the project\nconst totalPV=budget.items.reduce((sum,item)=>sum+item.estimatedCost,0);const totalEV=budget.items.reduce((sum,item)=>sum+item.earnedValue,0);const totalAC=budget.items.reduce((sum,item)=>sum+item.actualCost,0);const scheduleVariance=totalEV-totalPV;const costVariance=totalEV-totalAC;const spi=totalPV!==0?totalEV/totalPV:0;const cpi=totalAC!==0?totalEV/totalAC:0;// Add budget summary with EVM metrics\nworksheetData.push({'Project Name':budget.projectName,'Budget at Completion (BAC)':budget.totalBudget,'Category':'BUDGET SUMMARY','Description':'Total Project Budget','Planned Value (PV)':totalPV,'Earned Value (EV)':totalEV,'Actual Cost (AC)':totalAC,'Schedule Variance (SV)':scheduleVariance,'Cost Variance (CV)':costVariance,'Schedule Performance Index (SPI)':spi.toFixed(2),'Cost Performance Index (CPI)':cpi.toFixed(2),'Notes':'EVM Summary'});// Add individual items\nbudget.items.forEach(item=>{worksheetData.push({'Project Name':budget.projectName,'Budget at Completion (BAC)':'','Category':item.category,'Description':item.description,'Planned Value (PV)':item.estimatedCost,'Earned Value (EV)':item.earnedValue,'Actual Cost (AC)':item.actualCost,'Schedule Variance (SV)':item.earnedValue-item.estimatedCost,'Cost Variance (CV)':item.earnedValue-item.actualCost,'Schedule Performance Index (SPI)':item.estimatedCost!==0?(item.earnedValue/item.estimatedCost).toFixed(2):'0.00','Cost Performance Index (CPI)':item.actualCost!==0?(item.earnedValue/item.actualCost).toFixed(2):'0.00','Notes':item.notes});});});}else if(filename.includes('RiskRegister')){const riskData=data;worksheetData=[];riskData.forEach(register=>{register.risks.forEach(risk=>{const levels={Low:1,Medium:2,High:3};const score=levels[risk.probability]*levels[risk.impact];const riskLevel=score>=6?'High':score>=4?'Medium':'Low';worksheetData.push({'Project Name':register.projectName,'Risk Description':risk.riskDescription,'Category':risk.category,'Probability':risk.probability,'Impact':risk.impact,'Risk Level':riskLevel,'Owner':risk.owner,'Status':risk.status,'Mitigation Strategy':risk.mitigation});});});}// Create workbook and worksheet\nconst workbook=XLSX.utils.book_new();const worksheet=XLSX.utils.json_to_sheet(worksheetData);// Auto-adjust column widths\nconst columnWidths=Object.keys(worksheetData[0]||{}).map(key=>({wch:Math.max(key.length,...worksheetData.map(row=>String(row[key]||'').length))}));worksheet['!cols']=columnWidths;// Add worksheet to workbook\nXLSX.utils.book_append_sheet(workbook,worksheet,sheetName);// Save the file\nXLSX.writeFile(workbook,\"\".concat(filenameWithDate,\".xlsx\"));setMessage(\"\".concat(filenameWithDate,\".xlsx downloaded successfully!\"));// Track successful Excel generation\nif(typeof window!=='undefined'&&window.gtag){window.gtag('event','download_complete',{event_category:'Downloads',event_label:\"Excel Success - \".concat(filename),custom_parameter_1:'excel_success'});}}catch(error){console.error('Error generating Excel:',error);setMessage(\"Failed to generate Excel: \".concat(error instanceof Error?error.message:'Unknown error'));// Track Excel generation failure\nif(typeof window!=='undefined'&&window.gtag){window.gtag('event','download_error',{event_category:'Errors',event_label:\"Excel Error - \".concat(filename),custom_parameter_1:'excel_error'});}}};// Function to handle email sending (opens mailto link)\nconst sendEmail=(content,subject,filename)=>{// Enhanced plain text representation of the content\nlet emailBody=\"\".concat(subject,\"\\n\").concat('='.repeat(subject.length),\"\\n\\n\");if(typeof content==='string'){emailBody+=content;}else if(Array.isArray(content)){// Special handling for Timeline data\nif(filename.includes('Timeline')&&content.length>0){const scheduleData=content;scheduleData.forEach((schedule,scheduleIndex)=>{emailBody+=\"\\uD83D\\uDCCB PROJECT: \".concat(schedule.projectName||\"Project \".concat(scheduleIndex+1),\"\\n\");emailBody+=\"\\uD83D\\uDCC5 Duration: \".concat(schedule.startDate,\" to \").concat(schedule.endDate,\"\\n\");emailBody+=\"\\uD83D\\uDCCA Total Tasks: \".concat(schedule.tasks.length,\"\\n\\n\");if(schedule.tasks.length>0){emailBody+=\"TASKS BREAKDOWN:\\n\";emailBody+=\"\".concat('-'.repeat(50),\"\\n\");schedule.tasks.forEach((task,taskIndex)=>{const statusIcon=task.status==='Completed'?'✅':task.status==='In Progress'?'🔄':task.status==='Blocked'?'🚫':'⏸️';emailBody+=\"\".concat(taskIndex+1,\". \").concat(statusIcon,\" \").concat(task.description,\"\\n\");emailBody+=\"   \\uD83D\\uDCC6 Start: \".concat(task.taskStartDate||'Not set',\"\\n\");emailBody+=\"   \\uD83D\\uDCC6 End: \".concat(task.taskEndDate||'Not set',\"\\n\");emailBody+=\"   \\uD83D\\uDC64 Assigned: \".concat(task.assignedTo||'Unassigned',\"\\n\");emailBody+=\"   \\uD83D\\uDCCA Status: \".concat(task.status,\"\\n\\n\");});// Summary statistics\nconst completedTasks=schedule.tasks.filter(t=>t.status==='Completed').length;const inProgressTasks=schedule.tasks.filter(t=>t.status==='In Progress').length;const blockedTasks=schedule.tasks.filter(t=>t.status==='Blocked').length;const notStartedTasks=schedule.tasks.filter(t=>t.status==='Not Started').length;emailBody+=\"PROGRESS SUMMARY:\\n\";emailBody+=\"\".concat('-'.repeat(30),\"\\n\");emailBody+=\"\\u2705 Completed: \".concat(completedTasks,\"/\").concat(schedule.tasks.length,\" (\").concat(Math.round(completedTasks/schedule.tasks.length*100),\"%)\\n\");emailBody+=\"\\uD83D\\uDD04 In Progress: \".concat(inProgressTasks,\"\\n\");emailBody+=\"\\uD83D\\uDEAB Blocked: \".concat(blockedTasks,\"\\n\");emailBody+=\"\\u23F8\\uFE0F Not Started: \".concat(notStartedTasks,\"\\n\");}if(scheduleIndex<scheduleData.length-1){emailBody+=\"\\n\".concat('='.repeat(80),\"\\n\\n\");}});}else{// Default handling for other content types\ncontent.forEach((item,index)=>{emailBody+=filename.includes('MeetingNotes')?\"Meeting no. \".concat(index+1,\":\\n\"):\"ENTRY \".concat(index+1,\":\\n\");emailBody+=\"\".concat('-'.repeat(20),\"\\n\");for(const key in item){if(key!=='id'&&item[key]){// Format key names for readability in email\nconst formattedKey=key.replace(/([A-Z])/g,' $1').replace(/^./,str=>str.toUpperCase());// Special handling for action items\nif(key==='actionItems'&&Array.isArray(item[key])){const actionItems=item[key];if(actionItems.length>0){emailBody+=\"\".concat(formattedKey,\":\\n\");actionItems.forEach((actionItem,actionIndex)=>{emailBody+=\"  \".concat(actionIndex+1,\". \").concat(actionItem.task,\" (Owner: \").concat(actionItem.owner,\", Due: \").concat(actionItem.dueDate,\")\\n\");});}}// Special handling for tasks array in ProjectSchedule\nelse if(key==='tasks'&&Array.isArray(item[key])){const tasks=item[key];if(tasks.length>0){emailBody+=\"\".concat(formattedKey,\" (\").concat(tasks.length,\" tasks):\\n\");tasks.forEach((task,taskIndex)=>{emailBody+=\"  \".concat(taskIndex+1,\". \").concat(task.description,\" [\").concat(task.status,\"] - \").concat(task.assignedTo||'Unassigned',\"\\n\");});}}else{emailBody+=\"\".concat(formattedKey,\": \").concat(item[key],\"\\n\");}}}emailBody+='\\n---\\n\\n';// Separator for multiple entries\n});}}// Add footer with generation info\nemailBody+=\"\\n\\n\\uD83D\\uDCE7 Generated from TaskFlow Canvas\\n\\uD83C\\uDF10 Visit at: https://silvia-9.github.io/taskflow-canvas/\\n\\uD83D\\uDCC5 Generated on \".concat(new Date().toLocaleDateString(),\"\\n\");// Encode the subject and body for the mailto link\nconst mailtoLink=\"mailto:?subject=\".concat(encodeURIComponent(subject),\"&body=\").concat(encodeURIComponent(emailBody));// Track email sending attempt\nif(typeof window!=='undefined'&&window.gtag){window.gtag('event','email_share',{event_category:'Sharing',event_label:\"Email - \".concat(filename),method:'email',custom_parameter_1:'email_client_opened'});}window.open(mailtoLink,'_blank');// Open in a new tab\nsetMessage(\"\\uD83D\\uDCE7 Email client opened with \".concat(subject,\". Review and send when ready!\"));};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-br from-indigo-100 via-indigo-50 to-purple-100 font-inter text-gray-800 p-4 sm:p-6 lg:p-8 rounded-lg shadow-xl\",children:[/*#__PURE__*/_jsx(\"style\",{children:\"\\n                @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');\\n                body {\\n                    font-family: 'Inter', sans-serif;\\n                    background: linear-gradient(135deg,rgb(231, 153, 241) 0%,rgb(247, 227, 115) 50%,rgb(142, 103, 247) 100%);\\n                }\\n                .scrollable-content {\\n                    max-height: 500px; /* Adjust as needed */\\n                    overflow-y: auto;\\n                    padding: 1rem;\\n                    background-color: #fff;\\n                    box-shadow: inset 0 2px 4px 0 rgba(63, 137, 235, 0.06); /* subtle purple inner shadow */\\n                }\\n                /* Hide scrollbar for Chrome, Safari and Opera */\\n                .scrollable-content::-webkit-scrollbar {\\n                    display: none;\\n                }\\n                /* Hide scrollbar for IE, Edge and Firefox */\\n                .scrollable-content {\\n                    -ms-overflow-style: none;  /* IE and Edge */\\n                    scrollbar-width: none;  /* Firefox */\\n                }\\n                .header-gradient {\\n                    background: linear-gradient(135deg, #00ff88 0%, #00d4ff 25%, #b347d9 50%, #ff6b9d 75%, #00ff88 100%);\\n                    -webkit-background-clip: text;\\n                    -webkit-text-fill-color: transparent;\\n                    background-clip: text;\\n                }\\n                .northern-lights-text {\\n                    background: linear-gradient(135deg, #00ff88 0%, #00d4ff 25%, #b347d9 50%, #ff6b9d 75%, #00ff88 100%);\\n                    -webkit-background-clip: text;\\n                    -webkit-text-fill-color: transparent;\\n                    background-clip: text;\\n                    background-size: 200% 200%;\\n                    animation: aurora 3s ease-in-out infinite;\\n                }\\n                @keyframes aurora {\\n                    0%, 100% { background-position: 0% 50%; }\\n                    50% { background-position: 100% 50%; }\\n                }\\n                .header-container {\\n                    background: linear-gradient(180deg, #212C33 0%, #2F3D44 100%);\\n                    border: 2px solid transparent;\\n                    background-clip: padding-box;\\n                    border-radius: 20px;\\n                    position: relative;\\n                }\\n                .header-container::before {\\n                    content: '';\\n                    position: absolute;\\n                    top: 0;\\n                    left: 0;\\n                    right: 0;\\n                    bottom: 0;\\n                    z-index: -1;\\n                    margin: -3px;\\n                    border-radius: 20px;\\n                    background: linear-gradient(135deg, #6366f1, #4f46e5, #4338ca, #3730a3);\\n                }\\n                \"}),/*#__PURE__*/_jsx(\"header\",{className:\"text-center mb-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"header-container p-6 mb-4 shadow-2xl\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center mb-3\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/taskflow-canvas/TaskFlow Canvas.png\",alt:\"TaskFlow Canvas Logo\",className:\"w-20 h-20 mr-4 drop-shadow-lg\",onError:e=>{// Hide the image if it fails to load\ne.target.style.display='none';}}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl sm:text-6xl font-extrabold northern-lights-text drop-shadow-2xl\",children:\"TaskFlow Canvas\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-semibold text-gray-700 bg-white/30 backdrop-blur-sm rounded-full px-6 py-2 inline-block\",children:\"Optimize Your Workflow Visually and Strategically\"})]})}),message&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-indigo-100 border-l-4 border-indigo-500 text-indigo-700 p-4 rounded-md mb-6 shadow-md transition-all duration-300 ease-in-out transform scale-100 opacity-100\",children:/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold\",children:message})}),/*#__PURE__*/_jsxs(\"nav\",{className:\"mb-8 flex justify-center space-x-2 flex-wrap\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleTabChange('mom','Meeting Notes'),className:\"px-4 py-2 rounded-xl font-semibold text-sm md:text-lg transition-all duration-300 ease-in-out shadow-md\\n                        \".concat(activeTab==='mom'?'bg-gradient-to-r from-blue-500 to-blue-600 text-white transform scale-105 shadow-lg':'bg-white text-blue-600 hover:bg-blue-50 hover:text-blue-700 border-2 border-blue-200'),children:\"Meeting Notes\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleTabChange('project','Gantt Chart'),className:\"px-4 py-2 rounded-xl font-semibold text-sm md:text-lg transition-all duration-300 ease-in-out shadow-md\\n                        \".concat(activeTab==='project'?'bg-gradient-to-r from-green-500 to-green-600 text-white transform scale-105 shadow-lg':'bg-white text-green-600 hover:bg-green-50 hover:text-green-700 border-2 border-green-200'),children:\"Gantt Chart\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleTabChange('taskboard','Kanban Board'),className:\"px-4 py-2 rounded-xl font-semibold text-sm md:text-lg transition-all duration-300 ease-in-out shadow-md\\n                        \".concat(activeTab==='taskboard'?'bg-gradient-to-r from-purple-500 to-purple-600 text-white transform scale-105 shadow-lg':'bg-white text-purple-600 hover:bg-purple-50 hover:text-purple-700 border-2 border-purple-200'),children:\"Kanban Board\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleTabChange('budget','Budget Calculator'),className:\"px-4 py-2 rounded-xl font-semibold text-sm md:text-lg transition-all duration-300 ease-in-out shadow-md\\n                        \".concat(activeTab==='budget'?'bg-gradient-to-r from-orange-500 to-orange-600 text-white transform scale-105 shadow-lg':'bg-white text-orange-600 hover:bg-orange-50 hover:text-orange-700 border-2 border-orange-200'),children:\"Budget Calculator\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleTabChange('risks','Risk Log'),className:\"px-4 py-2 rounded-xl font-semibold text-sm md:text-lg transition-all duration-300 ease-in-out shadow-md\\n                        \".concat(activeTab==='risks'?'bg-gradient-to-r from-red-500 to-red-600 text-white transform scale-105 shadow-lg':'bg-white text-red-600 hover:bg-red-50 hover:text-red-700 border-2 border-red-200'),children:\"Risk Log\"})]}),activeTab==='mom'&&/*#__PURE__*/_jsx(MinutesOfMeeting,{onAddMom:handleAddMom,onDeleteMom:handleDeleteMom,momData:momData,momContentRef:momContentRef,downloadPdf:()=>{if(momData.length===0){setMessage('❌ No meeting notes to export. Please add some meeting notes first.');return;}downloadPdf(momContentRef,'MeetingNotes');},downloadExcel:()=>downloadExcel(momData,'MeetingMinutes','Meeting Notes'),sendEmail:()=>sendEmail(momData,'Meeting Notes','MeetingNotes')}),activeTab==='project'&&/*#__PURE__*/_jsx(ProjectScheduleComponent,{onAddProjectSchedule:handleAddProjectSchedule,onDeleteProjectSchedule:handleDeleteProjectSchedule,projectScheduleData:projectScheduleData,projectScheduleContentRef:projectScheduleContentRef,downloadPdf:()=>{if(projectScheduleData.length===0){setMessage('❌ No schedule data to export. Please add some project timelines first.');return;}downloadPdf(projectScheduleContentRef,'ProjectTimeline');},downloadExcel:()=>downloadExcel(projectScheduleData,'ProjectTimeline','Timeline'),sendEmail:()=>sendEmail(projectScheduleData,'Timeline','ProjectTimeline')}),activeTab==='taskboard'&&/*#__PURE__*/_jsx(TaskBoardComponent,{onAddTask:handleAddTask,onDeleteTask:handleDeleteTask,onUpdateTaskStatus:handleUpdateTaskStatus,taskBoardData:taskBoardData,taskBoardContentRef:taskBoardContentRef,downloadPdf:()=>{if(taskBoardData.length===0){setMessage('❌ No tasks to export. Please add some tasks first.');return;}downloadPdf(taskBoardContentRef,'TaskBoard');},downloadExcel:()=>downloadExcel(taskBoardData,'TaskBoard','Task Board'),sendEmail:()=>sendEmail(taskBoardData,'Task Board','TaskBoard')}),activeTab==='budget'&&/*#__PURE__*/_jsx(BudgetCalculatorComponent,{onAddBudget:handleAddBudget,onDeleteBudget:handleDeleteBudget,budgetData:budgetData,budgetContentRef:budgetContentRef,downloadPdf:()=>{if(budgetData.length===0){setMessage('❌ No budget data to export. Please add some budget information first.');return;}downloadPdf(budgetContentRef,'ProjectBudget');},downloadExcel:()=>downloadExcel(budgetData,'ProjectBudget','Project Budget'),sendEmail:()=>sendEmail(budgetData,'Project Budget','ProjectBudget')}),activeTab==='risks'&&/*#__PURE__*/_jsx(RiskRegisterComponent,{onAddRiskRegister:handleAddRiskRegister,onDeleteRiskRegister:handleDeleteRiskRegister,riskRegisterData:riskRegisterData,riskRegisterContentRef:riskRegisterContentRef,downloadPdf:()=>{if(riskRegisterData.length===0){setMessage('❌ No risk register data to export. Please add some risk information first.');return;}downloadPdf(riskRegisterContentRef,'RiskRegister');},downloadExcel:()=>downloadExcel(riskRegisterData,'RiskRegister','Risk Register'),sendEmail:()=>sendEmail(riskRegisterData,'Risk Register','RiskRegister')}),/*#__PURE__*/_jsx(\"footer\",{className:\"mt-12 pt-8 border-t border-gray-200 text-center\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"\\xA9 2025 Silvia Wu. All rights reserved.\"})})]});};// MinutesOfMeeting Component\nconst MinutesOfMeeting=_ref=>{let{onAddMom,onDeleteMom,momData,momContentRef,downloadPdf,downloadExcel,sendEmail}=_ref;// State for MoM form fields\nconst[title,setTitle]=useState('');const[date,setDate]=useState('');const[time,setTime]=useState('');const[attendees,setAttendees]=useState('');const[agenda,setAgenda]=useState('');const[discussion,setDiscussion]=useState('');const[actionItems,setActionItems]=useState([]);// Function to format time in AM/PM format\nconst formatTimeAMPM=time24=>{if(!time24)return'';const[hours,minutes]=time24.split(':');const hour12=(parseInt(hours)+11)%12+1;const ampm=parseInt(hours)>=12?'PM':'AM';return\"\".concat(hour12,\":\").concat(minutes,\" \").concat(ampm);};// Action item form states\nconst[newActionTask,setNewActionTask]=useState('');const[newActionOwner,setNewActionOwner]=useState('');const[newActionDueDate,setNewActionDueDate]=useState('');// Add action item\nconst addActionItem=()=>{if(newActionTask.trim()&&newActionOwner.trim()&&newActionDueDate){const newItem={id:Date.now(),task:newActionTask.trim(),owner:newActionOwner.trim(),dueDate:newActionDueDate};setActionItems([...actionItems,newItem]);setNewActionTask('');setNewActionOwner('');setNewActionDueDate('');}};// Remove action item\nconst removeActionItem=id=>{setActionItems(actionItems.filter(item=>item.id!==id));};const[nextMeeting,setNextMeeting]=useState('');// Handle form submission\nconst handleSubmit=e=>{e.preventDefault();onAddMom({title,date,time,attendees,agenda,discussion,actionItems,nextMeeting});// Clear form fields after submission\nsetTitle('');setDate('');setTime('');setAttendees('');setAgenda('');setDiscussion('');setActionItems([]);setNextMeeting('');setNewActionTask('');setNewActionOwner('');setNewActionDueDate('');};return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-2xl shadow-xl border border-gray-200\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-blue-700 mb-6 text-center\",children:\"New Meeting Note\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\",children:[/*#__PURE__*/_jsx(InputField,{label:\"Date\",type:\"date\",value:date,onChange:setDate,required:true}),/*#__PURE__*/_jsx(InputField,{label:\"Time\",type:\"time\",value:time,onChange:setTime,required:true}),/*#__PURE__*/_jsx(InputField,{label:\"Meeting Title\",type:\"text\",value:title,onChange:setTitle,required:true}),/*#__PURE__*/_jsx(InputField,{label:\"Attendees\",type:\"text\",value:attendees,onChange:setAttendees,placeholder:\"e.g., John Doe \",required:true}),/*#__PURE__*/_jsx(TextareaField,{label:\"Agenda\",value:agenda,onChange:setAgenda,rows:3,placeholder:\"Key topics to discuss...\",required:true}),/*#__PURE__*/_jsx(TextareaField,{label:\"Discussion\",value:discussion,onChange:setDiscussion,rows:5,placeholder:\"Summary of discussions and decisions...\",required:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",children:\"Future Actions\"}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 p-4 rounded-lg mb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Task Description\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"e.g., Prepare project report\",value:newActionTask,onChange:e=>setNewActionTask(e.target.value),className:\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Assigned To\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"e.g., Mary Smith\",value:newActionOwner,onChange:e=>setNewActionOwner(e.target.value),className:\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Due Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:newActionDueDate,onChange:e=>setNewActionDueDate(e.target.value),className:\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-end gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:addActionItem,className:\"flex-1 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition duration-200\",children:\"Add\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setNewActionTask('');setNewActionOwner('');setNewActionDueDate('');},className:\"flex-1 bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600 transition duration-200\",children:\"Clear\"})]})]})}),actionItems.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full border-collapse border border-gray-300\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"bg-gray-100\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"border border-gray-300 px-4 py-2 text-left\",children:\"Task\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border border-gray-300 px-4 py-2 text-left\",children:\"Owner\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border border-gray-300 px-4 py-2 text-left\",children:\"Due Date\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border border-gray-300 px-4 py-2 text-center\",children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:actionItems.map(item=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"border border-gray-300 px-4 py-2\",children:item.task}),/*#__PURE__*/_jsx(\"td\",{className:\"border border-gray-300 px-4 py-2\",children:item.owner}),/*#__PURE__*/_jsx(\"td\",{className:\"border border-gray-300 px-4 py-2\",children:item.dueDate}),/*#__PURE__*/_jsx(\"td\",{className:\"border border-gray-300 px-4 py-2 text-center\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>removeActionItem(item.id),className:\"bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600 transition duration-200\",children:\"Delete\"})})]},item.id))})]})})]}),/*#__PURE__*/_jsx(InputField,{label:\"Next Meeting Date\",type:\"date\",value:nextMeeting,onChange:setNextMeeting}),/*#__PURE__*/_jsx(\"div\",{className:\"md:col-span-2 flex justify-center\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-blue-600 text-white px-8 py-3 rounded-full font-semibold text-lg shadow-lg hover:bg-blue-700 transition duration-300 ease-in-out transform hover:scale-105\",children:\"Add New Meeting Note\"})})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-blue-700 mb-4 text-center\",children:\"Meeting Notes\"}),momData.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-600 p-4 border rounded-lg bg-gray-50\",children:\"No meeting notes are added yet. Add some above!\"}):/*#__PURE__*/_jsx(\"div\",{ref:momContentRef,\"data-pdf-content\":true,className:\"bg-gray-50 p-6 rounded-xl shadow-inner border border-gray-200 scrollable-content mb-6\",children:momData.map((mom,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6 pb-6 border-b border-gray-300 last:border-b-0 last:pb-0 relative\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-blue-800 mb-2\",children:mom.title||\"Meeting \".concat(index+1)}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>onDeleteMom(mom.id),className:\"ml-4 bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded-md text-sm font-medium transition duration-200 flex items-center\",title:\"Delete meeting note\",children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-4 w-4 mr-1\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"})}),\"Delete\"]})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-700 mb-1\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Date:\"}),\" \",mom.date,\" at \",formatTimeAMPM(mom.time)]}),mom.attendees&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-700 mb-1\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Attendees:\"}),\" \",mom.attendees]}),mom.agenda&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-700 mb-1\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Agenda:\"}),\" \",mom.agenda]}),mom.actionItems&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-700 mb-1\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Discussion:\"}),\" \",mom.discussion]}),mom.actionItems&&mom.actionItems.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 font-bold mb-2\",children:\"Future Actions:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full border-collapse border border-gray-300 text-sm\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"bg-gray-100\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"border border-gray-300 px-3 py-1 text-left\",children:\"Task\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border border-gray-300 px-3 py-1 text-left\",children:\"Owner\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border border-gray-300 px-3 py-1 text-left\",children:\"Due Date\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:mom.actionItems.map(item=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"border border-gray-300 px-3 py-1\",children:item.task}),/*#__PURE__*/_jsx(\"td\",{className:\"border border-gray-300 px-3 py-1\",children:item.owner}),/*#__PURE__*/_jsx(\"td\",{className:\"border border-gray-300 px-3 py-1\",children:item.dueDate})]},item.id))})]})})]}),mom.nextMeeting&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-700\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Next Meeting:\"}),\" \",mom.nextMeeting]})]},mom.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row justify-center gap-4 mt-6\",children:[/*#__PURE__*/_jsx(ActionButton,{onClick:momData.length>0?downloadPdf:()=>alert('Please add meeting notes first'),label:\"Download PDF\",icon:\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\",color:\"green\"}),/*#__PURE__*/_jsx(ActionButton,{onClick:momData.length>0?downloadExcel:()=>alert('Please add meeting notes first'),label:\"Download Excel\",icon:\"M13 14l-4-4m0 0l-4 4m4-4v12\",color:\"blue\"}),/*#__PURE__*/_jsx(ActionButton,{onClick:momData.length>0?()=>sendEmail(momData,'Meeting Notes','MeetingNotes'):()=>alert('Please add meeting notes first'),label:\"Send Email\",icon:\"M3 8l4 4 4-4m0 6l-4 4-4-4\",color:\"orange\"})]})]});};// GanttChart Component\nconst GanttChart=_ref2=>{let{projectSchedule}=_ref2;// Helper function to calculate position and width of task bars\nconst getTaskBarStyle=task=>{if(!task.taskStartDate||!task.taskEndDate||!projectSchedule.startDate||!projectSchedule.endDate){return{left:'0%',width:'0%'};}const projectStart=new Date(projectSchedule.startDate);const projectEnd=new Date(projectSchedule.endDate);const taskStart=new Date(task.taskStartDate);const taskEnd=new Date(task.taskEndDate);const projectDuration=projectEnd.getTime()-projectStart.getTime();const taskStartOffset=taskStart.getTime()-projectStart.getTime();const taskDuration=taskEnd.getTime()-taskStart.getTime();const leftPercent=Math.max(0,taskStartOffset/projectDuration*100);const widthPercent=Math.min(100-leftPercent,taskDuration/projectDuration*100);return{left:\"\".concat(leftPercent,\"%\"),width:\"\".concat(widthPercent,\"%\")};};// Helper function to get status color\nconst getStatusColor=status=>{switch(status){case'Completed':return'bg-green-500';case'In Progress':return'bg-yellow-500';case'Blocked':return'bg-red-500';default:return'bg-gray-400';}};// Helper function to format date for display\nconst formatDate=dateString=>{if(!dateString)return'';return new Date(dateString).toLocaleDateString('en-US',{month:'short',day:'numeric'});};// Generate time scale markers\nconst generateTimeScale=()=>{if(!projectSchedule.startDate||!projectSchedule.endDate)return[];const start=new Date(projectSchedule.startDate);const end=new Date(projectSchedule.endDate);const markers=[];// Create weekly markers for better readability\nconst current=new Date(start);current.setDate(current.getDate()-current.getDay());// Start from beginning of week\nwhile(current<=end){const position=(current.getTime()-start.getTime())/(end.getTime()-start.getTime())*100;if(position>=0&&position<=100){markers.push({position:\"\".concat(position,\"%\"),date:formatDate(current.toISOString().split('T')[0])});}current.setDate(current.getDate()+7);// Next week\n}return markers;};const timeMarkers=generateTimeScale();return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-4 rounded-lg shadow-md border border-gray-200 mt-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-lg font-medium text-gray-700 mb-4\",children:\"Timeline Gantt Chart\"}),/*#__PURE__*/_jsx(\"div\",{className:\"relative mb-2 h-8 bg-gray-50 rounded border\",children:timeMarkers.map((marker,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-0 h-full\",style:{left:marker.position},children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-px h-full bg-gray-300\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-1 left-1 text-xs text-gray-600 whitespace-nowrap\",children:marker.date})]},index))}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:projectSchedule.tasks.map((task,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-48 text-sm font-medium text-gray-700 truncate mr-4\",children:task.description}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:task.assignedTo&&\"(\".concat(task.assignedTo,\")\")})]}),/*#__PURE__*/_jsx(\"div\",{className:\"relative h-6 bg-gray-100 rounded border\",children:/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-0 h-full rounded \".concat(getStatusColor(task.status),\" opacity-80 flex items-center justify-center\"),style:getTaskBarStyle(task),title:\"\".concat(task.description,\": \").concat(formatDate(task.taskStartDate),\" - \").concat(formatDate(task.taskEndDate),\" (\").concat(task.status,\")\"),children:/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-white font-medium px-1 truncate\",children:task.status==='Completed'?'✓':task.status==='In Progress'?'⏳':task.status==='Blocked'?'⚠️':'○'})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-xs text-gray-500 mt-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:formatDate(task.taskStartDate)}),/*#__PURE__*/_jsx(\"span\",{children:formatDate(task.taskEndDate)})]})]},task.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 flex flex-wrap gap-4 text-xs\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 bg-gray-400 rounded mr-1\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Not Started\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 bg-yellow-500 rounded mr-1\"}),/*#__PURE__*/_jsx(\"span\",{children:\"In Progress\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 bg-green-500 rounded mr-1\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Completed\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 bg-red-500 rounded mr-1\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Blocked\"})]})]})]});};// ProjectSchedule Component\nconst ProjectScheduleComponent=_ref3=>{let{onAddProjectSchedule,onDeleteProjectSchedule,projectScheduleData,projectScheduleContentRef,downloadPdf,downloadExcel,sendEmail}=_ref3;// State for Timeline form fields\nconst[projectName,setProjectName]=useState('');const[startDate,setStartDate]=useState('');const[endDate,setEndDate]=useState('');// State for managing multiple tasks\nconst[tasks,setTasks]=useState([{id:1,description:'',taskStartDate:'',taskEndDate:'',status:'Not Started',assignedTo:''}]);// Handle adding a new task row\nconst addTask=()=>{setTasks(prev=>[...prev,{id:Date.now(),description:'',taskStartDate:'',taskEndDate:'',status:'Not Started',assignedTo:''}]);};// Handle updating a specific task field\nconst handleTaskChange=(id,field,value)=>{setTasks(prev=>prev.map(task=>task.id===id?_objectSpread(_objectSpread({},task),{},{[field]:value}):task));};// Handle form submission\nconst handleSubmit=e=>{e.preventDefault();// Validate required task fields\nconst invalidTasks=tasks.filter(task=>!task.description.trim()||!task.assignedTo.trim()||!task.taskStartDate||!task.taskEndDate||!task.status);if(invalidTasks.length>0){alert('Please fill in all required fields (Task Description, Assigned To, Start Date, End Date, and Status) for all tasks.');return;}onAddProjectSchedule({projectName,startDate,endDate,tasks});// Clear form fields and reset tasks after submission\nsetProjectName('');setStartDate('');setEndDate('');setTasks([{id:1,description:'',taskStartDate:'',taskEndDate:'',status:'Not Started',assignedTo:''}]);};return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-2xl shadow-xl border border-gray-200\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-blue-700 mb-6 text-center\",children:\"New Project Schedule\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-600 mb-6 text-sm\",children:\"Create project schedules with Gantt chart visualization to track task timelines and dependencies\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\",children:[/*#__PURE__*/_jsx(InputField,{label:\"Project Name\",type:\"text\",value:projectName,onChange:setProjectName,required:true}),/*#__PURE__*/_jsx(InputField,{label:\"Start Date\",type:\"date\",value:startDate,onChange:setStartDate,required:true}),/*#__PURE__*/_jsx(InputField,{label:\"End Date\",type:\"date\",value:endDate,onChange:setEndDate,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-700 mb-4 border-b pb-2\",children:\"Project timeline\"}),tasks.map((task,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 p-4 border border-gray-200 rounded-lg bg-gray-50 shadow-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\",children:[/*#__PURE__*/_jsx(InputField,{label:\"Task Description\",type:\"text\",value:task.description,onChange:val=>handleTaskChange(task.id,'description',val),placeholder:\"e.g., Design UI\",required:true}),/*#__PURE__*/_jsx(InputField,{label:\"Assigned To\",type:\"text\",value:task.assignedTo,onChange:val=>handleTaskChange(task.id,'assignedTo',val),placeholder:\"e.g., Alice\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4\",children:[/*#__PURE__*/_jsx(InputField,{label:\"Start Date\",type:\"date\",value:task.taskStartDate,onChange:val=>handleTaskChange(task.id,'taskStartDate',val),required:true}),/*#__PURE__*/_jsx(InputField,{label:\"End Date\",type:\"date\",value:task.taskEndDate,onChange:val=>handleTaskChange(task.id,'taskEndDate',val),required:true}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:[\"Status \",/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsxs(\"select\",{className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm\",value:task.status,onChange:e=>handleTaskChange(task.id,'status',e.target.value),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"Not Started\",children:\"Not Started\"}),/*#__PURE__*/_jsx(\"option\",{value:\"In Progress\",children:\"In Progress\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Completed\",children:\"Completed\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Blocked\",children:\"Blocked\"})]})]})]})]},task.id))]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-center gap-4 mt-6\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:addTask,className:\"bg-green-500 text-white px-8 py-3 rounded-full font-semibold text-lg shadow-lg hover:bg-green-600 transition duration-300 ease-in-out transform hover:scale-105\",children:\"Add\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-blue-600 text-white px-8 py-3 rounded-full font-semibold text-lg shadow-lg hover:bg-blue-700 transition duration-300 ease-in-out transform hover:scale-105\",children:\"Save\"})]})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-blue-700 mb-4 text-center\",children:\"Project Schedule\"}),projectScheduleData.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-600 p-4 border rounded-lg bg-gray-50\",children:\"No project timelines are added yet. Add some above!\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{ref:projectScheduleContentRef,\"data-pdf-content\":true,className:\"bg-gray-50 p-6 rounded-xl shadow-inner border border-gray-200 scrollable-content mb-6\",children:projectScheduleData.map((schedule,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6 pb-6 border-b border-gray-300 last:border-b-0 last:pb-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-blue-800 mb-2\",children:schedule.projectName||\"Project \".concat(index+1)}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>onDeleteProjectSchedule(schedule.id),className:\"ml-4 bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded-md text-sm font-medium transition duration-200 flex items-center\",title:\"Delete timeline\",children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-4 w-4 mr-1\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"})}),\"Delete\"]})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-700 mb-1\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Duration:\"}),\" \",schedule.startDate,\" to \",schedule.endDate]}),/*#__PURE__*/_jsx(\"h4\",{className:\"text-lg font-medium text-gray-700 mt-4 mb-2\",children:\"Tasks:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full bg-white rounded-lg shadow-md overflow-hidden\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-blue-100\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 text-left text-sm font-semibold text-blue-800 uppercase tracking-wider rounded-tl-lg\",children:\"Task Description\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 text-left text-sm font-semibold text-blue-800 uppercase tracking-wider\",children:\"Start Date\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 text-left text-sm font-semibold text-blue-800 uppercase tracking-wider\",children:\"End Date\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 text-left text-sm font-semibold text-blue-800 uppercase tracking-wider\",children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 text-left text-sm font-semibold text-blue-800 uppercase tracking-wider rounded-tr-lg\",children:\"Assigned To\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:schedule.tasks.map(task=>/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b border-gray-200 last:border-b-0 hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 text-sm text-gray-800\",children:task.description}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 text-sm text-gray-800\",children:task.taskStartDate}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 text-sm text-gray-800\",children:task.taskEndDate}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 text-sm text-gray-800\",children:/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded-full text-xs font-semibold\\n                                                            \".concat(task.status==='Completed'?'bg-green-200 text-green-800':task.status==='In Progress'?'bg-yellow-200 text-yellow-800':task.status==='Blocked'?'bg-red-200 text-red-800':'bg-gray-200 text-gray-800'),children:task.status})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 text-sm text-gray-800\",children:task.assignedTo})]},task.id))})]})}),/*#__PURE__*/_jsx(GanttChart,{projectSchedule:schedule})]},schedule.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row justify-center gap-4 mt-6\",children:[/*#__PURE__*/_jsx(ActionButton,{onClick:downloadPdf,label:\"Download PDF\",icon:\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\",color:\"teal\"}),/*#__PURE__*/_jsx(ActionButton,{onClick:downloadExcel,label:\"Download Excel\",icon:\"M13 14l-4-4m0 0l-4 4m4-4v12\",color:\"blue\"}),/*#__PURE__*/_jsx(ActionButton,{onClick:()=>sendEmail(projectScheduleData,'Timeline','ProjectTimeline'),label:\"Send Email\",icon:\"M3 8l4 4 4-4m0 6l-4 4-4-4\",color:\"pink\"})]})]}),projectScheduleData.length===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row justify-center gap-4 mt-6\",children:[/*#__PURE__*/_jsx(ActionButton,{onClick:()=>alert('Please add project timelines first'),label:\"Download PDF\",icon:\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\",color:\"orange\"}),/*#__PURE__*/_jsx(ActionButton,{onClick:()=>alert('Please add project timelines first'),label:\"Download Excel\",icon:\"M13 14l-4-4m0 0l-4 4m4-4v12\",color:\"blue\"}),/*#__PURE__*/_jsx(ActionButton,{onClick:()=>alert('Please add project timelines first'),label:\"Send Email\",icon:\"M3 8l4 4 4-4m0 6l-4 4-4-4\",color:\"pink\"})]})]});};// Reusable Input Field Component\nconst InputField=_ref4=>{let{label,type,value,onChange,required=false,placeholder=''}=_ref4;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:[label,\" \",required&&/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"input\",{type:type,value:value,onChange:e=>onChange(e.target.value),className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm\",required:required,placeholder:placeholder})]});};// Reusable Textarea Field Component\nconst TextareaField=_ref5=>{let{label,value,onChange,rows,placeholder='',required=false}=_ref5;return/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-2\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:[label,\" \",required&&/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"textarea\",{value:value,onChange:e=>onChange(e.target.value),rows:rows,className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm\",required:required,placeholder:placeholder})]});};// Reusable Action Button Component\nconst ActionButton=_ref6=>{let{onClick,label,icon,color}=_ref6;return/*#__PURE__*/_jsxs(\"button\",{onClick:onClick,className:\"flex items-center justify-center px-6 py-3 rounded-full font-semibold text-lg transition duration-300 ease-in-out transform hover:scale-105 shadow-md\\n            \".concat(color==='blue'?'bg-blue-500 text-white hover:bg-blue-600':color==='purple'?'bg-purple-500 text-white hover:bg-purple-600':color==='green'?'bg-green-500 text-white hover:bg-green-600':color==='red'?'bg-red-500 text-white hover:bg-red-600':color==='orange'?'bg-orange-500 text-white hover:bg-orange-600':color==='pink'?'bg-pink-500 text-white hover:bg-pink-600':color==='indigo'?'bg-indigo-500 text-white hover:bg-indigo-600':color==='teal'?'bg-teal-500 text-white hover:bg-teal-600':'bg-gray-500 text-white hover:bg-gray-600'),children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-6 w-6 mr-2\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",strokeWidth:\"2\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",d:icon})}),label]});};// Kanban Board Component\nconst TaskBoardComponent=_ref7=>{let{onAddTask,onDeleteTask,onUpdateTaskStatus,taskBoardData,taskBoardContentRef,downloadPdf,downloadExcel,sendEmail}=_ref7;const[title,setTitle]=useState('');const[description,setDescription]=useState('');const[assignedTo,setAssignedTo]=useState('');const[priority,setPriority]=useState('Low');const[dueDate,setDueDate]=useState('');const[tags,setTags]=useState('');const handleSubmit=e=>{e.preventDefault();// Validate required fields\nif(!title.trim()){alert('Please enter a task title.');return;}if(!assignedTo.trim()){alert('Please assign the task to someone.');return;}if(!description.trim()){alert('Please provide a task description.');return;}if(!priority){alert('Please select a priority level.');return;}if(!dueDate){alert('Please select a due date.');return;}onAddTask({title,description,assignedTo,priority,status:'Not Started',dueDate,tags:tags.split(',').map(tag=>tag.trim()).filter(tag=>tag)});setTitle('');setDescription('');setAssignedTo('');setPriority('Low');setDueDate('');setTags('');};const getStatusTasks=status=>taskBoardData.filter(task=>task.status===status);const statusColumns=['Not Started','In Progress','Review','Done'];return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-2xl shadow-xl border border-gray-200\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-blue-700 mb-6 text-center\",children:\"Kanban Board\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-600 mb-6 text-sm\",children:\"Manage individual tasks with priority levels and workflow status tracking through Kanban columns\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8 p-4 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsx(InputField,{label:\"Task\",type:\"text\",value:title,onChange:setTitle,required:true}),/*#__PURE__*/_jsx(InputField,{label:\"Assigned To\",type:\"text\",value:assignedTo,onChange:setAssignedTo,placeholder:\"e.g., John Doe\",required:true}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:[\"Priority \",/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsxs(\"select\",{className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm\",value:priority,onChange:e=>setPriority(e.target.value),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"Low\",children:\"Low\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Medium\",children:\"Medium\"}),/*#__PURE__*/_jsx(\"option\",{value:\"High\",children:\"High\"})]})]}),/*#__PURE__*/_jsx(InputField,{label:\"Due Date\",type:\"date\",value:dueDate,onChange:setDueDate,required:true}),/*#__PURE__*/_jsx(TextareaField,{label:\"Description\",value:description,onChange:setDescription,rows:3,placeholder:\"Task details...\",required:true}),/*#__PURE__*/_jsx(InputField,{label:\"Category\",type:\"text\",value:tags,onChange:setTags,placeholder:\"e.g., sales, urgent\"}),/*#__PURE__*/_jsx(\"div\",{className:\"md:col-span-2 flex justify-center\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-blue-600 text-white px-6 py-2 rounded-full font-semibold shadow-lg hover:bg-blue-700 transition duration-300\",children:\"Add Task\"})})]}),/*#__PURE__*/_jsxs(\"div\",{ref:taskBoardContentRef,\"data-pdf-content\":true,children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-center mb-4\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-700\",children:\"Task Status\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6\",children:statusColumns.map(status=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg shadow-inner\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"text-lg font-semibold mb-4 text-center py-2 rounded \".concat(status==='Not Started'?'bg-gray-200 text-gray-800':status==='In Progress'?'bg-yellow-200 text-yellow-800':status==='Review'?'bg-blue-200 text-blue-800':'bg-green-200 text-green-800'),children:[status,\" (\",getStatusTasks(status).length,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3 min-h-[200px]\",children:getStatusTasks(status).map(task=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-3 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-gray-800 mb-1\",children:task.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-2\",children:task.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded text-xs font-semibold \".concat(task.priority==='High'?'bg-red-200 text-red-800':task.priority==='Medium'?'bg-yellow-200 text-yellow-800':'bg-green-200 text-green-800'),children:task.priority}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-500\",children:task.dueDate})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600 mb-2\",children:[\"\\uD83D\\uDC64 \",task.assignedTo]}),task.tags.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-1 mb-2\",children:task.tags.map((tag,idx)=>/*#__PURE__*/_jsx(\"span\",{className:\"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded\",children:tag},idx))}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsxs(\"select\",{className:\"flex-1 text-xs p-1 border border-gray-300 rounded\",value:task.status,onChange:e=>onUpdateTaskStatus(task.id,e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"Not Started\",children:\"Not Started\"}),/*#__PURE__*/_jsx(\"option\",{value:\"In Progress\",children:\"In Progress\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Review\",children:\"Review\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Done\",children:\"Done\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onDeleteTask(task.id),className:\"px-2 py-1 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition duration-200\",title:\"Delete task\",children:\"\\uD83D\\uDDD1\\uFE0F\"})]})]},task.id))})]},status))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row justify-center gap-4 mt-6\",children:[/*#__PURE__*/_jsx(ActionButton,{onClick:taskBoardData.length>0?downloadPdf:()=>alert('Please add tasks first'),label:\"Download PDF\",icon:\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\",color:\"purple\"}),/*#__PURE__*/_jsx(ActionButton,{onClick:taskBoardData.length>0?downloadExcel:()=>alert('Please add tasks first'),label:\"Download Excel\",icon:\"M13 14l-4-4m0 0l-4 4m4-4v12\",color:\"blue\"}),/*#__PURE__*/_jsx(ActionButton,{onClick:taskBoardData.length>0?()=>sendEmail(taskBoardData,'Task Board','TaskBoard'):()=>alert('Please add tasks first'),label:\"Send Email\",icon:\"M3 8l4 4 4-4m0 6l-4 4-4-4\",color:\"indigo\"})]})]});};// Budget Calculator Component\nconst BudgetCalculatorComponent=_ref8=>{let{onAddBudget,onDeleteBudget,budgetData,budgetContentRef,downloadPdf,downloadExcel,sendEmail}=_ref8;const[projectName,setProjectName]=useState('');const[totalBudget,setTotalBudget]=useState('');const[budgetItems,setBudgetItems]=useState([{id:1,category:'',description:'',estimatedCost:0,actualCost:0,earnedValue:0,notes:''}]);const addBudgetItem=()=>{setBudgetItems(prev=>[...prev,{id:Date.now(),category:'',description:'',estimatedCost:0,actualCost:0,earnedValue:0,notes:''}]);};const handleBudgetItemChange=(id,field,value)=>{setBudgetItems(prev=>prev.map(item=>item.id===id?_objectSpread(_objectSpread({},item),{},{[field]:value}):item));};const removeBudgetItem=id=>{if(budgetItems.length>1){setBudgetItems(prev=>prev.filter(item=>item.id!==id));}};const handleSubmit=e=>{e.preventDefault();// Validate required cost category fields\nconst invalidItems=budgetItems.filter(item=>!item.category.trim()||!item.description.trim()||item.estimatedCost<0||item.actualCost<0||item.earnedValue<0);if(invalidItems.length>0){alert('Please fill in all required fields (Category, Description, Planned Value, and Actual Cost) for all cost categories. Values cannot be negative.');return;}onAddBudget({projectName,totalBudget:parseFloat(totalBudget),items:budgetItems});setProjectName('');setTotalBudget('');setBudgetItems([{id:1,category:'',description:'',estimatedCost:0,actualCost:0,earnedValue:0,notes:''}]);};const getTotalEstimated=budget=>budget.items.reduce((sum,item)=>sum+item.estimatedCost,0);const getTotalActual=budget=>budget.items.reduce((sum,item)=>sum+item.actualCost,0);const getTotalEarnedValue=budget=>budget.items.reduce((sum,item)=>sum+item.earnedValue,0);// EVM Calculations\nconst getScheduleVariance=budget=>{const ev=getTotalEarnedValue(budget);const pv=getTotalEstimated(budget);return ev-pv;// SV = EV - PV\n};const getCostVariance=budget=>{const ev=getTotalEarnedValue(budget);const ac=getTotalActual(budget);return ev-ac;// CV = EV - AC\n};const getSchedulePerformanceIndex=budget=>{const ev=getTotalEarnedValue(budget);const pv=getTotalEstimated(budget);return pv>0?ev/pv:0;// SPI = EV / PV\n};const getCostPerformanceIndex=budget=>{const ev=getTotalEarnedValue(budget);const ac=getTotalActual(budget);return ac>0?ev/ac:0;// CPI = EV / AC\n};return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-2xl shadow-xl border border-gray-200\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-blue-700 mb-6 text-center\",children:\"Project Budget Calculator\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\",children:[/*#__PURE__*/_jsx(InputField,{label:\"Project Name\",type:\"text\",value:projectName,onChange:setProjectName,required:true}),/*#__PURE__*/_jsx(InputField,{label:\"Budget at Completion (BAC)\",type:\"number\",value:totalBudget,onChange:setTotalBudget,placeholder:\"$0.00\",required:true})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-700 mb-4 border-b pb-2\",children:\"Cost Categories\"}),budgetItems.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-7 gap-4 mb-4 p-4 border border-gray-200 rounded-lg bg-gray-50 relative\",children:[budgetItems.length>1&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>removeBudgetItem(item.id),className:\"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full text-sm hover:bg-red-600 transition duration-200 flex items-center justify-center\",title:\"Delete this cost category\",children:\"\\u2715\"}),/*#__PURE__*/_jsx(InputField,{label:\"Category\",type:\"text\",value:item.category,onChange:val=>handleBudgetItemChange(item.id,'category',val),placeholder:\"e.g., Development\",required:true}),/*#__PURE__*/_jsx(InputField,{label:\"Description\",type:\"text\",value:item.description,onChange:val=>handleBudgetItemChange(item.id,'description',val),placeholder:\"e.g.,Frontend development tasks\",required:true}),/*#__PURE__*/_jsx(InputField,{label:\"Planned Value\",type:\"number\",value:item.estimatedCost===0?'':item.estimatedCost.toString(),onChange:val=>handleBudgetItemChange(item.id,'estimatedCost',parseFloat(val)||0),placeholder:\"$0.00\",required:true}),/*#__PURE__*/_jsx(InputField,{label:\"Actual Cost\",type:\"number\",value:item.actualCost===0?'':item.actualCost.toString(),onChange:val=>handleBudgetItemChange(item.id,'actualCost',parseFloat(val)||0),placeholder:\"$0.00\",required:true}),/*#__PURE__*/_jsx(InputField,{label:\"Earned Value\",type:\"number\",value:item.earnedValue===0?'':item.earnedValue.toString(),onChange:val=>handleBudgetItemChange(item.id,'earnedValue',parseFloat(val)||0),placeholder:\"$0.00\"}),/*#__PURE__*/_jsx(\"div\",{className:\"md:col-span-2\",children:/*#__PURE__*/_jsx(InputField,{label:\"Notes\",type:\"text\",value:item.notes,onChange:val=>handleBudgetItemChange(item.id,'notes',val),placeholder:\"Additional notes\"})})]},item.id)),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-center gap-4 mb-6\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:addBudgetItem,className:\"bg-green-500 text-white px-4 py-2 rounded-full font-semibold shadow-md hover:bg-green-600 transition duration-300\",children:\"Add\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-blue-600 text-white px-6 py-2 rounded-full font-semibold shadow-lg hover:bg-blue-700 transition duration-300\",children:\"Save\"})]})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-blue-700 mb-4 text-center\",children:\"Budget Overview\"}),budgetData.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-600 p-4 border rounded-lg bg-gray-50\",children:\"No budgets are added yet. Add some above!\"}):/*#__PURE__*/_jsx(\"div\",{ref:budgetContentRef,\"data-pdf-content\":true,className:\"space-y-6 scrollable-content\",children:budgetData.map((budget,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-6 rounded-xl shadow-inner border border-gray-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-blue-800\",children:budget.projectName}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onDeleteBudget(budget.id),className:\"px-3 py-1 bg-red-500 text-white text-sm rounded hover:bg-red-600 transition duration-200\",title:\"Delete budget\",children:\"\\uD83D\\uDDD1\\uFE0F Delete\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-100 p-4 rounded-lg text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-blue-600 font-medium\",children:\"Budget at Completion (BAC)\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-blue-800\",children:[\"$\",budget.totalBudget.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-yellow-100 p-4 rounded-lg text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-yellow-600 font-medium\",children:\"Planned Value (PV)\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-yellow-800\",children:[\"$\",getTotalEstimated(budget).toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-purple-100 p-4 rounded-lg text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-purple-600 font-medium\",children:\"Earned Value (EV)\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-purple-800\",children:[\"$\",getTotalEarnedValue(budget).toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-green-100 p-4 rounded-lg text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-green-600 font-medium\",children:\"Actual Cost (AC)\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-green-800\",children:[\"$\",getTotalActual(budget).toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-100 p-4 rounded-lg text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 font-medium\",children:\"Schedule Variance (SV)\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xl font-bold \".concat(getScheduleVariance(budget)<0?'text-red-600':'text-black'),children:[\"$\",getScheduleVariance(budget).toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-100 p-4 rounded-lg text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 font-medium\",children:\"Cost Variance (CV)\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xl font-bold \".concat(getCostVariance(budget)<0?'text-red-600':'text-black'),children:[\"$\",getCostVariance(budget).toFixed(2)]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 rounded-lg text-center \".concat(getSchedulePerformanceIndex(budget)>=1?'bg-blue-100':'bg-red-100'),children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium \".concat(getSchedulePerformanceIndex(budget)>=1?'text-blue-600':'text-red-600'),children:\"Schedule Performance Index (SPI)\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold \".concat(getSchedulePerformanceIndex(budget)>=1?'text-blue-800':'text-red-800'),children:getSchedulePerformanceIndex(budget).toFixed(3)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-600 mt-1\",children:getSchedulePerformanceIndex(budget)>=1?'Ahead/On Schedule':'Behind Schedule'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 rounded-lg text-center \".concat(getCostPerformanceIndex(budget)>=1?'bg-purple-100':'bg-red-100'),children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium \".concat(getCostPerformanceIndex(budget)>=1?'text-purple-600':'text-red-600'),children:\"Cost Performance Index (CPI)\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold \".concat(getCostPerformanceIndex(budget)>=1?'text-purple-800':'text-red-800'),children:getCostPerformanceIndex(budget).toFixed(3)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-600 mt-1\",children:getCostPerformanceIndex(budget)>=1?'Under/On Budget':'Over Budget'})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full bg-white rounded-lg shadow-md\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-blue-100\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 text-left text-sm font-semibold text-blue-800\",children:\"Category\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 text-left text-sm font-semibold text-blue-800\",children:\"Description\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 text-left text-sm font-semibold text-blue-800\",children:\"Planned Value (PV)\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 text-left text-sm font-semibold text-blue-800\",children:\"Earned Value (EV)\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 text-left text-sm font-semibold text-blue-800\",children:\"Actual Cost (AC)\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 text-left text-sm font-semibold text-blue-800\",children:\"Notes\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:budget.items.map(item=>/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b border-gray-200 hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 text-sm text-gray-800\",children:item.category}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 text-sm text-gray-800\",children:item.description}),/*#__PURE__*/_jsxs(\"td\",{className:\"py-2 px-4 text-sm text-gray-800\",children:[\"$\",item.estimatedCost.toFixed(2)]}),/*#__PURE__*/_jsxs(\"td\",{className:\"py-2 px-4 text-sm text-gray-800\",children:[\"$\",item.earnedValue.toFixed(2)]}),/*#__PURE__*/_jsxs(\"td\",{className:\"py-2 px-4 text-sm text-gray-800\",children:[\"$\",item.actualCost.toFixed(2)]}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 text-sm text-gray-800\",children:item.notes})]},item.id))})]})})]},budget.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row justify-center gap-4 mt-6\",children:[/*#__PURE__*/_jsx(ActionButton,{onClick:budgetData.length>0?downloadPdf:()=>alert('Please add budgets first'),label:\"Download PDF\",icon:\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\",color:\"green\"}),/*#__PURE__*/_jsx(ActionButton,{onClick:budgetData.length>0?downloadExcel:()=>alert('Please add budgets first'),label:\"Download Excel\",icon:\"M13 14l-4-4m0 0l-4 4m4-4v12\",color:\"blue\"}),/*#__PURE__*/_jsx(ActionButton,{onClick:budgetData.length>0?()=>sendEmail(budgetData,'Project Budget','ProjectBudget'):()=>alert('Please add budgets first'),label:\"Send Email\",icon:\"M3 8l4 4 4-4m0 6l-4 4-4-4\",color:\"orange\"})]})]});};// Risk Register Component\nconst RiskRegisterComponent=_ref9=>{let{onAddRiskRegister,onDeleteRiskRegister,riskRegisterData,riskRegisterContentRef,downloadPdf,downloadExcel,sendEmail}=_ref9;const[projectName,setProjectName]=useState('');const[risks,setRisks]=useState([{id:1,riskDescription:'',probability:'Medium',impact:'Medium',category:'',mitigation:'',owner:'',status:'Open'}]);const addRisk=()=>{setRisks(prev=>[...prev,{id:Date.now(),riskDescription:'',probability:'Medium',impact:'Medium',category:'',mitigation:'',owner:'',status:'Open'}]);};const handleRiskChange=(id,field,value)=>{setRisks(prev=>prev.map(risk=>risk.id===id?_objectSpread(_objectSpread({},risk),{},{[field]:value}):risk));};const handleSubmit=e=>{e.preventDefault();onAddRiskRegister({projectName,risks});setProjectName('');setRisks([{id:1,riskDescription:'',probability:'Medium',impact:'Medium',category:'',mitigation:'',owner:'',status:'Open'}]);};const getRiskLevel=(probability,impact)=>{const levels={Low:1,Medium:2,High:3};const score=levels[probability]*levels[impact];if(score>=6)return{level:'High',color:'bg-red-200 text-red-800'};if(score>=4)return{level:'Medium',color:'bg-yellow-200 text-yellow-800'};return{level:'Low',color:'bg-green-200 text-green-800'};};return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-2xl shadow-xl border border-gray-200\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-blue-700 mb-6 text-center\",children:\"Risk Register\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"mb-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsx(InputField,{label:\"Project Name\",type:\"text\",value:projectName,onChange:setProjectName,required:true})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-700 mb-4 border-b pb-2\",children:\"Project Risks\"}),risks.map((risk,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4 p-4 border border-gray-200 rounded-lg bg-gray-50\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"md:col-span-2\",children:/*#__PURE__*/_jsx(TextareaField,{label:\"Description\",value:risk.riskDescription,onChange:val=>handleRiskChange(risk.id,'riskDescription',val),rows:2,placeholder:\"Describe the risk...\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Probability\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm\",value:risk.probability,onChange:e=>handleRiskChange(risk.id,'probability',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"Low\",children:\"Low\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Medium\",children:\"Medium\"}),/*#__PURE__*/_jsx(\"option\",{value:\"High\",children:\"High\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Impact\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm\",value:risk.impact,onChange:e=>handleRiskChange(risk.id,'impact',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"Low\",children:\"Low\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Medium\",children:\"Medium\"}),/*#__PURE__*/_jsx(\"option\",{value:\"High\",children:\"High\"})]})]}),/*#__PURE__*/_jsx(InputField,{label:\"Category\",type:\"text\",value:risk.category,onChange:val=>handleRiskChange(risk.id,'category',val),placeholder:\"e.g., Technical, Financial\"}),/*#__PURE__*/_jsx(InputField,{label:\"Risk Owner\",type:\"text\",value:risk.owner,onChange:val=>handleRiskChange(risk.id,'owner',val),placeholder:\"e.g., John Doe\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Status\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm\",value:risk.status,onChange:e=>handleRiskChange(risk.id,'status',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"Open\",children:\"Open\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Mitigated\",children:\"Mitigated\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Closed\",children:\"Closed\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"md:col-span-1\",children:/*#__PURE__*/_jsx(TextareaField,{label:\"Mitigation Strategy\",value:risk.mitigation,onChange:val=>handleRiskChange(risk.id,'mitigation',val),rows:2,placeholder:\"How to mitigate...\"})})]},risk.id)),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-center gap-4 mb-6\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:addRisk,className:\"bg-green-500 text-white px-4 py-2 rounded-full font-semibold shadow-md hover:bg-green-600 transition duration-300\",children:\"Add New Risk\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-blue-600 text-white px-6 py-2 rounded-full font-semibold shadow-lg hover:bg-blue-700 transition duration-300\",children:\"Save\"})]})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-blue-700 mb-4 text-center\",children:\"Risk Register\"}),riskRegisterData.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-600 p-4 border rounded-lg bg-gray-50\",children:\"No risk registers are added yet. Add some above!\"}):/*#__PURE__*/_jsx(\"div\",{ref:riskRegisterContentRef,\"data-pdf-content\":true,className:\"space-y-6 scrollable-content\",children:riskRegisterData.map((register,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-6 rounded-xl shadow-inner border border-gray-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-xl font-semibold text-blue-800\",children:[register.projectName,\" Risk Register\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onDeleteRiskRegister(register.id),className:\"px-3 py-1 bg-red-500 text-white text-sm rounded hover:bg-red-600 transition duration-200\",title:\"Delete risk register\",children:\"\\uD83D\\uDDD1\\uFE0F Delete\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full bg-white rounded-lg shadow-md\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-blue-100\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 text-left text-sm font-semibold text-blue-800\",children:\"Risk Description\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 text-left text-sm font-semibold text-blue-800\",children:\"Category\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 text-left text-sm font-semibold text-blue-800\",children:\"Probability\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 text-left text-sm font-semibold text-blue-800\",children:\"Impact\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 text-left text-sm font-semibold text-blue-800\",children:\"Risk Level\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 text-left text-sm font-semibold text-blue-800\",children:\"Owner\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 text-left text-sm font-semibold text-blue-800\",children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 text-left text-sm font-semibold text-blue-800\",children:\"Mitigation\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:register.risks.map(risk=>{const riskLevel=getRiskLevel(risk.probability,risk.impact);return/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b border-gray-200 hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 text-sm text-gray-800\",children:risk.riskDescription}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 text-sm text-gray-800\",children:risk.category}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 text-sm text-gray-800\",children:risk.probability}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 text-sm text-gray-800\",children:risk.impact}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 text-sm text-gray-800\",children:/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded-full text-xs font-semibold \".concat(riskLevel.color),children:riskLevel.level})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 text-sm text-gray-800\",children:risk.owner}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 text-sm text-gray-800\",children:/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded-full text-xs font-semibold \".concat(risk.status==='Open'?'bg-red-200 text-red-800':risk.status==='Mitigated'?'bg-yellow-200 text-yellow-800':'bg-green-200 text-green-800'),children:risk.status})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 text-sm text-gray-800\",children:risk.mitigation})]},risk.id);})})]})})]},register.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row justify-center gap-4 mt-6\",children:[/*#__PURE__*/_jsx(ActionButton,{onClick:riskRegisterData.length>0?downloadPdf:()=>alert('Please add risk register first'),label:\"Download PDF\",icon:\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\",color:\"red\"}),/*#__PURE__*/_jsx(ActionButton,{onClick:riskRegisterData.length>0?downloadExcel:()=>alert('Please add risk register first'),label:\"Download Excel\",icon:\"M13 14l-4-4m0 0l-4 4m4-4v12\",color:\"blue\"}),/*#__PURE__*/_jsx(ActionButton,{onClick:riskRegisterData.length>0?()=>sendEmail(riskRegisterData,'Risk Register','RiskRegister'):()=>alert('Please add risk register first'),label:\"Send Email\",icon:\"M3 8l4 4 4-4m0 6l-4 4-4-4\",color:\"pink\"})]})]});};export default App;","map":{"version":3,"names":["React","useState","useRef","useEffect","XLSX","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","App","activeTab","setActiveTab","trackSectionView","sectionName","window","gtag","page_title","concat","page_location","location","origin","pathname","toLowerCase","replace","custom_parameter_1","event_category","event_label","handleTabChange","tabName","sectionLabel","momData","setMomData","projectScheduleData","setProjectScheduleData","taskBoardData","setTaskBoardData","budgetData","setBudgetData","riskRegisterData","setRiskRegisterData","message","setMessage","momContentRef","projectScheduleContentRef","taskBoardContentRef","budgetContentRef","riskRegisterContentRef","timer","setTimeout","clearTimeout","handleAddMom","newMom","prev","_objectSpread","id","Date","now","handleAddProjectSchedule","newSchedule","handleAddTask","newTask","handleUpdateTaskStatus","taskId","newStatus","map","task","status","handleAddBudget","newBudget","handleAddRiskRegister","newRiskRegister","handleDeleteMom","filter","mom","handleDeleteProjectSchedule","schedule","handleDeleteTask","handleDeleteBudget","budget","handleDeleteRiskRegister","register","downloadPdf","contentRef","filename","file_extension","generateTextBasedPDF","error","console","Error","jsPDFConstructor","jsPDF","default","jspdf","currentDate","toISOString","split","filenameWithDate","pdf","pageWidth","pageHeight","margin","lineHeight","yPosition","addWrappedText","text","x","y","maxWidth","fontSize","arguments","length","undefined","setFontSize","lines","splitTextToSize","forEach","line","index","addPage","setTextColor","includes","align","toLocaleDateString","projectName","startDate","endDate","tasks","taskIndex","description","taskStartDate","taskEndDate","assignedTo","title","date","time","attendees","agenda","discussion","actionItems","item","itemIndex","owner","dueDate","nextMeeting","statusColumns","tasksInStatus","priority","tags","join","totalEstimated","items","reduce","sum","estimatedCost","totalActual","actualCost","totalEarnedValue","earnedValue","scheduleVariance","costVariance","spi","cpi","variance","setDrawColor","setLineWidth","totalBudget","toLocaleString","toFixed","projectStatus","category","toUpperCase","itemSV","itemCV","notes","trim","toLocaleTimeString","internal","getNumberOfPages","riskRegister","risks","riskStats","open","r","mitigated","closed","high","probability","impact","riskStatuses","risksInStatus","risk","riskIndex","riskDescription","mitigation","save","downloadExcel","data","sheetName","worksheetData","scheduleData","push","taskData","totalPV","totalEV","totalAC","riskData","levels","Low","Medium","High","score","riskLevel","workbook","utils","book_new","worksheet","json_to_sheet","columnWidths","Object","keys","key","wch","Math","max","row","String","book_append_sheet","writeFile","sendEmail","content","subject","emailBody","repeat","Array","isArray","scheduleIndex","statusIcon","completedTasks","t","inProgressTasks","blockedTasks","notStartedTasks","round","formattedKey","str","actionItem","actionIndex","mailtoLink","encodeURIComponent","method","className","children","src","alt","onError","e","target","style","display","onClick","MinutesOfMeeting","onAddMom","onDeleteMom","ProjectScheduleComponent","onAddProjectSchedule","onDeleteProjectSchedule","TaskBoardComponent","onAddTask","onDeleteTask","onUpdateTaskStatus","BudgetCalculatorComponent","onAddBudget","onDeleteBudget","RiskRegisterComponent","onAddRiskRegister","onDeleteRiskRegister","_ref","setTitle","setDate","setTime","setAttendees","setAgenda","setDiscussion","setActionItems","formatTimeAMPM","time24","hours","minutes","hour12","parseInt","ampm","newActionTask","setNewActionTask","newActionOwner","setNewActionOwner","newActionDueDate","setNewActionDueDate","addActionItem","newItem","removeActionItem","setNextMeeting","handleSubmit","preventDefault","onSubmit","InputField","label","type","value","onChange","required","placeholder","TextareaField","rows","ref","xmlns","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","d","ActionButton","alert","icon","color","GanttChart","_ref2","projectSchedule","getTaskBarStyle","left","width","projectStart","projectEnd","taskStart","taskEnd","projectDuration","getTime","taskStartOffset","taskDuration","leftPercent","widthPercent","min","getStatusColor","formatDate","dateString","month","day","generateTimeScale","start","end","markers","current","getDate","getDay","position","timeMarkers","marker","_ref3","setProjectName","setStartDate","setEndDate","setTasks","addTask","handleTaskChange","field","invalidTasks","val","_ref4","_ref5","_ref6","_ref7","setDescription","setAssignedTo","setPriority","setDueDate","setTags","tag","getStatusTasks","idx","_ref8","setTotalBudget","budgetItems","setBudgetItems","addBudgetItem","handleBudgetItemChange","removeBudgetItem","invalidItems","parseFloat","getTotalEstimated","getTotalActual","getTotalEarnedValue","getScheduleVariance","ev","pv","getCostVariance","ac","getSchedulePerformanceIndex","getCostPerformanceIndex","toString","_ref9","setRisks","addRisk","handleRiskChange","getRiskLevel","level"],"sources":["C:/Users/silvi/Desktop/React project/src/App.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport * as XLSX from 'xlsx';\r\n// html2canvas and jsPDF are expected to be loaded via CDN in the HTML environment,\r\n// so direct imports are removed to resolve compilation errors.\r\n// They will be accessed as global variables (html2canvas, jsPDF).\r\n\r\n// Type declarations for global variables\r\ndeclare global {\r\n    interface Window {\r\n        html2canvas: any;\r\n        jsPDF: any;\r\n        gtag?: (...args: any[]) => void;\r\n    }\r\n}\r\n\r\n// Define interfaces for our data structures\r\ninterface ActionItem {\r\n    id: number;\r\n    task: string;\r\n    owner: string;\r\n    dueDate: string;\r\n}\r\n\r\ninterface MeetingMinute {\r\n    id: number;\r\n    title: string;\r\n    date: string;\r\n    time: string;\r\n    attendees: string;\r\n    agenda: string;\r\n    discussion: string;\r\n    actionItems: ActionItem[];\r\n    nextMeeting: string;\r\n}\r\n\r\ninterface Task {\r\n    id: number;\r\n    description: string;\r\n    taskStartDate: string;\r\n    taskEndDate: string;\r\n    status: 'Not Started' | 'In Progress' | 'Completed' | 'Blocked';\r\n    assignedTo: string;\r\n}\r\n\r\ninterface ProjectSchedule {\r\n    id: number;\r\n    projectName: string;\r\n    startDate: string;\r\n    endDate: string;\r\n    tasks: Task[];\r\n}\r\n\r\ninterface TaskCard {\r\n    id: number;\r\n    title: string;\r\n    description: string;\r\n    assignedTo: string;\r\n    priority: 'Low' | 'Medium' | 'High';\r\n    status: 'Not Started' | 'In Progress' | 'Review' | 'Done';\r\n    dueDate: string;\r\n    tags: string[];\r\n}\r\n\r\ninterface BudgetItem {\r\n    id: number;\r\n    category: string;\r\n    description: string;\r\n    estimatedCost: number;\r\n    actualCost: number;\r\n    earnedValue: number;\r\n    notes: string;\r\n}\r\n\r\ninterface ProjectBudget {\r\n    id: number;\r\n    projectName: string;\r\n    totalBudget: number;\r\n    items: BudgetItem[];\r\n}\r\n\r\ninterface Risk {\r\n    id: number;\r\n    riskDescription: string;\r\n    probability: 'Low' | 'Medium' | 'High';\r\n    impact: 'Low' | 'Medium' | 'High';\r\n    category: string;\r\n    mitigation: string;\r\n    owner: string;\r\n    status: 'Open' | 'Mitigated' | 'Closed';\r\n}\r\n\r\ninterface RiskRegister {\r\n    id: number;\r\n    projectName: string;\r\n    risks: Risk[];\r\n}\r\n\r\n// Main App Component\r\nconst App = () => {\r\n    // State to manage the currently active tab\r\n    const [activeTab, setActiveTab] = useState('mom');\r\n    \r\n    // Function to track section views in Google Analytics\r\n    const trackSectionView = (sectionName: string) => {\r\n        // Track page view for specific section\r\n        if (typeof window !== 'undefined' && window.gtag) {\r\n            window.gtag('event', 'page_view', {\r\n                page_title: `TaskFlow Canvas - ${sectionName}`,\r\n                page_location: `${window.location.origin}${window.location.pathname}#${sectionName.toLowerCase().replace(' ', '-')}`,\r\n                custom_parameter_1: sectionName\r\n            });\r\n            \r\n            // Track custom event for section engagement\r\n            window.gtag('event', 'section_view', {\r\n                event_category: 'Navigation',\r\n                event_label: sectionName,\r\n                custom_parameter_1: 'tab_navigation'\r\n            });\r\n        }\r\n    };\r\n    \r\n    // Enhanced function to handle tab changes with analytics\r\n    const handleTabChange = (tabName: string, sectionLabel: string) => {\r\n        setActiveTab(tabName);\r\n        trackSectionView(sectionLabel);\r\n    };\r\n    // State to store Minutes of Meeting data\r\n    const [momData, setMomData] = useState<MeetingMinute[]>([]);\r\n    // State to store Timeline data\r\n    const [projectScheduleData, setProjectScheduleData] = useState<ProjectSchedule[]>([]);\r\n    // State to store Task Board data\r\n    const [taskBoardData, setTaskBoardData] = useState<TaskCard[]>([]);\r\n    // State to store Budget data\r\n    const [budgetData, setBudgetData] = useState<ProjectBudget[]>([]);\r\n    // State to store Risk Register data\r\n    const [riskRegisterData, setRiskRegisterData] = useState<RiskRegister[]>([]);\r\n    // State to manage temporary success messages for downloads/emails\r\n    const [message, setMessage] = useState('');\r\n\r\n    // Refs to target the content areas for PDF generation\r\n    const momContentRef = useRef<HTMLDivElement>(null);\r\n    const projectScheduleContentRef = useRef<HTMLDivElement>(null);\r\n    const taskBoardContentRef = useRef<HTMLDivElement>(null);\r\n    const budgetContentRef = useRef<HTMLDivElement>(null);\r\n    const riskRegisterContentRef = useRef<HTMLDivElement>(null);\r\n\r\n    // Effect to clear messages after a short delay\r\n    useEffect(() => {\r\n        if (message) {\r\n            const timer = setTimeout(() => {\r\n                setMessage('');\r\n            }, 3000); // Message disappears after 3 seconds\r\n            return () => clearTimeout(timer);\r\n        }\r\n    }, [message]);\r\n\r\n    // Function to handle adding new Minutes of Meeting\r\n    const handleAddMom = (newMom: Omit<MeetingMinute, 'id'>) => {\r\n        setMomData(prev => [...prev, { ...newMom, id: Date.now() }]);\r\n        setMessage('The meeting note has been successfully added!');\r\n        \r\n        // Track user engagement\r\n        if (typeof window !== 'undefined' && window.gtag) {\r\n            window.gtag('event', 'item_created', {\r\n                event_category: 'User Engagement',\r\n                event_label: 'Meeting Notes',\r\n                custom_parameter_1: 'content_creation'\r\n            });\r\n        }\r\n    };\r\n\r\n    // Function to handle adding new Timeline\r\n    const handleAddProjectSchedule = (newSchedule: Omit<ProjectSchedule, 'id'>) => {\r\n        setProjectScheduleData(prev => [...prev, { ...newSchedule, id: Date.now() }]);\r\n        setMessage('The project schedule has been successfully updated!');\r\n        \r\n        // Track user engagement\r\n        if (typeof window !== 'undefined' && window.gtag) {\r\n            window.gtag('event', 'item_created', {\r\n                event_category: 'User Engagement',\r\n                event_label: 'Gantt Chart',\r\n                custom_parameter_1: 'content_creation'\r\n            });\r\n        }\r\n    };\r\n\r\n    // Function to handle adding new Task\r\n    const handleAddTask = (newTask: Omit<TaskCard, 'id'>) => {\r\n        setTaskBoardData(prev => [...prev, { ...newTask, id: Date.now() }]);\r\n        setMessage('The task has been successfully added!');\r\n        \r\n        // Track user engagement\r\n        if (typeof window !== 'undefined' && window.gtag) {\r\n            window.gtag('event', 'item_created', {\r\n                event_category: 'User Engagement',\r\n                event_label: 'Kanban Board',\r\n                custom_parameter_1: 'content_creation'\r\n            });\r\n        }\r\n    };\r\n\r\n    // Function to handle updating task status\r\n    const handleUpdateTaskStatus = (taskId: number, newStatus: TaskCard['status']) => {\r\n        setTaskBoardData(prev => prev.map(task => \r\n            task.id === taskId ? { ...task, status: newStatus } : task\r\n        ));\r\n        setMessage('The task status has been successfully updated!');\r\n    };\r\n\r\n    // Function to handle adding new Budget\r\n    const handleAddBudget = (newBudget: Omit<ProjectBudget, 'id'>) => {\r\n        setBudgetData(prev => [...prev, { ...newBudget, id: Date.now() }]);\r\n        setMessage('The budget has been successfully added!');\r\n\r\n        // Track user engagement\r\n        if (typeof window !== 'undefined' && window.gtag) {\r\n            window.gtag('event', 'item_created', {\r\n                event_category: 'User Engagement',\r\n                event_label: 'Budget Calculator',\r\n                custom_parameter_1: 'content_creation'\r\n            });\r\n        }\r\n    };\r\n\r\n    // Function to handle adding new Risk Register\r\n    const handleAddRiskRegister = (newRiskRegister: Omit<RiskRegister, 'id'>) => {\r\n        setRiskRegisterData(prev => [...prev, { ...newRiskRegister, id: Date.now() }]);\r\n        setMessage('The risk register has been successfully added!');\r\n        \r\n        // Track user engagement\r\n        if (typeof window !== 'undefined' && window.gtag) {\r\n            window.gtag('event', 'item_created', {\r\n                event_category: 'User Engagement',\r\n                event_label: 'Risk Log',\r\n                custom_parameter_1: 'content_creation'\r\n            });\r\n        }\r\n    };\r\n\r\n    // Delete handler functions\r\n    const handleDeleteMom = (id: number) => {\r\n        setMomData(prev => prev.filter(mom => mom.id !== id));\r\n        setMessage('The meeting note has been successfully deleted!');\r\n    };\r\n\r\n    const handleDeleteProjectSchedule = (id: number) => {\r\n        setProjectScheduleData(prev => prev.filter(schedule => schedule.id !== id));\r\n        setMessage('The project schedule has been successfully deleted!');\r\n    };\r\n\r\n    const handleDeleteTask = (id: number) => {\r\n        setTaskBoardData(prev => prev.filter(task => task.id !== id));\r\n        setMessage('The task has been successfully deleted!');\r\n    };\r\n\r\n    const handleDeleteBudget = (id: number) => {\r\n        setBudgetData(prev => prev.filter(budget => budget.id !== id));\r\n        setMessage('The budget has been successfully deleted!');\r\n    };\r\n\r\n    const handleDeleteRiskRegister = (id: number) => {\r\n        setRiskRegisterData(prev => prev.filter(register => register.id !== id));\r\n        setMessage('The risk register has been successfully deleted!');\r\n    };\r\n\r\n    // Function to generate and download PDF with unified text-based format\r\n    const downloadPdf = async (contentRef: React.RefObject<HTMLDivElement>, filename: string) => {\r\n        setMessage('Generating PDF...');\r\n        \r\n        // Track PDF download attempt\r\n        if (typeof window !== 'undefined' && window.gtag) {\r\n            window.gtag('event', 'file_download', {\r\n                event_category: 'Downloads',\r\n                event_label: `PDF - ${filename}`,\r\n                file_extension: 'pdf',\r\n                custom_parameter_1: 'pdf_generation'\r\n            });\r\n        }\r\n        \r\n        try {\r\n            // Use unified text-based PDF generation for all sections\r\n            await generateTextBasedPDF(filename, contentRef);\r\n            \r\n            // Track successful PDF generation\r\n            if (typeof window !== 'undefined' && window.gtag) {\r\n                window.gtag('event', 'download_complete', {\r\n                    event_category: 'Downloads',\r\n                    event_label: `PDF Success - ${filename}`,\r\n                    custom_parameter_1: 'pdf_success'\r\n                });\r\n            }\r\n        } catch (error) {\r\n            console.error('Error generating PDF:', error);\r\n            setMessage(`❌ Failed to generate PDF: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n            \r\n            // Track PDF generation failure\r\n            if (typeof window !== 'undefined' && window.gtag) {\r\n                window.gtag('event', 'download_error', {\r\n                    event_category: 'Errors',\r\n                    event_label: `PDF Error - ${filename}`,\r\n                    custom_parameter_1: 'pdf_error'\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    // Fallback text-based PDF generation when html2canvas fails\r\n    const generateTextBasedPDF = async (filename: string, contentRef: React.RefObject<HTMLDivElement>) => {\r\n        try {\r\n            // Get jsPDF constructor\r\n            let jsPDFConstructor = null;\r\n            if (typeof window.jsPDF === 'function') {\r\n                jsPDFConstructor = window.jsPDF;\r\n            } else if (window.jsPDF && typeof window.jsPDF.jsPDF === 'function') {\r\n                jsPDFConstructor = window.jsPDF.jsPDF;\r\n            } else if (window.jsPDF && typeof window.jsPDF.default === 'function') {\r\n                jsPDFConstructor = window.jsPDF.default;\r\n            } else if (typeof (window as any).jspdf === 'object' && (window as any).jspdf.jsPDF) {\r\n                jsPDFConstructor = (window as any).jspdf.jsPDF;\r\n            }\r\n            \r\n            if (!jsPDFConstructor) {\r\n                setMessage('❌ Error: jsPDF library is not loaded for fallback generation.');\r\n                return;\r\n            }\r\n\r\n            const currentDate = new Date().toISOString().split('T')[0];\r\n            const filenameWithDate = `${filename}_${currentDate}`;\r\n            \r\n            const pdf = new jsPDFConstructor('p', 'mm', 'a4');\r\n            const pageWidth = 210;\r\n            const pageHeight = 297;\r\n            const margin = 15;\r\n            const lineHeight = 6;\r\n            let yPosition = margin;\r\n            \r\n            // Helper function to add text with word wrapping\r\n            const addWrappedText = (text: string, x: number, y: number, maxWidth: number, fontSize: number = 10) => {\r\n                pdf.setFontSize(fontSize);\r\n                const lines = pdf.splitTextToSize(text, maxWidth);\r\n                lines.forEach((line: string, index: number) => {\r\n                    if (y + (index * lineHeight) > pageHeight - margin) {\r\n                        pdf.addPage();\r\n                        y = margin;\r\n                    }\r\n                    pdf.text(line, x, y + (index * lineHeight));\r\n                });\r\n                return y + (lines.length * lineHeight) + 3;\r\n            };\r\n            \r\n            // Add header\r\n            pdf.setFontSize(18);\r\n            pdf.setTextColor(40, 116, 166);\r\n            if (filename.includes('Timeline')) {\r\n                pdf.text('PROJECT SCHEDULE REPORT', pageWidth / 2, yPosition, { align: 'center' });\r\n            } else if (filename.includes('MeetingNotes')) {\r\n                pdf.text('MEETING REPORT', pageWidth / 2, yPosition, { align: 'center' });\r\n            } else if (filename.includes('TaskBoard')) {\r\n                pdf.text('KANBAN BOARD REPORT', pageWidth / 2, yPosition, { align: 'center' });\r\n            } else if (filename.includes('Budget')) {\r\n                pdf.text('PROJECT BUDGET REPORT', pageWidth / 2, yPosition, { align: 'center' });\r\n            } else if (filename.includes('Risk')) {\r\n                pdf.text('RISK REGISTER REPORT', pageWidth / 2, yPosition, { align: 'center' });\r\n            } else {\r\n                pdf.text('PROJECT REPORT', pageWidth / 2, yPosition, { align: 'center' });\r\n            }\r\n            \r\n            yPosition += 10;\r\n            \r\n            pdf.setFontSize(10);\r\n            pdf.setTextColor(100, 100, 100);\r\n            pdf.text(`Generated on: ${new Date().toLocaleDateString()}`, pageWidth / 2, yPosition, { align: 'center' });\r\n            \r\n            yPosition += 15;\r\n            pdf.setTextColor(0, 0, 0);\r\n            \r\n            // Add content based on data type\r\n            if (filename.includes('Timeline') && projectScheduleData.length > 0) {\r\n                projectScheduleData.forEach((schedule, index) => {\r\n                    if (yPosition > pageHeight - 50) {\r\n                        pdf.addPage();\r\n                        yPosition = margin;\r\n                    }\r\n                    \r\n                    // Project header\r\n                    pdf.setFontSize(14);\r\n                    pdf.setTextColor(40, 116, 166);\r\n                    yPosition = addWrappedText(`Project: ${schedule.projectName || `Project ${index + 1}`}`, margin, yPosition, pageWidth - 2 * margin, 14);\r\n                    \r\n                    pdf.setFontSize(10);\r\n                    pdf.setTextColor(0, 0, 0);\r\n                    yPosition = addWrappedText(`Duration: ${schedule.startDate} to ${schedule.endDate}`, margin, yPosition, pageWidth - 2 * margin);\r\n                    \r\n                    yPosition += 5;\r\n                    \r\n                    // Tasks\r\n                    pdf.setFontSize(12);\r\n                    pdf.setTextColor(0, 0, 0);\r\n                    yPosition = addWrappedText('Tasks:', margin, yPosition, pageWidth - 2 * margin, 12);\r\n                    \r\n                    schedule.tasks.forEach((task, taskIndex) => {\r\n                        if (yPosition > pageHeight - 30) {\r\n                            pdf.addPage();\r\n                            yPosition = margin;\r\n                        }\r\n                        \r\n                        pdf.setFontSize(10);\r\n                        yPosition = addWrappedText(`${taskIndex + 1}. ${task.description}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                        yPosition = addWrappedText(`   Start: ${task.taskStartDate} | End: ${task.taskEndDate}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                        yPosition = addWrappedText(`   Status: ${task.status} | Assigned: ${task.assignedTo}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                        yPosition += 3;\r\n                    });\r\n                    \r\n                    yPosition += 10;\r\n                });\r\n            } else if (filename.includes('MeetingNotes') && momData.length > 0) {\r\n                momData.forEach((mom, index) => {\r\n                    if (yPosition > pageHeight - 50) {\r\n                        pdf.addPage();\r\n                        yPosition = margin;\r\n                    }\r\n                    \r\n                    pdf.setFontSize(14);\r\n                    pdf.setTextColor(40, 116, 166);\r\n                    yPosition = addWrappedText(`Meeting: ${mom.title}`, margin, yPosition, pageWidth - 2 * margin, 14);\r\n                    \r\n                    pdf.setFontSize(10);\r\n                    pdf.setTextColor(0, 0, 0);\r\n                    yPosition = addWrappedText(`Date: ${mom.date} | Time: ${mom.time}`, margin, yPosition, pageWidth - 2 * margin);\r\n                    yPosition = addWrappedText(`Attendees: ${mom.attendees}`, margin, yPosition, pageWidth - 2 * margin);\r\n                    yPosition = addWrappedText(`Agenda: ${mom.agenda}`, margin, yPosition, pageWidth - 2 * margin);\r\n                    yPosition = addWrappedText(`Discussion: ${mom.discussion}`, margin, yPosition, pageWidth - 2 * margin);\r\n                    \r\n                    if (mom.actionItems.length > 0) {\r\n                        yPosition += 3;\r\n                        pdf.setFontSize(12);\r\n                        yPosition = addWrappedText('Action Items:', margin, yPosition, pageWidth - 2 * margin, 12);\r\n                        \r\n                        mom.actionItems.forEach((item, itemIndex) => {\r\n                            pdf.setFontSize(10);\r\n                            yPosition = addWrappedText(`${itemIndex + 1}. ${item.task} (Owner: ${item.owner}, Due: ${item.dueDate})`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                        });\r\n                    }\r\n                    \r\n                    yPosition = addWrappedText(`Next Meeting: ${mom.nextMeeting}`, margin, yPosition, pageWidth - 2 * margin);\r\n                    yPosition += 10;\r\n                });\r\n            } else if (filename.includes('TaskBoard') && taskBoardData.length > 0) {\r\n                // Group tasks by status for better organization\r\n                const statusColumns = ['Not Started', 'In Progress', 'Review', 'Done'];\r\n                \r\n                statusColumns.forEach((status) => {\r\n                    const tasksInStatus = taskBoardData.filter(task => task.status === status);\r\n                    \r\n                    if (tasksInStatus.length > 0) {\r\n                        if (yPosition > pageHeight - 50) {\r\n                            pdf.addPage();\r\n                            yPosition = margin;\r\n                        }\r\n                        \r\n                        // Status header\r\n                        pdf.setFontSize(14);\r\n                        pdf.setTextColor(40, 116, 166);\r\n                        yPosition = addWrappedText(`${status} (${tasksInStatus.length} tasks)`, margin, yPosition, pageWidth - 2 * margin, 14);\r\n                        yPosition += 5;\r\n                        \r\n                        tasksInStatus.forEach((task, taskIndex) => {\r\n                            if (yPosition > pageHeight - 40) {\r\n                                pdf.addPage();\r\n                                yPosition = margin;\r\n                            }\r\n                            \r\n                            pdf.setFontSize(12);\r\n                            pdf.setTextColor(0, 0, 0);\r\n                            yPosition = addWrappedText(`${taskIndex + 1}. ${task.title}`, margin + 10, yPosition, pageWidth - 2 * margin - 10, 12);\r\n                            \r\n                            pdf.setFontSize(10);\r\n                            yPosition = addWrappedText(`   Description: ${task.description}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                            yPosition = addWrappedText(`   Assigned To: ${task.assignedTo}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                            yPosition = addWrappedText(`   Priority: ${task.priority} | Due Date: ${task.dueDate}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                            \r\n                            if (task.tags && task.tags.length > 0) {\r\n                                yPosition = addWrappedText(`   Category: ${task.tags.join(', ')}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                            }\r\n                            \r\n                            yPosition += 3;\r\n                        });\r\n                        \r\n                        yPosition += 8;\r\n                    }\r\n                });\r\n            } else if (filename.includes('Budget') && budgetData.length > 0) {\r\n                budgetData.forEach((budget, index) => {\r\n                    if (yPosition > pageHeight - 50) {\r\n                        pdf.addPage();\r\n                        yPosition = margin;\r\n                    }\r\n                    \r\n                    // Project Budget Report Header\r\n                    pdf.setFontSize(16);\r\n                    pdf.setTextColor(40, 116, 166);\r\n                    yPosition = addWrappedText(`PROJECT BUDGET REPORT`, margin, yPosition, pageWidth - 2 * margin, 16);\r\n                    yPosition += 5;\r\n                    \r\n                    pdf.setFontSize(14);\r\n                    pdf.setTextColor(0, 0, 0);\r\n                    yPosition = addWrappedText(`Project: ${budget.projectName}`, margin, yPosition, pageWidth - 2 * margin, 14);\r\n                    yPosition += 8;\r\n                    \r\n                    // Calculate totals and EVM metrics\r\n                    const totalEstimated = budget.items.reduce((sum, item) => sum + item.estimatedCost, 0);\r\n                    const totalActual = budget.items.reduce((sum, item) => sum + item.actualCost, 0);\r\n                    const totalEarnedValue = budget.items.reduce((sum, item) => sum + item.earnedValue, 0);\r\n                    const scheduleVariance = totalEarnedValue - totalEstimated;\r\n                    const costVariance = totalEarnedValue - totalActual;\r\n                    const spi = totalEstimated !== 0 ? (totalEarnedValue / totalEstimated) : 0;\r\n                    const cpi = totalActual !== 0 ? (totalEarnedValue / totalActual) : 0;\r\n                    const variance = totalActual - totalEstimated;\r\n                    \r\n                    // Budget Summary Section\r\n                    pdf.setFontSize(13);\r\n                    pdf.setTextColor(40, 116, 166);\r\n                    yPosition = addWrappedText('BUDGET SUMMARY', margin, yPosition, pageWidth - 2 * margin, 13);\r\n                    yPosition += 3;\r\n                    \r\n                    // Add underline for section\r\n                    pdf.setDrawColor(40, 116, 166);\r\n                    pdf.setLineWidth(0.5);\r\n                    pdf.line(margin, yPosition, pageWidth - margin, yPosition);\r\n                    yPosition += 5;\r\n                    \r\n                    pdf.setFontSize(11);\r\n                    pdf.setTextColor(0, 0, 0);\r\n                    yPosition = addWrappedText(`Budget at Completion (BAC): $${budget.totalBudget.toLocaleString()}`, margin + 5, yPosition, pageWidth - 2 * margin - 5, 11);\r\n                    yPosition = addWrappedText(`Planned Value (PV): $${totalEstimated.toLocaleString()}`, margin + 5, yPosition, pageWidth - 2 * margin - 5, 11);\r\n                    yPosition = addWrappedText(`Earned Value (EV): $${totalEarnedValue.toLocaleString()}`, margin + 5, yPosition, pageWidth - 2 * margin - 5, 11);\r\n                    yPosition = addWrappedText(`Actual Cost (AC): $${totalActual.toLocaleString()}`, margin + 5, yPosition, pageWidth - 2 * margin - 5, 11);\r\n                    yPosition += 8;\r\n                    \r\n                    // EVM Metrics Section\r\n                    pdf.setFontSize(13);\r\n                    pdf.setTextColor(40, 116, 166);\r\n                    yPosition = addWrappedText('EARNED VALUE MANAGEMENT (EVM) METRICS', margin, yPosition, pageWidth - 2 * margin, 13);\r\n                    yPosition += 3;\r\n                    \r\n                    // Add underline for section\r\n                    pdf.setDrawColor(40, 116, 166);\r\n                    pdf.setLineWidth(0.5);\r\n                    pdf.line(margin, yPosition, pageWidth - margin, yPosition);\r\n                    yPosition += 5;\r\n                    \r\n                    // Variance Metrics\r\n                    pdf.setFontSize(12);\r\n                    pdf.setTextColor(70, 70, 70);\r\n                    yPosition = addWrappedText('Variance Analysis:', margin + 5, yPosition, pageWidth - 2 * margin - 5, 12);\r\n                    \r\n                    pdf.setFontSize(10);\r\n                    pdf.setTextColor(0, 0, 0);\r\n                    yPosition = addWrappedText(`• Schedule Variance (SV): $${scheduleVariance.toLocaleString()} ${scheduleVariance >= 0 ? '(Ahead of Schedule)' : '(Behind Schedule)'}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                    yPosition = addWrappedText(`• Cost Variance (CV): $${costVariance.toLocaleString()} ${costVariance >= 0 ? '(Under Budget)' : '(Over Budget)'}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                    yPosition += 3;\r\n                    \r\n                    // Performance Indices\r\n                    pdf.setFontSize(12);\r\n                    pdf.setTextColor(70, 70, 70);\r\n                    yPosition = addWrappedText('Performance Indices:', margin + 5, yPosition, pageWidth - 2 * margin - 5, 12);\r\n                    \r\n                    pdf.setFontSize(10);\r\n                    pdf.setTextColor(0, 0, 0);\r\n                    yPosition = addWrappedText(`• Schedule Performance Index (SPI): ${spi.toFixed(3)} ${spi >= 1 ? '(On/Ahead Schedule)' : '(Behind Schedule)'}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                    yPosition = addWrappedText(`• Cost Performance Index (CPI): ${cpi.toFixed(3)} ${cpi >= 1 ? '(On/Under Budget)' : '(Over Budget)'}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                    yPosition += 8;\r\n                    \r\n                    // Project Status Summary\r\n                    pdf.setFontSize(12);\r\n                    pdf.setTextColor(70, 70, 70);\r\n                    yPosition = addWrappedText('Project Status:', margin + 5, yPosition, pageWidth - 2 * margin - 5, 12);\r\n                    \r\n                    pdf.setFontSize(10);\r\n                    pdf.setTextColor(0, 0, 0);\r\n                    const projectStatus = (spi >= 1 && cpi >= 1) ? 'ON TRACK' : \r\n                                        (spi < 1 && cpi >= 1) ? 'BEHIND SCHEDULE' :\r\n                                        (spi >= 1 && cpi < 1) ? 'OVER BUDGET' : 'CRITICAL - BEHIND SCHEDULE & OVER BUDGET';\r\n                    yPosition = addWrappedText(`• Overall Status: ${projectStatus}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                    yPosition = addWrappedText(`• Budget Remaining: $${(budget.totalBudget - totalActual).toLocaleString()}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                    yPosition += 10;\r\n                    \r\n                    // Detailed Cost Categories Section\r\n                    if (yPosition > pageHeight - 60) {\r\n                        pdf.addPage();\r\n                        yPosition = margin;\r\n                    }\r\n                    \r\n                    pdf.setFontSize(13);\r\n                    pdf.setTextColor(40, 116, 166);\r\n                    yPosition = addWrappedText('DETAILED COST CATEGORIES BREAKDOWN', margin, yPosition, pageWidth - 2 * margin, 13);\r\n                    yPosition += 3;\r\n                    \r\n                    // Add underline for section\r\n                    pdf.setDrawColor(40, 116, 166);\r\n                    pdf.setLineWidth(0.5);\r\n                    pdf.line(margin, yPosition, pageWidth - margin, yPosition);\r\n                    yPosition += 5;\r\n                    \r\n                    budget.items.forEach((item, itemIndex) => {\r\n                        if (yPosition > pageHeight - 45) {\r\n                            pdf.addPage();\r\n                            yPosition = margin;\r\n                        }\r\n                        \r\n                        // Item header\r\n                        pdf.setFontSize(11);\r\n                        pdf.setTextColor(70, 70, 70);\r\n                        yPosition = addWrappedText(`${itemIndex + 1}. ${item.category.toUpperCase()}`, margin + 5, yPosition, pageWidth - 2 * margin - 5, 11);\r\n                        \r\n                        pdf.setFontSize(10);\r\n                        pdf.setTextColor(0, 0, 0);\r\n                        yPosition = addWrappedText(`   Description: ${item.description}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                        \r\n                        // Financial details in structured format\r\n                        yPosition = addWrappedText(`   • Planned Value (PV): $${item.estimatedCost.toLocaleString()}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                        yPosition = addWrappedText(`   • Earned Value (EV): $${item.earnedValue.toLocaleString()}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                        yPosition = addWrappedText(`   • Actual Cost (AC): $${item.actualCost.toLocaleString()}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                        \r\n                        // Item-level variance\r\n                        const itemSV = item.earnedValue - item.estimatedCost;\r\n                        const itemCV = item.earnedValue - item.actualCost;\r\n                        yPosition = addWrappedText(`   • Schedule Variance: $${itemSV.toLocaleString()} ${itemSV >= 0 ? '(Ahead)' : '(Behind)'}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                        yPosition = addWrappedText(`   • Cost Variance: $${itemCV.toLocaleString()} ${itemCV >= 0 ? '(Under Budget)' : '(Over Budget)'}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                        \r\n                        if (item.notes && item.notes.trim()) {\r\n                            yPosition = addWrappedText(`   • Notes: ${item.notes}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                        }\r\n                        \r\n                        yPosition += 5;\r\n                    });\r\n                    \r\n                    // Add footer section\r\n                    yPosition += 5;\r\n                    pdf.setFontSize(8);\r\n                    pdf.setTextColor(100, 100, 100);\r\n                    yPosition = addWrappedText(`Report generated on ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}`, margin, yPosition, pageWidth - 2 * margin, 8);\r\n                    yPosition = addWrappedText(`Page ${pdf.internal.getNumberOfPages()} | TaskFlow Canvas Budget Report`, margin, yPosition, pageWidth - 2 * margin, 8);\r\n                    \r\n                    if (index < budgetData.length - 1) {\r\n                        pdf.addPage();\r\n                        yPosition = margin;\r\n                    }\r\n                });\r\n            } else if (filename.includes('Risk') && riskRegisterData.length > 0) {\r\n                riskRegisterData.forEach((riskRegister, index) => {\r\n                    if (yPosition > pageHeight - 50) {\r\n                        pdf.addPage();\r\n                        yPosition = margin;\r\n                    }\r\n                    \r\n                    // Risk register header\r\n                    pdf.setFontSize(14);\r\n                    pdf.setTextColor(40, 116, 166);\r\n                    yPosition = addWrappedText(`Project: ${riskRegister.projectName}`, margin, yPosition, pageWidth - 2 * margin, 14);\r\n                    \r\n                    pdf.setFontSize(12);\r\n                    pdf.setTextColor(0, 0, 0);\r\n                    yPosition = addWrappedText(`Total Risks: ${riskRegister.risks.length}`, margin, yPosition, pageWidth - 2 * margin, 12);\r\n                    yPosition += 5;\r\n                    \r\n                    // Risk statistics\r\n                    const riskStats = {\r\n                        open: riskRegister.risks.filter(r => r.status === 'Open').length,\r\n                        mitigated: riskRegister.risks.filter(r => r.status === 'Mitigated').length,\r\n                        closed: riskRegister.risks.filter(r => r.status === 'Closed').length,\r\n                        high: riskRegister.risks.filter(r => r.probability === 'High' || r.impact === 'High').length\r\n                    };\r\n                    \r\n                    pdf.setFontSize(10);\r\n                    yPosition = addWrappedText(`Open: ${riskStats.open} | Mitigated: ${riskStats.mitigated} | Closed: ${riskStats.closed}`, margin, yPosition, pageWidth - 2 * margin);\r\n                    yPosition = addWrappedText(`High Priority Risks: ${riskStats.high}`, margin, yPosition, pageWidth - 2 * margin);\r\n                    yPosition += 8;\r\n                    \r\n                    // Group risks by status\r\n                    const riskStatuses = ['Open', 'Mitigated', 'Closed'];\r\n                    \r\n                    riskStatuses.forEach((status) => {\r\n                        const risksInStatus = riskRegister.risks.filter(risk => risk.status === status);\r\n                        \r\n                        if (risksInStatus.length > 0) {\r\n                            if (yPosition > pageHeight - 40) {\r\n                                pdf.addPage();\r\n                                yPosition = margin;\r\n                            }\r\n                            \r\n                            pdf.setFontSize(12);\r\n                            pdf.setTextColor(40, 116, 166);\r\n                            yPosition = addWrappedText(`${status} Risks (${risksInStatus.length})`, margin, yPosition, pageWidth - 2 * margin, 12);\r\n                            yPosition += 3;\r\n                            \r\n                            risksInStatus.forEach((risk, riskIndex) => {\r\n                                if (yPosition > pageHeight - 35) {\r\n                                    pdf.addPage();\r\n                                    yPosition = margin;\r\n                                }\r\n                                \r\n                                pdf.setFontSize(10);\r\n                                pdf.setTextColor(0, 0, 0);\r\n                                yPosition = addWrappedText(`${riskIndex + 1}. ${risk.riskDescription}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                                yPosition = addWrappedText(`   Category: ${risk.category} | Owner: ${risk.owner}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                                yPosition = addWrappedText(`   Probability: ${risk.probability} | Impact: ${risk.impact}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                                yPosition = addWrappedText(`   Mitigation: ${risk.mitigation}`, margin + 10, yPosition, pageWidth - 2 * margin - 10);\r\n                                yPosition += 3;\r\n                            });\r\n                            \r\n                            yPosition += 5;\r\n                        }\r\n                    });\r\n                    \r\n                    yPosition += 10;\r\n                });\r\n            } else {\r\n                // Generic fallback for other types or empty data\r\n                pdf.setFontSize(12);\r\n                pdf.setTextColor(100, 100, 100);\r\n                yPosition = addWrappedText('No data available for this section.', margin, yPosition, pageWidth - 2 * margin, 12);\r\n                yPosition += 10;\r\n                yPosition = addWrappedText('Content could not be captured automatically. Please check the application and try again.', margin, yPosition, pageWidth - 2 * margin);\r\n                yPosition = addWrappedText('This is a fallback text-based PDF. For full visual content, please ensure your browser supports html2canvas.', margin, yPosition, pageWidth - 2 * margin);\r\n            }\r\n            \r\n            pdf.save(`${filenameWithDate}.pdf`);\r\n            setMessage(`📄 Fallback PDF generated successfully! File: ${filenameWithDate}.pdf`);\r\n            \r\n        } catch (error) {\r\n            console.error('Error in fallback PDF generation:', error);\r\n            setMessage(`❌ Failed to generate fallback PDF: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n        }\r\n    };\r\n\r\n    // Function to generate and download Excel file\r\n    const downloadExcel = (data: MeetingMinute[] | ProjectSchedule[] | TaskCard[] | ProjectBudget[] | RiskRegister[], filename: string, sheetName: string) => {\r\n        try {\r\n            setMessage('Generating Excel file...');\r\n            \r\n            // Track Excel download attempt\r\n            if (typeof window !== 'undefined' && window.gtag) {\r\n                window.gtag('event', 'file_download', {\r\n                    event_category: 'Downloads',\r\n                    event_label: `Excel - ${filename}`,\r\n                    file_extension: 'xlsx',\r\n                    custom_parameter_1: 'excel_generation'\r\n                });\r\n            }\r\n            \r\n            // Generate current date for filename\r\n            const currentDate = new Date().toISOString().split('T')[0]; // Format: YYYY-MM-DD\r\n            const filenameWithDate = `${filename}_${currentDate}`;\r\n            \r\n            let worksheetData: any[] = [];\r\n            \r\n            if (data.length === 0) {\r\n                setMessage('No data available for Excel export.');\r\n                \r\n                // Track Excel generation failure\r\n                if (typeof window !== 'undefined' && window.gtag) {\r\n                    window.gtag('event', 'download_error', {\r\n                        event_category: 'Errors',\r\n                        event_label: `Excel Error - ${filename} (No Data)`,\r\n                        custom_parameter_1: 'excel_no_data'\r\n                    });\r\n                }\r\n                return;\r\n            }\r\n\r\n            // Format data based on type\r\n            if (filename.includes('MeetingNotes')) {\r\n                const momData = data as MeetingMinute[];\r\n                worksheetData = momData.map(mom => ({\r\n                    'Meeting Title': mom.title,\r\n                    'Date': mom.date,\r\n                    'Time': mom.time,\r\n                    'Attendees': mom.attendees,\r\n                    'Agenda': mom.agenda,\r\n                    'Discussion': mom.discussion,\r\n                    'Future Actions': mom.actionItems.map(item => `${item.task} (Owner: ${item.owner}, Due: ${item.dueDate})`).join('; '),\r\n                    'Next Meeting': mom.nextMeeting\r\n                }));\r\n            } else if (filename.includes('ProjectSchedule') || filename.includes('ProjectTimeline')) {\r\n                const scheduleData = data as ProjectSchedule[];\r\n                worksheetData = [];\r\n                scheduleData.forEach(schedule => {\r\n                    schedule.tasks.forEach(task => {\r\n                        worksheetData.push({\r\n                            'Project Name': schedule.projectName,\r\n                            'Project Start': schedule.startDate,\r\n                            'Project End': schedule.endDate,\r\n                            'Task Description': task.description,\r\n                            'Task Start Date': task.taskStartDate,\r\n                            'Task End Date': task.taskEndDate,\r\n                            'Status': task.status,\r\n                            'Assigned To': task.assignedTo\r\n                        });\r\n                    });\r\n                });\r\n            } else if (filename.includes('TaskBoard')) {\r\n                const taskData = data as TaskCard[];\r\n                worksheetData = taskData.map(task => ({\r\n                    'Title': task.title,\r\n                    'Description': task.description,\r\n                    'Assigned To': task.assignedTo,\r\n                    'Priority': task.priority,\r\n                    'Status': task.status,\r\n                    'Due Date': task.dueDate,\r\n                    'Category': task.tags.join(', ')\r\n                }));\r\n            } else if (filename.includes('ProjectBudget')) {\r\n                const budgetData = data as ProjectBudget[];\r\n                worksheetData = [];\r\n                budgetData.forEach(budget => {\r\n                    // Calculate EVM metrics for the project\r\n                    const totalPV = budget.items.reduce((sum, item) => sum + item.estimatedCost, 0);\r\n                    const totalEV = budget.items.reduce((sum, item) => sum + item.earnedValue, 0);\r\n                    const totalAC = budget.items.reduce((sum, item) => sum + item.actualCost, 0);\r\n                    const scheduleVariance = totalEV - totalPV;\r\n                    const costVariance = totalEV - totalAC;\r\n                    const spi = totalPV !== 0 ? (totalEV / totalPV) : 0;\r\n                    const cpi = totalAC !== 0 ? (totalEV / totalAC) : 0;\r\n                    \r\n                    // Add budget summary with EVM metrics\r\n                    worksheetData.push({\r\n                        'Project Name': budget.projectName,\r\n                        'Budget at Completion (BAC)': budget.totalBudget,\r\n                        'Category': 'BUDGET SUMMARY',\r\n                        'Description': 'Total Project Budget',\r\n                        'Planned Value (PV)': totalPV,\r\n                        'Earned Value (EV)': totalEV,\r\n                        'Actual Cost (AC)': totalAC,\r\n                        'Schedule Variance (SV)': scheduleVariance,\r\n                        'Cost Variance (CV)': costVariance,\r\n                        'Schedule Performance Index (SPI)': spi.toFixed(2),\r\n                        'Cost Performance Index (CPI)': cpi.toFixed(2),\r\n                        'Notes': 'EVM Summary'\r\n                    });\r\n                    // Add individual items\r\n                    budget.items.forEach(item => {\r\n                        worksheetData.push({\r\n                            'Project Name': budget.projectName,\r\n                            'Budget at Completion (BAC)': '',\r\n                            'Category': item.category,\r\n                            'Description': item.description,\r\n                            'Planned Value (PV)': item.estimatedCost,\r\n                            'Earned Value (EV)': item.earnedValue,\r\n                            'Actual Cost (AC)': item.actualCost,\r\n                            'Schedule Variance (SV)': item.earnedValue - item.estimatedCost,\r\n                            'Cost Variance (CV)': item.earnedValue - item.actualCost,\r\n                            'Schedule Performance Index (SPI)': item.estimatedCost !== 0 ? (item.earnedValue / item.estimatedCost).toFixed(2) : '0.00',\r\n                            'Cost Performance Index (CPI)': item.actualCost !== 0 ? (item.earnedValue / item.actualCost).toFixed(2) : '0.00',\r\n                            'Notes': item.notes\r\n                        });\r\n                    });\r\n                });\r\n            } else if (filename.includes('RiskRegister')) {\r\n                const riskData = data as RiskRegister[];\r\n                worksheetData = [];\r\n                riskData.forEach(register => {\r\n                    register.risks.forEach(risk => {\r\n                        const levels = { Low: 1, Medium: 2, High: 3 };\r\n                        const score = levels[risk.probability as keyof typeof levels] * levels[risk.impact as keyof typeof levels];\r\n                        const riskLevel = score >= 6 ? 'High' : score >= 4 ? 'Medium' : 'Low';\r\n                        \r\n                        worksheetData.push({\r\n                            'Project Name': register.projectName,\r\n                            'Risk Description': risk.riskDescription,\r\n                            'Category': risk.category,\r\n                            'Probability': risk.probability,\r\n                            'Impact': risk.impact,\r\n                            'Risk Level': riskLevel,\r\n                            'Owner': risk.owner,\r\n                            'Status': risk.status,\r\n                            'Mitigation Strategy': risk.mitigation\r\n                        });\r\n                    });\r\n                });\r\n            }\r\n\r\n            // Create workbook and worksheet\r\n            const workbook = XLSX.utils.book_new();\r\n            const worksheet = XLSX.utils.json_to_sheet(worksheetData);\r\n            \r\n            // Auto-adjust column widths\r\n            const columnWidths = Object.keys(worksheetData[0] || {}).map(key => ({\r\n                wch: Math.max(\r\n                    key.length,\r\n                    ...worksheetData.map(row => String(row[key] || '').length)\r\n                )\r\n            }));\r\n            worksheet['!cols'] = columnWidths;\r\n            \r\n            // Add worksheet to workbook\r\n            XLSX.utils.book_append_sheet(workbook, worksheet, sheetName);\r\n            \r\n            // Save the file\r\n            XLSX.writeFile(workbook, `${filenameWithDate}.xlsx`);\r\n            setMessage(`${filenameWithDate}.xlsx downloaded successfully!`);\r\n            \r\n            // Track successful Excel generation\r\n            if (typeof window !== 'undefined' && window.gtag) {\r\n                window.gtag('event', 'download_complete', {\r\n                    event_category: 'Downloads',\r\n                    event_label: `Excel Success - ${filename}`,\r\n                    custom_parameter_1: 'excel_success'\r\n                });\r\n            }\r\n        } catch (error) {\r\n            console.error('Error generating Excel:', error);\r\n            setMessage(`Failed to generate Excel: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n            \r\n            // Track Excel generation failure\r\n            if (typeof window !== 'undefined' && window.gtag) {\r\n                window.gtag('event', 'download_error', {\r\n                    event_category: 'Errors',\r\n                    event_label: `Excel Error - ${filename}`,\r\n                    custom_parameter_1: 'excel_error'\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    // Function to handle email sending (opens mailto link)\r\n    const sendEmail = (content: MeetingMinute[] | ProjectSchedule[] | TaskCard[] | ProjectBudget[] | RiskRegister[] | string, subject: string, filename: string) => {\r\n        // Enhanced plain text representation of the content\r\n        let emailBody = `${subject}\\n${'='.repeat(subject.length)}\\n\\n`;\r\n        \r\n        if (typeof content === 'string') {\r\n            emailBody += content;\r\n        } else if (Array.isArray(content)) {\r\n            // Special handling for Timeline data\r\n            if (filename.includes('Timeline') && content.length > 0) {\r\n                const scheduleData = content as ProjectSchedule[];\r\n                scheduleData.forEach((schedule, scheduleIndex) => {\r\n                    emailBody += `📋 PROJECT: ${schedule.projectName || `Project ${scheduleIndex + 1}`}\\n`;\r\n                    emailBody += `📅 Duration: ${schedule.startDate} to ${schedule.endDate}\\n`;\r\n                    emailBody += `📊 Total Tasks: ${schedule.tasks.length}\\n\\n`;\r\n                    \r\n                    if (schedule.tasks.length > 0) {\r\n                        emailBody += `TASKS BREAKDOWN:\\n`;\r\n                        emailBody += `${'-'.repeat(50)}\\n`;\r\n                        \r\n                        schedule.tasks.forEach((task, taskIndex) => {\r\n                            const statusIcon = task.status === 'Completed' ? '✅' : \r\n                                             task.status === 'In Progress' ? '🔄' : \r\n                                             task.status === 'Blocked' ? '🚫' : '⏸️';\r\n                            \r\n                            emailBody += `${taskIndex + 1}. ${statusIcon} ${task.description}\\n`;\r\n                            emailBody += `   📆 Start: ${task.taskStartDate || 'Not set'}\\n`;\r\n                            emailBody += `   📆 End: ${task.taskEndDate || 'Not set'}\\n`;\r\n                            emailBody += `   👤 Assigned: ${task.assignedTo || 'Unassigned'}\\n`;\r\n                            emailBody += `   📊 Status: ${task.status}\\n\\n`;\r\n                        });\r\n                        \r\n                        // Summary statistics\r\n                        const completedTasks = schedule.tasks.filter(t => t.status === 'Completed').length;\r\n                        const inProgressTasks = schedule.tasks.filter(t => t.status === 'In Progress').length;\r\n                        const blockedTasks = schedule.tasks.filter(t => t.status === 'Blocked').length;\r\n                        const notStartedTasks = schedule.tasks.filter(t => t.status === 'Not Started').length;\r\n                        \r\n                        emailBody += `PROGRESS SUMMARY:\\n`;\r\n                        emailBody += `${'-'.repeat(30)}\\n`;\r\n                        emailBody += `✅ Completed: ${completedTasks}/${schedule.tasks.length} (${Math.round((completedTasks/schedule.tasks.length)*100)}%)\\n`;\r\n                        emailBody += `🔄 In Progress: ${inProgressTasks}\\n`;\r\n                        emailBody += `🚫 Blocked: ${blockedTasks}\\n`;\r\n                        emailBody += `⏸️ Not Started: ${notStartedTasks}\\n`;\r\n                    }\r\n                    \r\n                    if (scheduleIndex < scheduleData.length - 1) {\r\n                        emailBody += `\\n${'='.repeat(80)}\\n\\n`;\r\n                    }\r\n                });\r\n            } else {\r\n                // Default handling for other content types\r\n                content.forEach((item, index) => {\r\n                    emailBody += filename.includes('MeetingNotes') ? `Meeting no. ${index + 1}:\\n` : `ENTRY ${index + 1}:\\n`;\r\n                    emailBody += `${'-'.repeat(20)}\\n`;\r\n                    \r\n                    for (const key in item) {\r\n                        if (key !== 'id' && item[key as keyof typeof item]) {\r\n                            // Format key names for readability in email\r\n                            const formattedKey = key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase());\r\n                            \r\n                            // Special handling for action items\r\n                            if (key === 'actionItems' && Array.isArray(item[key as keyof typeof item])) {\r\n                                const actionItems = item[key as keyof typeof item] as unknown as ActionItem[];\r\n                                if (actionItems.length > 0) {\r\n                                    emailBody += `${formattedKey}:\\n`;\r\n                                    actionItems.forEach((actionItem, actionIndex) => {\r\n                                        emailBody += `  ${actionIndex + 1}. ${actionItem.task} (Owner: ${actionItem.owner}, Due: ${actionItem.dueDate})\\n`;\r\n                                    });\r\n                                }\r\n                            } \r\n                            // Special handling for tasks array in ProjectSchedule\r\n                            else if (key === 'tasks' && Array.isArray(item[key as keyof typeof item])) {\r\n                                const tasks = item[key as keyof typeof item] as unknown as Task[];\r\n                                if (tasks.length > 0) {\r\n                                    emailBody += `${formattedKey} (${tasks.length} tasks):\\n`;\r\n                                    tasks.forEach((task, taskIndex) => {\r\n                                        emailBody += `  ${taskIndex + 1}. ${task.description} [${task.status}] - ${task.assignedTo || 'Unassigned'}\\n`;\r\n                                    });\r\n                                }\r\n                            } else {\r\n                                emailBody += `${formattedKey}: ${item[key as keyof typeof item]}\\n`;\r\n                            }\r\n                        }\r\n                    }\r\n                    emailBody += '\\n---\\n\\n'; // Separator for multiple entries\r\n                });\r\n            }\r\n        }\r\n\r\n        // Add footer with generation info\r\n        emailBody += `\\n\\n📧 Generated from TaskFlow Canvas\\n🌐 Visit at: https://silvia-9.github.io/taskflow-canvas/\\n📅 Generated on ${new Date().toLocaleDateString()}\\n`;\r\n\r\n        // Encode the subject and body for the mailto link\r\n        const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(emailBody)}`;\r\n        \r\n        // Track email sending attempt\r\n        if (typeof window !== 'undefined' && window.gtag) {\r\n            window.gtag('event', 'email_share', {\r\n                event_category: 'Sharing',\r\n                event_label: `Email - ${filename}`,\r\n                method: 'email',\r\n                custom_parameter_1: 'email_client_opened'\r\n            });\r\n        }\r\n        \r\n        window.open(mailtoLink, '_blank'); // Open in a new tab\r\n        setMessage(`📧 Email client opened with ${subject}. Review and send when ready!`);\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-gradient-to-br from-indigo-100 via-indigo-50 to-purple-100 font-inter text-gray-800 p-4 sm:p-6 lg:p-8 rounded-lg shadow-xl\">\r\n            <style>\r\n                {`\r\n                @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');\r\n                body {\r\n                    font-family: 'Inter', sans-serif;\r\n                    background: linear-gradient(135deg,rgb(231, 153, 241) 0%,rgb(247, 227, 115) 50%,rgb(142, 103, 247) 100%);\r\n                }\r\n                .scrollable-content {\r\n                    max-height: 500px; /* Adjust as needed */\r\n                    overflow-y: auto;\r\n                    padding: 1rem;\r\n                    background-color: #fff;\r\n                    box-shadow: inset 0 2px 4px 0 rgba(63, 137, 235, 0.06); /* subtle purple inner shadow */\r\n                }\r\n                /* Hide scrollbar for Chrome, Safari and Opera */\r\n                .scrollable-content::-webkit-scrollbar {\r\n                    display: none;\r\n                }\r\n                /* Hide scrollbar for IE, Edge and Firefox */\r\n                .scrollable-content {\r\n                    -ms-overflow-style: none;  /* IE and Edge */\r\n                    scrollbar-width: none;  /* Firefox */\r\n                }\r\n                .header-gradient {\r\n                    background: linear-gradient(135deg, #00ff88 0%, #00d4ff 25%, #b347d9 50%, #ff6b9d 75%, #00ff88 100%);\r\n                    -webkit-background-clip: text;\r\n                    -webkit-text-fill-color: transparent;\r\n                    background-clip: text;\r\n                }\r\n                .northern-lights-text {\r\n                    background: linear-gradient(135deg, #00ff88 0%, #00d4ff 25%, #b347d9 50%, #ff6b9d 75%, #00ff88 100%);\r\n                    -webkit-background-clip: text;\r\n                    -webkit-text-fill-color: transparent;\r\n                    background-clip: text;\r\n                    background-size: 200% 200%;\r\n                    animation: aurora 3s ease-in-out infinite;\r\n                }\r\n                @keyframes aurora {\r\n                    0%, 100% { background-position: 0% 50%; }\r\n                    50% { background-position: 100% 50%; }\r\n                }\r\n                .header-container {\r\n                    background: linear-gradient(180deg, #212C33 0%, #2F3D44 100%);\r\n                    border: 2px solid transparent;\r\n                    background-clip: padding-box;\r\n                    border-radius: 20px;\r\n                    position: relative;\r\n                }\r\n                .header-container::before {\r\n                    content: '';\r\n                    position: absolute;\r\n                    top: 0;\r\n                    left: 0;\r\n                    right: 0;\r\n                    bottom: 0;\r\n                    z-index: -1;\r\n                    margin: -3px;\r\n                    border-radius: 20px;\r\n                    background: linear-gradient(135deg, #6366f1, #4f46e5, #4338ca, #3730a3);\r\n                }\r\n                `}\r\n            </style>\r\n            <header className=\"text-center mb-8\">\r\n                <div className=\"header-container p-6 mb-4 shadow-2xl\">\r\n                    <div className=\"flex items-center justify-center mb-3\">\r\n                        <img \r\n                            src=\"/taskflow-canvas/TaskFlow Canvas.png\" \r\n                            alt=\"TaskFlow Canvas Logo\" \r\n                            className=\"w-20 h-20 mr-4 drop-shadow-lg\"\r\n                            onError={(e) => {\r\n                                // Hide the image if it fails to load\r\n                                (e.target as HTMLImageElement).style.display = 'none';\r\n                            }}\r\n                        />\r\n                        <h1 className=\"text-4xl sm:text-6xl font-extrabold northern-lights-text drop-shadow-2xl\">\r\n                            TaskFlow Canvas\r\n                        </h1>\r\n                    </div>\r\n                    <p className=\"text-xl font-semibold text-gray-700 bg-white/30 backdrop-blur-sm rounded-full px-6 py-2 inline-block\">\r\n                        Optimize Your Workflow Visually and Strategically\r\n                    </p>\r\n                </div>\r\n            </header>\r\n\r\n            {/* Message Display */}\r\n            {message && (\r\n                <div className=\"bg-indigo-100 border-l-4 border-indigo-500 text-indigo-700 p-4 rounded-md mb-6 shadow-md transition-all duration-300 ease-in-out transform scale-100 opacity-100\">\r\n                    <p className=\"font-semibold\">{message}</p>\r\n                </div>\r\n            )}\r\n\r\n            {/* Tab Navigation */}\r\n            <nav className=\"mb-8 flex justify-center space-x-2 flex-wrap\">\r\n                <button\r\n                    onClick={() => handleTabChange('mom', 'Meeting Notes')}\r\n                    className={`px-4 py-2 rounded-xl font-semibold text-sm md:text-lg transition-all duration-300 ease-in-out shadow-md\r\n                        ${activeTab === 'mom' ? 'bg-gradient-to-r from-blue-500 to-blue-600 text-white transform scale-105 shadow-lg' : 'bg-white text-blue-600 hover:bg-blue-50 hover:text-blue-700 border-2 border-blue-200'}`\r\n                    }\r\n                >\r\n                    Meeting Notes\r\n                </button>\r\n                <button\r\n                    onClick={() => handleTabChange('project', 'Gantt Chart')}\r\n                    className={`px-4 py-2 rounded-xl font-semibold text-sm md:text-lg transition-all duration-300 ease-in-out shadow-md\r\n                        ${activeTab === 'project' ? 'bg-gradient-to-r from-green-500 to-green-600 text-white transform scale-105 shadow-lg' : 'bg-white text-green-600 hover:bg-green-50 hover:text-green-700 border-2 border-green-200'}`\r\n                    }\r\n                >\r\n                    Gantt Chart\r\n                </button>\r\n                <button\r\n                    onClick={() => handleTabChange('taskboard', 'Kanban Board')}\r\n                    className={`px-4 py-2 rounded-xl font-semibold text-sm md:text-lg transition-all duration-300 ease-in-out shadow-md\r\n                        ${activeTab === 'taskboard' ? 'bg-gradient-to-r from-purple-500 to-purple-600 text-white transform scale-105 shadow-lg' : 'bg-white text-purple-600 hover:bg-purple-50 hover:text-purple-700 border-2 border-purple-200'}`\r\n                    }\r\n                >\r\n                    Kanban Board\r\n                </button>\r\n                <button\r\n                    onClick={() => handleTabChange('budget', 'Budget Calculator')}\r\n                    className={`px-4 py-2 rounded-xl font-semibold text-sm md:text-lg transition-all duration-300 ease-in-out shadow-md\r\n                        ${activeTab === 'budget' ? 'bg-gradient-to-r from-orange-500 to-orange-600 text-white transform scale-105 shadow-lg' : 'bg-white text-orange-600 hover:bg-orange-50 hover:text-orange-700 border-2 border-orange-200'}`\r\n                    }\r\n                >\r\n                    Budget Calculator\r\n                </button>\r\n                <button\r\n                    onClick={() => handleTabChange('risks', 'Risk Log')}\r\n                    className={`px-4 py-2 rounded-xl font-semibold text-sm md:text-lg transition-all duration-300 ease-in-out shadow-md\r\n                        ${activeTab === 'risks' ? 'bg-gradient-to-r from-red-500 to-red-600 text-white transform scale-105 shadow-lg' : 'bg-white text-red-600 hover:bg-red-50 hover:text-red-700 border-2 border-red-200'}`\r\n                    }\r\n                >\r\n                    Risk Log\r\n                </button>\r\n            </nav>\r\n\r\n            {/* Conditional Rendering based on active tab */}\r\n            {activeTab === 'mom' && (\r\n                <MinutesOfMeeting\r\n                    onAddMom={handleAddMom}\r\n                    onDeleteMom={handleDeleteMom}\r\n                    momData={momData}\r\n                    momContentRef={momContentRef}\r\n                    downloadPdf={() => {\r\n                        if (momData.length === 0) {\r\n                            setMessage('❌ No meeting notes to export. Please add some meeting notes first.');\r\n                            return;\r\n                        }\r\n                        downloadPdf(momContentRef, 'MeetingNotes');\r\n                    }}\r\n                    downloadExcel={() => downloadExcel(momData, 'MeetingMinutes', 'Meeting Notes')}\r\n                    sendEmail={() => sendEmail(momData, 'Meeting Notes', 'MeetingNotes')}\r\n                />\r\n            )}\r\n\r\n            {activeTab === 'project' && (\r\n                <ProjectScheduleComponent\r\n                    onAddProjectSchedule={handleAddProjectSchedule}\r\n                    onDeleteProjectSchedule={handleDeleteProjectSchedule}\r\n                    projectScheduleData={projectScheduleData}\r\n                    projectScheduleContentRef={projectScheduleContentRef}\r\n                    downloadPdf={() => {\r\n                        if (projectScheduleData.length === 0) {\r\n                            setMessage('❌ No schedule data to export. Please add some project timelines first.');\r\n                            return;\r\n                        }\r\n                        downloadPdf(projectScheduleContentRef, 'ProjectTimeline');\r\n                    }}\r\n                    downloadExcel={() => downloadExcel(projectScheduleData, 'ProjectTimeline', 'Timeline')}\r\n                    sendEmail={() => sendEmail(projectScheduleData, 'Timeline', 'ProjectTimeline')}\r\n                />\r\n            )}\r\n\r\n            {activeTab === 'taskboard' && (\r\n                <TaskBoardComponent\r\n                    onAddTask={handleAddTask}\r\n                    onDeleteTask={handleDeleteTask}\r\n                    onUpdateTaskStatus={handleUpdateTaskStatus}\r\n                    taskBoardData={taskBoardData}\r\n                    taskBoardContentRef={taskBoardContentRef}\r\n                    downloadPdf={() => {\r\n                        if (taskBoardData.length === 0) {\r\n                            setMessage('❌ No tasks to export. Please add some tasks first.');\r\n                            return;\r\n                        }\r\n                        downloadPdf(taskBoardContentRef, 'TaskBoard');\r\n                    }}\r\n                    downloadExcel={() => downloadExcel(taskBoardData, 'TaskBoard', 'Task Board')}\r\n                    sendEmail={() => sendEmail(taskBoardData, 'Task Board', 'TaskBoard')}\r\n                />\r\n            )}\r\n\r\n            {activeTab === 'budget' && (\r\n                <BudgetCalculatorComponent\r\n                    onAddBudget={handleAddBudget}\r\n                    onDeleteBudget={handleDeleteBudget}\r\n                    budgetData={budgetData}\r\n                    budgetContentRef={budgetContentRef}\r\n                    downloadPdf={() => {\r\n                        if (budgetData.length === 0) {\r\n                            setMessage('❌ No budget data to export. Please add some budget information first.');\r\n                            return;\r\n                        }\r\n                        downloadPdf(budgetContentRef, 'ProjectBudget');\r\n                    }}\r\n                    downloadExcel={() => downloadExcel(budgetData, 'ProjectBudget', 'Project Budget')}\r\n                    sendEmail={() => sendEmail(budgetData, 'Project Budget', 'ProjectBudget')}\r\n                />\r\n            )}\r\n\r\n            {activeTab === 'risks' && (\r\n                <RiskRegisterComponent\r\n                    onAddRiskRegister={handleAddRiskRegister}\r\n                    onDeleteRiskRegister={handleDeleteRiskRegister}\r\n                    riskRegisterData={riskRegisterData}\r\n                    riskRegisterContentRef={riskRegisterContentRef}\r\n                    downloadPdf={() => {\r\n                        if (riskRegisterData.length === 0) {\r\n                            setMessage('❌ No risk register data to export. Please add some risk information first.');\r\n                            return;\r\n                        }\r\n                        downloadPdf(riskRegisterContentRef, 'RiskRegister');\r\n                    }}\r\n                    downloadExcel={() => downloadExcel(riskRegisterData, 'RiskRegister', 'Risk Register')}\r\n                    sendEmail={() => sendEmail(riskRegisterData, 'Risk Register', 'RiskRegister')}\r\n                />\r\n            )}\r\n            \r\n            {/* Footer */}\r\n            <footer className=\"mt-12 pt-8 border-t border-gray-200 text-center\">\r\n                <p className=\"text-sm text-gray-600\">\r\n                    © 2025 Silvia Wu. All rights reserved.\r\n                </p>\r\n            </footer>\r\n        </div>\r\n    );\r\n};\r\n\r\n// MinutesOfMeeting Component\r\ninterface MinutesOfMeetingProps {\r\n    onAddMom: (newMom: Omit<MeetingMinute, 'id'>) => void;\r\n    onDeleteMom: (id: number) => void;\r\n    momData: MeetingMinute[];\r\n    momContentRef: React.RefObject<HTMLDivElement>;\r\n    downloadPdf: () => void;\r\n    downloadExcel: () => void;\r\n    sendEmail: (content: MeetingMinute[], subject: string, filename: string) => void;\r\n}\r\n\r\nconst MinutesOfMeeting: React.FC<MinutesOfMeetingProps> = ({ onAddMom, onDeleteMom, momData, momContentRef, downloadPdf, downloadExcel, sendEmail }) => {\r\n    // State for MoM form fields\r\n    const [title, setTitle] = useState('');\r\n    const [date, setDate] = useState('');\r\n    const [time, setTime] = useState('');\r\n    const [attendees, setAttendees] = useState('');\r\n    const [agenda, setAgenda] = useState('');\r\n    const [discussion, setDiscussion] = useState('');\r\n    const [actionItems, setActionItems] = useState<ActionItem[]>([]);\r\n    \r\n    // Function to format time in AM/PM format\r\n    const formatTimeAMPM = (time24: string) => {\r\n        if (!time24) return '';\r\n        const [hours, minutes] = time24.split(':');\r\n        const hour12 = ((parseInt(hours) + 11) % 12) + 1;\r\n        const ampm = parseInt(hours) >= 12 ? 'PM' : 'AM';\r\n        return `${hour12}:${minutes} ${ampm}`;\r\n    };\r\n    \r\n    // Action item form states\r\n    const [newActionTask, setNewActionTask] = useState('');\r\n    const [newActionOwner, setNewActionOwner] = useState('');\r\n    const [newActionDueDate, setNewActionDueDate] = useState('');\r\n    \r\n    // Add action item\r\n    const addActionItem = () => {\r\n        if (newActionTask.trim() && newActionOwner.trim() && newActionDueDate) {\r\n            const newItem: ActionItem = {\r\n                id: Date.now(),\r\n                task: newActionTask.trim(),\r\n                owner: newActionOwner.trim(),\r\n                dueDate: newActionDueDate\r\n            };\r\n            setActionItems([...actionItems, newItem]);\r\n            setNewActionTask('');\r\n            setNewActionOwner('');\r\n            setNewActionDueDate('');\r\n        }\r\n    };\r\n    \r\n    // Remove action item\r\n    const removeActionItem = (id: number) => {\r\n        setActionItems(actionItems.filter(item => item.id !== id));\r\n    };\r\n    const [nextMeeting, setNextMeeting] = useState('');\r\n\r\n    // Handle form submission\r\n    const handleSubmit = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        onAddMom({\r\n            title, date, time, attendees, agenda, discussion, actionItems, nextMeeting\r\n        });\r\n        // Clear form fields after submission\r\n        setTitle(''); setDate(''); setTime(''); setAttendees('');\r\n        setAgenda(''); setDiscussion(''); setActionItems([]); setNextMeeting('');\r\n        setNewActionTask(''); setNewActionOwner(''); setNewActionDueDate('');\r\n    };\r\n\r\n    return (\r\n        <div className=\"bg-white p-6 rounded-2xl shadow-xl border border-gray-200\">\r\n            <h2 className=\"text-2xl font-bold text-blue-700 mb-6 text-center\">New Meeting Note</h2>\r\n            <form onSubmit={handleSubmit} className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\">\r\n                {/* Input fields for Minutes of Meeting */}\r\n                <InputField label=\"Date\" type=\"date\" value={date} onChange={setDate} required />\r\n                <InputField label=\"Time\" type=\"time\" value={time} onChange={setTime} required />\r\n                <InputField label=\"Meeting Title\" type=\"text\" value={title} onChange={setTitle} required />\r\n                <InputField label=\"Attendees\" type=\"text\" value={attendees} onChange={setAttendees} placeholder=\"e.g., John Doe \" required />\r\n                <TextareaField label=\"Agenda\" value={agenda} onChange={setAgenda} rows={3} placeholder=\"Key topics to discuss...\" required />\r\n                <TextareaField label=\"Discussion\" value={discussion} onChange={setDiscussion} rows={5} placeholder=\"Summary of discussions and decisions...\" required />\r\n                \r\n                {/* Future Actions Management */}\r\n                <div className=\"md:col-span-2\">\r\n                    <label className=\"block text-gray-700 text-sm font-bold mb-2\">Future Actions</label>\r\n                    \r\n                    {/* Add Future Action Form */}\r\n                    <div className=\"bg-gray-50 p-4 rounded-lg mb-4\">\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-3\">\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Task Description</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"e.g., Prepare project report\"\r\n                                    value={newActionTask}\r\n                                    onChange={(e) => setNewActionTask(e.target.value)}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Assigned To</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"e.g., Mary Smith\"\r\n                                    value={newActionOwner}\r\n                                    onChange={(e) => setNewActionOwner(e.target.value)}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Due Date</label>\r\n                                <input\r\n                                    type=\"date\"\r\n                                    value={newActionDueDate}\r\n                                    onChange={(e) => setNewActionDueDate(e.target.value)}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                                />\r\n                            </div>\r\n                            <div className=\"flex items-end gap-2\">\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={addActionItem}\r\n                                    className=\"flex-1 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition duration-200\"\r\n                                >\r\n                                    Add\r\n                                </button>\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={() => {\r\n                                        setNewActionTask('');\r\n                                        setNewActionOwner('');\r\n                                        setNewActionDueDate('');\r\n                                    }}\r\n                                    className=\"flex-1 bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600 transition duration-200\"\r\n                                >\r\n                                    Clear\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    {/* Future Actions Table */}\r\n                    {actionItems.length > 0 && (\r\n                        <div className=\"overflow-x-auto\">\r\n                            <table className=\"w-full border-collapse border border-gray-300\">\r\n                                <thead>\r\n                                    <tr className=\"bg-gray-100\">\r\n                                        <th className=\"border border-gray-300 px-4 py-2 text-left\">Task</th>\r\n                                        <th className=\"border border-gray-300 px-4 py-2 text-left\">Owner</th>\r\n                                        <th className=\"border border-gray-300 px-4 py-2 text-left\">Due Date</th>\r\n                                        <th className=\"border border-gray-300 px-4 py-2 text-center\">Action</th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    {actionItems.map((item) => (\r\n                                        <tr key={item.id}>\r\n                                            <td className=\"border border-gray-300 px-4 py-2\">{item.task}</td>\r\n                                            <td className=\"border border-gray-300 px-4 py-2\">{item.owner}</td>\r\n                                            <td className=\"border border-gray-300 px-4 py-2\">{item.dueDate}</td>\r\n                                            <td className=\"border border-gray-300 px-4 py-2 text-center\">\r\n                                                <button\r\n                                                    type=\"button\"\r\n                                                    onClick={() => removeActionItem(item.id)}\r\n                                                    className=\"bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600 transition duration-200\"\r\n                                                >\r\n                                                    Delete\r\n                                                </button>\r\n                                            </td>\r\n                                        </tr>\r\n                                    ))}\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n                <InputField label=\"Next Meeting Date\" type=\"date\" value={nextMeeting} onChange={setNextMeeting} />\r\n\r\n                <div className=\"md:col-span-2 flex justify-center\">\r\n                    <button\r\n                        type=\"submit\"\r\n                        className=\"bg-blue-600 text-white px-8 py-3 rounded-full font-semibold text-lg shadow-lg hover:bg-blue-700 transition duration-300 ease-in-out transform hover:scale-105\"\r\n                    >\r\n                        Add New Meeting Note\r\n                    </button>\r\n                </div>\r\n            </form>\r\n\r\n            <h2 className=\"text-2xl font-bold text-blue-700 mb-4 text-center\">Meeting Notes</h2>\r\n            {momData.length === 0 ? (\r\n                <p className=\"text-center text-gray-600 p-4 border rounded-lg bg-gray-50\">No meeting notes are added yet. Add some above!</p>\r\n            ) : (\r\n                <div ref={momContentRef} data-pdf-content className=\"bg-gray-50 p-6 rounded-xl shadow-inner border border-gray-200 scrollable-content mb-6\">\r\n                    {momData.map((mom, index) => (\r\n                        <div key={mom.id} className=\"mb-6 pb-6 border-b border-gray-300 last:border-b-0 last:pb-0 relative\">\r\n                            <div className=\"flex justify-between items-start\">\r\n                                <h3 className=\"text-xl font-semibold text-blue-800 mb-2\">{mom.title || `Meeting ${index + 1}`}</h3>\r\n                                <button\r\n                                    onClick={() => onDeleteMom(mom.id)}\r\n                                    className=\"ml-4 bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded-md text-sm font-medium transition duration-200 flex items-center\"\r\n                                    title=\"Delete meeting note\"\r\n                                >\r\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4 mr-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n                                    </svg>\r\n                                    Delete\r\n                                </button>\r\n                            </div>\r\n                            <p className=\"text-gray-700 mb-1\"><strong>Date:</strong> {mom.date} at {formatTimeAMPM(mom.time)}</p>\r\n                            {mom.attendees && <p className=\"text-gray-700 mb-1\"><strong>Attendees:</strong> {mom.attendees}</p>}\r\n                            {mom.agenda && <p className=\"text-gray-700 mb-1\"><strong>Agenda:</strong> {mom.agenda}</p>}\r\n                            {mom.actionItems && <p className=\"text-gray-700 mb-1\"><strong>Discussion:</strong> {mom.discussion}</p>}\r\n                            {mom.actionItems && mom.actionItems.length > 0 && (\r\n                                <div className=\"mb-1\">\r\n                                    <p className=\"text-gray-700 font-bold mb-2\">Future Actions:</p>\r\n                                    <div className=\"overflow-x-auto\">\r\n                                        <table className=\"w-full border-collapse border border-gray-300 text-sm\">\r\n                                            <thead>\r\n                                                <tr className=\"bg-gray-100\">\r\n                                                    <th className=\"border border-gray-300 px-3 py-1 text-left\">Task</th>\r\n                                                    <th className=\"border border-gray-300 px-3 py-1 text-left\">Owner</th>\r\n                                                    <th className=\"border border-gray-300 px-3 py-1 text-left\">Due Date</th>\r\n                                                </tr>\r\n                                            </thead>\r\n                                            <tbody>\r\n                                                {mom.actionItems.map((item) => (\r\n                                                    <tr key={item.id}>\r\n                                                        <td className=\"border border-gray-300 px-3 py-1\">{item.task}</td>\r\n                                                        <td className=\"border border-gray-300 px-3 py-1\">{item.owner}</td>\r\n                                                        <td className=\"border border-gray-300 px-3 py-1\">{item.dueDate}</td>\r\n                                                    </tr>\r\n                                                ))}\r\n                                            </tbody>\r\n                                        </table>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                            {mom.nextMeeting && <p className=\"text-gray-700\"><strong>Next Meeting:</strong> {mom.nextMeeting}</p>}\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n            \r\n            {/* Always show buttons, but disable when no data */}\r\n            <div className=\"flex flex-col sm:flex-row justify-center gap-4 mt-6\">\r\n                <ActionButton\r\n                    onClick={momData.length > 0 ? downloadPdf : () => alert('Please add meeting notes first')}\r\n                    label=\"Download PDF\"\r\n                    icon=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\"\r\n                    color=\"green\"\r\n                />\r\n                <ActionButton\r\n                    onClick={momData.length > 0 ? downloadExcel : () => alert('Please add meeting notes first')}\r\n                    label=\"Download Excel\"\r\n                    icon=\"M13 14l-4-4m0 0l-4 4m4-4v12\"\r\n                    color=\"blue\"\r\n                />\r\n                <ActionButton\r\n                    onClick={momData.length > 0 ? () => sendEmail(momData, 'Meeting Notes', 'MeetingNotes') : () => alert('Please add meeting notes first')}\r\n                    label=\"Send Email\"\r\n                    icon=\"M3 8l4 4 4-4m0 6l-4 4-4-4\"\r\n                    color=\"orange\"\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n// GanttChart Component\r\ninterface GanttChartProps {\r\n    projectSchedule: ProjectSchedule;\r\n}\r\n\r\nconst GanttChart: React.FC<GanttChartProps> = ({ projectSchedule }) => {\r\n    // Helper function to calculate position and width of task bars\r\n    const getTaskBarStyle = (task: Task) => {\r\n        if (!task.taskStartDate || !task.taskEndDate || !projectSchedule.startDate || !projectSchedule.endDate) {\r\n            return { left: '0%', width: '0%' };\r\n        }\r\n\r\n        const projectStart = new Date(projectSchedule.startDate);\r\n        const projectEnd = new Date(projectSchedule.endDate);\r\n        const taskStart = new Date(task.taskStartDate);\r\n        const taskEnd = new Date(task.taskEndDate);\r\n        \r\n        const projectDuration = projectEnd.getTime() - projectStart.getTime();\r\n        const taskStartOffset = taskStart.getTime() - projectStart.getTime();\r\n        const taskDuration = taskEnd.getTime() - taskStart.getTime();\r\n        \r\n        const leftPercent = Math.max(0, (taskStartOffset / projectDuration) * 100);\r\n        const widthPercent = Math.min(100 - leftPercent, (taskDuration / projectDuration) * 100);\r\n        \r\n        return {\r\n            left: `${leftPercent}%`,\r\n            width: `${widthPercent}%`\r\n        };\r\n    };\r\n\r\n    // Helper function to get status color\r\n    const getStatusColor = (status: string) => {\r\n        switch (status) {\r\n            case 'Completed': return 'bg-green-500';\r\n            case 'In Progress': return 'bg-yellow-500';\r\n            case 'Blocked': return 'bg-red-500';\r\n            default: return 'bg-gray-400';\r\n        }\r\n    };\r\n\r\n    // Helper function to format date for display\r\n    const formatDate = (dateString: string) => {\r\n        if (!dateString) return '';\r\n        return new Date(dateString).toLocaleDateString('en-US', { \r\n            month: 'short', \r\n            day: 'numeric' \r\n        });\r\n    };\r\n\r\n    // Generate time scale markers\r\n    const generateTimeScale = () => {\r\n        if (!projectSchedule.startDate || !projectSchedule.endDate) return [];\r\n        \r\n        const start = new Date(projectSchedule.startDate);\r\n        const end = new Date(projectSchedule.endDate);\r\n        const markers = [];\r\n        \r\n        // Create weekly markers for better readability\r\n        const current = new Date(start);\r\n        current.setDate(current.getDate() - current.getDay()); // Start from beginning of week\r\n        \r\n        while (current <= end) {\r\n            const position = ((current.getTime() - start.getTime()) / (end.getTime() - start.getTime())) * 100;\r\n            if (position >= 0 && position <= 100) {\r\n                markers.push({\r\n                    position: `${position}%`,\r\n                    date: formatDate(current.toISOString().split('T')[0])\r\n                });\r\n            }\r\n            current.setDate(current.getDate() + 7); // Next week\r\n        }\r\n        \r\n        return markers;\r\n    };\r\n\r\n    const timeMarkers = generateTimeScale();\r\n\r\n    return (\r\n        <div className=\"bg-white p-4 rounded-lg shadow-md border border-gray-200 mt-4\">\r\n            <h4 className=\"text-lg font-medium text-gray-700 mb-4\">Timeline Gantt Chart</h4>\r\n            \r\n            {/* Time scale header */}\r\n            <div className=\"relative mb-2 h-8 bg-gray-50 rounded border\">\r\n                {timeMarkers.map((marker, index) => (\r\n                    <div\r\n                        key={index}\r\n                        className=\"absolute top-0 h-full\"\r\n                        style={{ left: marker.position }}\r\n                    >\r\n                        <div className=\"w-px h-full bg-gray-300\"></div>\r\n                        <div className=\"absolute top-1 left-1 text-xs text-gray-600 whitespace-nowrap\">\r\n                            {marker.date}\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Tasks */}\r\n            <div className=\"space-y-2\">\r\n                {projectSchedule.tasks.map((task, index) => (\r\n                    <div key={task.id} className=\"relative\">\r\n                        {/* Task info */}\r\n                        <div className=\"flex items-center mb-1\">\r\n                            <div className=\"w-48 text-sm font-medium text-gray-700 truncate mr-4\">\r\n                                {task.description}\r\n                            </div>\r\n                            <div className=\"text-xs text-gray-500\">\r\n                                {task.assignedTo && `(${task.assignedTo})`}\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        {/* Gantt bar container */}\r\n                        <div className=\"relative h-6 bg-gray-100 rounded border\">\r\n                            {/* Task bar */}\r\n                            <div\r\n                                className={`absolute top-0 h-full rounded ${getStatusColor(task.status)} opacity-80 flex items-center justify-center`}\r\n                                style={getTaskBarStyle(task)}\r\n                                title={`${task.description}: ${formatDate(task.taskStartDate)} - ${formatDate(task.taskEndDate)} (${task.status})`}\r\n                            >\r\n                                <span className=\"text-xs text-white font-medium px-1 truncate\">\r\n                                    {task.status === 'Completed' ? '✓' : \r\n                                     task.status === 'In Progress' ? '⏳' : \r\n                                     task.status === 'Blocked' ? '⚠️' : '○'}\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        {/* Date labels */}\r\n                        <div className=\"flex justify-between text-xs text-gray-500 mt-1\">\r\n                            <span>{formatDate(task.taskStartDate)}</span>\r\n                            <span>{formatDate(task.taskEndDate)}</span>\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n            \r\n            {/* Legend */}\r\n            <div className=\"mt-4 flex flex-wrap gap-4 text-xs\">\r\n                <div className=\"flex items-center\">\r\n                    <div className=\"w-3 h-3 bg-gray-400 rounded mr-1\"></div>\r\n                    <span>Not Started</span>\r\n                </div>\r\n                <div className=\"flex items-center\">\r\n                    <div className=\"w-3 h-3 bg-yellow-500 rounded mr-1\"></div>\r\n                    <span>In Progress</span>\r\n                </div>\r\n                <div className=\"flex items-center\">\r\n                    <div className=\"w-3 h-3 bg-green-500 rounded mr-1\"></div>\r\n                    <span>Completed</span>\r\n                </div>\r\n                <div className=\"flex items-center\">\r\n                    <div className=\"w-3 h-3 bg-red-500 rounded mr-1\"></div>\r\n                    <span>Blocked</span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n// ProjectSchedule Component\r\ninterface ProjectScheduleProps {\r\n    onAddProjectSchedule: (newSchedule: Omit<ProjectSchedule, 'id'>) => void;\r\n    onDeleteProjectSchedule: (id: number) => void;\r\n    projectScheduleData: ProjectSchedule[];\r\n    projectScheduleContentRef: React.RefObject<HTMLDivElement>;\r\n    downloadPdf: () => void;\r\n    downloadExcel: () => void;\r\n    sendEmail: (content: ProjectSchedule[], subject: string, filename: string) => void;\r\n}\r\n\r\nconst ProjectScheduleComponent: React.FC<ProjectScheduleProps> = ({ onAddProjectSchedule, onDeleteProjectSchedule, projectScheduleData, projectScheduleContentRef, downloadPdf, downloadExcel, sendEmail }) => {\r\n    // State for Timeline form fields\r\n    const [projectName, setProjectName] = useState('');\r\n    const [startDate, setStartDate] = useState('');\r\n    const [endDate, setEndDate] = useState('');\r\n    // State for managing multiple tasks\r\n    const [tasks, setTasks] = useState<Task[]>([\r\n        { id: 1, description: '', taskStartDate: '', taskEndDate: '', status: 'Not Started', assignedTo: '' }\r\n    ]);\r\n\r\n    // Handle adding a new task row\r\n    const addTask = () => {\r\n        setTasks(prev => [...prev, { id: Date.now(), description: '', taskStartDate: '', taskEndDate: '', status: 'Not Started', assignedTo: '' }]);\r\n    };\r\n\r\n    // Handle updating a specific task field\r\n    const handleTaskChange = (id: number, field: keyof Task, value: string) => {\r\n        setTasks(prev => prev.map(task =>\r\n            task.id === id ? { ...task, [field]: value } : task\r\n        ));\r\n    };\r\n\r\n    // Handle form submission\r\n    const handleSubmit = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        \r\n        // Validate required task fields\r\n        const invalidTasks = tasks.filter(task => \r\n            !task.description.trim() || \r\n            !task.assignedTo.trim() || \r\n            !task.taskStartDate || \r\n            !task.taskEndDate || \r\n            !task.status\r\n        );\r\n        \r\n        if (invalidTasks.length > 0) {\r\n            alert('Please fill in all required fields (Task Description, Assigned To, Start Date, End Date, and Status) for all tasks.');\r\n            return;\r\n        }\r\n        \r\n        onAddProjectSchedule({\r\n            projectName, startDate, endDate, tasks\r\n        });\r\n        // Clear form fields and reset tasks after submission\r\n        setProjectName(''); setStartDate(''); setEndDate('');\r\n        setTasks([{ id: 1, description: '', taskStartDate: '', taskEndDate: '', status: 'Not Started', assignedTo: '' }]);\r\n    };\r\n\r\n    return (\r\n        <div className=\"bg-white p-6 rounded-2xl shadow-xl border border-gray-200\">\r\n            <h2 className=\"text-2xl font-bold text-blue-700 mb-6 text-center\">New Project Schedule</h2>\r\n            <p className=\"text-center text-gray-600 mb-6 text-sm\">Create project schedules with Gantt chart visualization to track task timelines and dependencies</p>\r\n            <form onSubmit={handleSubmit} className=\"mb-8\">\r\n                {/* Project details in one row */}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\r\n                    <InputField label=\"Project Name\" type=\"text\" value={projectName} onChange={setProjectName} required />\r\n                    <InputField label=\"Start Date\" type=\"date\" value={startDate} onChange={setStartDate} required />\r\n                    <InputField label=\"End Date\" type=\"date\" value={endDate} onChange={setEndDate} required />\r\n                </div>\r\n\r\n                <div className=\"mt-4\">\r\n                    <h3 className=\"text-xl font-semibold text-gray-700 mb-4 border-b pb-2\">Project timeline</h3>\r\n                    {tasks.map((task, index) => (\r\n                        <div key={task.id} className=\"mb-4 p-4 border border-gray-200 rounded-lg bg-gray-50 shadow-sm\">\r\n                            {/* First row: Description and Assigned To */}\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\r\n                                <InputField\r\n                                    label=\"Task Description\"\r\n                                    type=\"text\"\r\n                                    value={task.description}\r\n                                    onChange={(val: string) => handleTaskChange(task.id, 'description', val)}\r\n                                    placeholder=\"e.g., Design UI\"\r\n                                    required\r\n                                />\r\n                                <InputField\r\n                                    label=\"Assigned To\"\r\n                                    type=\"text\"\r\n                                    value={task.assignedTo}\r\n                                    onChange={(val: string) => handleTaskChange(task.id, 'assignedTo', val)}\r\n                                    placeholder=\"e.g., Alice\"\r\n                                    required\r\n                                />\r\n                            </div>\r\n                            {/* Second row: Start Date, End Date, and Status */}\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                                <InputField\r\n                                    label=\"Start Date\"\r\n                                    type=\"date\"\r\n                                    value={task.taskStartDate}\r\n                                    onChange={(val: string) => handleTaskChange(task.id, 'taskStartDate', val)}\r\n                                    required\r\n                                />\r\n                                <InputField\r\n                                    label=\"End Date\"\r\n                                    type=\"date\"\r\n                                    value={task.taskEndDate}\r\n                                    onChange={(val: string) => handleTaskChange(task.id, 'taskEndDate', val)}\r\n                                    required\r\n                                />\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Status <span className=\"text-red-500\">*</span></label>\r\n                                    <select\r\n                                        className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm\"\r\n                                        value={task.status}\r\n                                        onChange={(e) => handleTaskChange(task.id, 'status', e.target.value)}\r\n                                        required\r\n                                    >\r\n                                        <option value=\"Not Started\">Not Started</option>\r\n                                        <option value=\"In Progress\">In Progress</option>\r\n                                        <option value=\"Completed\">Completed</option>\r\n                                        <option value=\"Blocked\">Blocked</option>\r\n                                    </select>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n\r\n                <div className=\"flex justify-center gap-4 mt-6\">\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={addTask}\r\n                        className=\"bg-green-500 text-white px-8 py-3 rounded-full font-semibold text-lg shadow-lg hover:bg-green-600 transition duration-300 ease-in-out transform hover:scale-105\"\r\n                    >\r\n                        Add\r\n                    </button>\r\n                    <button\r\n                        type=\"submit\"\r\n                        className=\"bg-blue-600 text-white px-8 py-3 rounded-full font-semibold text-lg shadow-lg hover:bg-blue-700 transition duration-300 ease-in-out transform hover:scale-105\"\r\n                    >\r\n                        Save\r\n                    </button>\r\n                </div>\r\n            </form>\r\n\r\n            <h2 className=\"text-2xl font-bold text-blue-700 mb-4 text-center\">Project Schedule</h2>\r\n            {projectScheduleData.length === 0 ? (\r\n                <p className=\"text-center text-gray-600 p-4 border rounded-lg bg-gray-50\">No project timelines are added yet. Add some above!</p>\r\n            ) : (\r\n                <>\r\n                    <div ref={projectScheduleContentRef} data-pdf-content className=\"bg-gray-50 p-6 rounded-xl shadow-inner border border-gray-200 scrollable-content mb-6\">\r\n                        {projectScheduleData.map((schedule, index) => (\r\n                            <div key={schedule.id} className=\"mb-6 pb-6 border-b border-gray-300 last:border-b-0 last:pb-0\">\r\n                                <div className=\"flex justify-between items-start\">\r\n                                    <h3 className=\"text-xl font-semibold text-blue-800 mb-2\">{schedule.projectName || `Project ${index + 1}`}</h3>\r\n                                    <button\r\n                                        onClick={() => onDeleteProjectSchedule(schedule.id)}\r\n                                        className=\"ml-4 bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded-md text-sm font-medium transition duration-200 flex items-center\"\r\n                                        title=\"Delete timeline\"\r\n                                    >\r\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4 mr-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n                                        </svg>\r\n                                        Delete\r\n                                    </button>\r\n                                </div>\r\n                                <p className=\"text-gray-700 mb-1\"><strong>Duration:</strong> {schedule.startDate} to {schedule.endDate}</p>\r\n                                <h4 className=\"text-lg font-medium text-gray-700 mt-4 mb-2\">Tasks:</h4>\r\n                                <div className=\"overflow-x-auto\">\r\n                                    <table className=\"min-w-full bg-white rounded-lg shadow-md overflow-hidden\">\r\n                                        <thead className=\"bg-blue-100\">\r\n                                            <tr>\r\n                                                <th className=\"py-2 px-4 text-left text-sm font-semibold text-blue-800 uppercase tracking-wider rounded-tl-lg\">Task Description</th>\r\n                                                <th className=\"py-2 px-4 text-left text-sm font-semibold text-blue-800 uppercase tracking-wider\">Start Date</th>\r\n                                                <th className=\"py-2 px-4 text-left text-sm font-semibold text-blue-800 uppercase tracking-wider\">End Date</th>\r\n                                                <th className=\"py-2 px-4 text-left text-sm font-semibold text-blue-800 uppercase tracking-wider\">Status</th>\r\n                                                <th className=\"py-2 px-4 text-left text-sm font-semibold text-blue-800 uppercase tracking-wider rounded-tr-lg\">Assigned To</th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody>\r\n                                            {schedule.tasks.map(task => (\r\n                                                <tr key={task.id} className=\"border-b border-gray-200 last:border-b-0 hover:bg-gray-50\">\r\n                                                    <td className=\"py-2 px-4 text-sm text-gray-800\">{task.description}</td>\r\n                                                    <td className=\"py-2 px-4 text-sm text-gray-800\">{task.taskStartDate}</td>\r\n                                                    <td className=\"py-2 px-4 text-sm text-gray-800\">{task.taskEndDate}</td>\r\n                                                    <td className=\"py-2 px-4 text-sm text-gray-800\">\r\n                                                        <span className={`px-2 py-1 rounded-full text-xs font-semibold\r\n                                                            ${task.status === 'Completed' ? 'bg-green-200 text-green-800' :\r\n                                                            task.status === 'In Progress' ? 'bg-yellow-200 text-yellow-800' :\r\n                                                            task.status === 'Blocked' ? 'bg-red-200 text-red-800' :\r\n                                                            'bg-gray-200 text-gray-800'}`\r\n                                                        }>\r\n                                                            {task.status}\r\n                                                        </span>\r\n                                                    </td>\r\n                                                    <td className=\"py-2 px-4 text-sm text-gray-800\">{task.assignedTo}</td>\r\n                                                </tr>\r\n                                            ))}\r\n                                        </tbody>\r\n                                    </table>\r\n                                </div>\r\n                                \r\n                                {/* Gantt Chart */}\r\n                                <GanttChart projectSchedule={schedule} />\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                    <div className=\"flex flex-col sm:flex-row justify-center gap-4 mt-6\">\r\n                        <ActionButton\r\n                            onClick={downloadPdf}\r\n                            label=\"Download PDF\"\r\n                            icon=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\"\r\n                            color=\"teal\"\r\n                        />\r\n                        <ActionButton\r\n                            onClick={downloadExcel}\r\n                            label=\"Download Excel\"\r\n                            icon=\"M13 14l-4-4m0 0l-4 4m4-4v12\"\r\n                            color=\"blue\"\r\n                        />\r\n                        <ActionButton\r\n                            onClick={() => sendEmail(projectScheduleData, 'Timeline', 'ProjectTimeline')}\r\n                            label=\"Send Email\"\r\n                            icon=\"M3 8l4 4 4-4m0 6l-4 4-4-4\"\r\n                            color=\"pink\"\r\n                        />\r\n                    </div>\r\n                </>\r\n            )}\r\n            \r\n            {/* Always show buttons when no data, but show alert */}\r\n            {projectScheduleData.length === 0 && (\r\n                <div className=\"flex flex-col sm:flex-row justify-center gap-4 mt-6\">\r\n                    <ActionButton\r\n                        onClick={() => alert('Please add project timelines first')}\r\n                        label=\"Download PDF\"\r\n                        icon=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\"\r\n                        color=\"orange\"\r\n                    />\r\n                    <ActionButton\r\n                        onClick={() => alert('Please add project timelines first')}\r\n                        label=\"Download Excel\"\r\n                        icon=\"M13 14l-4-4m0 0l-4 4m4-4v12\"\r\n                        color=\"blue\"\r\n                    />\r\n                    <ActionButton\r\n                        onClick={() => alert('Please add project timelines first')}\r\n                        label=\"Send Email\"\r\n                        icon=\"M3 8l4 4 4-4m0 6l-4 4-4-4\"\r\n                        color=\"pink\"\r\n                    />\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\n// Reusable Input Field Component\r\ninterface InputFieldProps {\r\n    label: string;\r\n    type: string;\r\n    value: string;\r\n    onChange: (value: string) => void;\r\n    required?: boolean;\r\n    placeholder?: string;\r\n}\r\n\r\nconst InputField: React.FC<InputFieldProps> = ({ label, type, value, onChange, required = false, placeholder = '' }) => (\r\n    <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n            {label} {required && <span className=\"text-red-500\">*</span>}\r\n        </label>\r\n        <input\r\n            type={type}\r\n            value={value}\r\n            onChange={(e) => onChange(e.target.value)}\r\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm\"\r\n            required={required}\r\n            placeholder={placeholder}\r\n        />\r\n    </div>\r\n);\r\n\r\n// Reusable Textarea Field Component\r\ninterface TextareaFieldProps {\r\n    label: string;\r\n    value: string;\r\n    onChange: (value: string) => void;\r\n    rows: number;\r\n    placeholder?: string;\r\n    required?: boolean;\r\n}\r\n\r\nconst TextareaField: React.FC<TextareaFieldProps> = ({ label, value, onChange, rows, placeholder = '', required = false }) => (\r\n    <div className=\"md:col-span-2\">\r\n        <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n            {label} {required && <span className=\"text-red-500\">*</span>}\r\n        </label>\r\n        <textarea\r\n            value={value}\r\n            onChange={(e) => onChange(e.target.value)}\r\n            rows={rows}\r\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm\"\r\n            required={required}\r\n            placeholder={placeholder}\r\n        ></textarea>\r\n    </div>\r\n);\r\n\r\n// Reusable Action Button Component\r\ninterface ActionButtonProps {\r\n    onClick: () => void;\r\n    label: string;\r\n    icon: string;\r\n    color: 'blue' | 'purple' | 'green' | 'red' | 'orange' | 'pink' | 'indigo' | 'teal';\r\n}\r\n\r\nconst ActionButton: React.FC<ActionButtonProps> = ({ onClick, label, icon, color }) => (\r\n    <button\r\n        onClick={onClick}\r\n        className={`flex items-center justify-center px-6 py-3 rounded-full font-semibold text-lg transition duration-300 ease-in-out transform hover:scale-105 shadow-md\r\n            ${color === 'blue' ? 'bg-blue-500 text-white hover:bg-blue-600' :\r\n              color === 'purple' ? 'bg-purple-500 text-white hover:bg-purple-600' :\r\n              color === 'green' ? 'bg-green-500 text-white hover:bg-green-600' :\r\n              color === 'red' ? 'bg-red-500 text-white hover:bg-red-600' :\r\n              color === 'orange' ? 'bg-orange-500 text-white hover:bg-orange-600' :\r\n              color === 'pink' ? 'bg-pink-500 text-white hover:bg-pink-600' :\r\n              color === 'indigo' ? 'bg-indigo-500 text-white hover:bg-indigo-600' :\r\n              color === 'teal' ? 'bg-teal-500 text-white hover:bg-teal-600' :\r\n              'bg-gray-500 text-white hover:bg-gray-600'}`\r\n        }\r\n    >\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6 mr-2\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d={icon} />\r\n        </svg>\r\n        {label}\r\n    </button>\r\n);\r\n\r\n// Kanban Board Component\r\ninterface TaskBoardProps {\r\n    onAddTask: (newTask: Omit<TaskCard, 'id'>) => void;\r\n    onDeleteTask: (id: number) => void;\r\n    onUpdateTaskStatus: (taskId: number, newStatus: TaskCard['status']) => void;\r\n    taskBoardData: TaskCard[];\r\n    taskBoardContentRef: React.RefObject<HTMLDivElement>;\r\n    downloadPdf: () => void;\r\n    downloadExcel: () => void;\r\n    sendEmail: (content: TaskCard[], subject: string, filename: string) => void;\r\n}\r\n\r\nconst TaskBoardComponent: React.FC<TaskBoardProps> = ({ onAddTask, onDeleteTask, onUpdateTaskStatus, taskBoardData, taskBoardContentRef, downloadPdf, downloadExcel, sendEmail }) => {\r\n    const [title, setTitle] = useState('');\r\n    const [description, setDescription] = useState('');\r\n    const [assignedTo, setAssignedTo] = useState('');\r\n    const [priority, setPriority] = useState<TaskCard['priority']>('Low');\r\n    const [dueDate, setDueDate] = useState('');\r\n    const [tags, setTags] = useState('');\r\n\r\n    const handleSubmit = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        \r\n        // Validate required fields\r\n        if (!title.trim()) {\r\n            alert('Please enter a task title.');\r\n            return;\r\n        }\r\n        if (!assignedTo.trim()) {\r\n            alert('Please assign the task to someone.');\r\n            return;\r\n        }\r\n        if (!description.trim()) {\r\n            alert('Please provide a task description.');\r\n            return;\r\n        }\r\n        if (!priority) {\r\n            alert('Please select a priority level.');\r\n            return;\r\n        }\r\n        if (!dueDate) {\r\n            alert('Please select a due date.');\r\n            return;\r\n        }\r\n        \r\n        onAddTask({\r\n            title, description, assignedTo, priority, status: 'Not Started', dueDate,\r\n            tags: tags.split(',').map(tag => tag.trim()).filter(tag => tag)\r\n        });\r\n        setTitle(''); setDescription(''); setAssignedTo(''); setPriority('Low'); setDueDate(''); setTags('');\r\n    };\r\n\r\n    const getStatusTasks = (status: TaskCard['status']) => taskBoardData.filter(task => task.status === status);\r\n    const statusColumns: TaskCard['status'][] = ['Not Started', 'In Progress', 'Review', 'Done'];\r\n\r\n    return (\r\n        <div className=\"bg-white p-6 rounded-2xl shadow-xl border border-gray-200\">\r\n            <h2 className=\"text-2xl font-bold text-blue-700 mb-6 text-center\">Kanban Board</h2>\r\n            <p className=\"text-center text-gray-600 mb-6 text-sm\">Manage individual tasks with priority levels and workflow status tracking through Kanban columns</p>\r\n            \r\n            <form onSubmit={handleSubmit} className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8 p-4 bg-gray-50 rounded-lg\">\r\n                <InputField label=\"Task\" type=\"text\" value={title} onChange={setTitle} required />\r\n                <InputField label=\"Assigned To\" type=\"text\" value={assignedTo} onChange={setAssignedTo} placeholder=\"e.g., John Doe\" required />\r\n                <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Priority <span className=\"text-red-500\">*</span></label>\r\n                    <select \r\n                        className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm\"\r\n                        value={priority} \r\n                        onChange={(e) => setPriority(e.target.value as TaskCard['priority'])}\r\n                        required\r\n                    >\r\n                        <option value=\"Low\">Low</option>\r\n                        <option value=\"Medium\">Medium</option>\r\n                        <option value=\"High\">High</option>\r\n                    </select>\r\n                </div>\r\n                <InputField label=\"Due Date\" type=\"date\" value={dueDate} onChange={setDueDate} required />\r\n                <TextareaField label=\"Description\" value={description} onChange={setDescription} rows={3} placeholder=\"Task details...\" required />\r\n                <InputField label=\"Category\" type=\"text\" value={tags} onChange={setTags} placeholder=\"e.g., sales, urgent\" />\r\n                \r\n                <div className=\"md:col-span-2 flex justify-center\">\r\n                    <button type=\"submit\" className=\"bg-blue-600 text-white px-6 py-2 rounded-full font-semibold shadow-lg hover:bg-blue-700 transition duration-300\">\r\n                        Add Task\r\n                    </button>\r\n                </div>\r\n            </form>\r\n\r\n            <div ref={taskBoardContentRef} data-pdf-content>\r\n                <div className=\"text-center mb-4\">\r\n                    <h3 className=\"text-lg font-semibold text-gray-700\">Task Status</h3>\r\n                </div>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\r\n                    {statusColumns.map(status => (\r\n                        <div key={status} className=\"bg-gray-50 p-4 rounded-lg shadow-inner\">\r\n                            <h4 className={`text-lg font-semibold mb-4 text-center py-2 rounded ${\r\n                                status === 'Not Started' ? 'bg-gray-200 text-gray-800' :\r\n                                status === 'In Progress' ? 'bg-yellow-200 text-yellow-800' :\r\n                                status === 'Review' ? 'bg-blue-200 text-blue-800' :\r\n                                'bg-green-200 text-green-800'\r\n                            }`}>\r\n                                {status} ({getStatusTasks(status).length})\r\n                            </h4>\r\n                        <div className=\"space-y-3 min-h-[200px]\">\r\n                            {getStatusTasks(status).map(task => (\r\n                                <div key={task.id} className=\"bg-white p-3 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow\">\r\n                                    <h4 className=\"font-semibold text-gray-800 mb-1\">{task.title}</h4>\r\n                                    <p className=\"text-sm text-gray-600 mb-2\">{task.description}</p>\r\n                                    <div className=\"flex justify-between items-center mb-2\">\r\n                                        <span className={`px-2 py-1 rounded text-xs font-semibold ${\r\n                                            task.priority === 'High' ? 'bg-red-200 text-red-800' :\r\n                                            task.priority === 'Medium' ? 'bg-yellow-200 text-yellow-800' :\r\n                                            'bg-green-200 text-green-800'\r\n                                        }`}>\r\n                                            {task.priority}\r\n                                        </span>\r\n                                        <span className=\"text-xs text-gray-500\">{task.dueDate}</span>\r\n                                    </div>\r\n                                    <p className=\"text-sm text-gray-600 mb-2\">👤 {task.assignedTo}</p>\r\n                                    {task.tags.length > 0 && (\r\n                                        <div className=\"flex flex-wrap gap-1 mb-2\">\r\n                                            {task.tags.map((tag, idx) => (\r\n                                                <span key={idx} className=\"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded\">\r\n                                                    {tag}\r\n                                                </span>\r\n                                            ))}\r\n                                        </div>\r\n                                    )}\r\n                                    <div className=\"flex gap-2\">\r\n                                        <select \r\n                                            className=\"flex-1 text-xs p-1 border border-gray-300 rounded\"\r\n                                            value={task.status}\r\n                                            onChange={(e) => onUpdateTaskStatus(task.id, e.target.value as TaskCard['status'])}\r\n                                        >\r\n                                            <option value=\"Not Started\">Not Started</option>\r\n                                            <option value=\"In Progress\">In Progress</option>\r\n                                            <option value=\"Review\">Review</option>\r\n                                            <option value=\"Done\">Done</option>\r\n                                        </select>\r\n                                        <button\r\n                                            onClick={() => onDeleteTask(task.id)}\r\n                                            className=\"px-2 py-1 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition duration-200\"\r\n                                            title=\"Delete task\"\r\n                                        >\r\n                                            🗑️\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n            </div>\r\n\r\n            <div className=\"flex flex-col sm:flex-row justify-center gap-4 mt-6\">\r\n                <ActionButton\r\n                    onClick={taskBoardData.length > 0 ? downloadPdf : () => alert('Please add tasks first')}\r\n                    label=\"Download PDF\"\r\n                    icon=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\"\r\n                    color=\"purple\"\r\n                />\r\n                <ActionButton\r\n                    onClick={taskBoardData.length > 0 ? downloadExcel : () => alert('Please add tasks first')}\r\n                    label=\"Download Excel\"\r\n                    icon=\"M13 14l-4-4m0 0l-4 4m4-4v12\"\r\n                    color=\"blue\"\r\n                />\r\n                <ActionButton\r\n                    onClick={taskBoardData.length > 0 ? () => sendEmail(taskBoardData, 'Task Board', 'TaskBoard') : () => alert('Please add tasks first')}\r\n                    label=\"Send Email\"\r\n                    icon=\"M3 8l4 4 4-4m0 6l-4 4-4-4\"\r\n                    color=\"indigo\"\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n// Budget Calculator Component\r\ninterface BudgetCalculatorProps {\r\n    onAddBudget: (newBudget: Omit<ProjectBudget, 'id'>) => void;\r\n    onDeleteBudget: (id: number) => void;\r\n    budgetData: ProjectBudget[];\r\n    budgetContentRef: React.RefObject<HTMLDivElement>;\r\n    downloadPdf: () => void;\r\n    downloadExcel: () => void;\r\n    sendEmail: (content: ProjectBudget[], subject: string, filename: string) => void;\r\n}\r\n\r\nconst BudgetCalculatorComponent: React.FC<BudgetCalculatorProps> = ({ onAddBudget, onDeleteBudget, budgetData, budgetContentRef, downloadPdf, downloadExcel, sendEmail }) => {\r\n    const [projectName, setProjectName] = useState('');\r\n    const [totalBudget, setTotalBudget] = useState('');\r\n    const [budgetItems, setBudgetItems] = useState<BudgetItem[]>([\r\n        { id: 1, category: '', description: '', estimatedCost: 0, actualCost: 0, earnedValue: 0, notes: '' }\r\n    ]);\r\n\r\n    const addBudgetItem = () => {\r\n        setBudgetItems(prev => [...prev, { \r\n            id: Date.now(), category: '', description: '', estimatedCost: 0, actualCost: 0, earnedValue: 0, notes: '' \r\n        }]);\r\n    };\r\n\r\n    const handleBudgetItemChange = (id: number, field: keyof BudgetItem, value: string | number) => {\r\n        setBudgetItems(prev => prev.map(item =>\r\n            item.id === id ? { ...item, [field]: value } : item\r\n        ));\r\n    };\r\n\r\n    const removeBudgetItem = (id: number) => {\r\n        if (budgetItems.length > 1) {\r\n            setBudgetItems(prev => prev.filter(item => item.id !== id));\r\n        }\r\n    };\r\n\r\n    const handleSubmit = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        \r\n        // Validate required cost category fields\r\n        const invalidItems = budgetItems.filter(item => \r\n            !item.category.trim() || \r\n            !item.description.trim() ||\r\n            item.estimatedCost < 0 ||\r\n            item.actualCost < 0 ||\r\n            item.earnedValue < 0\r\n        );\r\n        \r\n        if (invalidItems.length > 0) {\r\n            alert('Please fill in all required fields (Category, Description, Planned Value, and Actual Cost) for all cost categories. Values cannot be negative.');\r\n            return;\r\n        }\r\n        \r\n        onAddBudget({\r\n            projectName, totalBudget: parseFloat(totalBudget), items: budgetItems\r\n        });\r\n        setProjectName(''); setTotalBudget('');\r\n        setBudgetItems([{ id: 1, category: '', description: '', estimatedCost: 0, actualCost: 0, earnedValue: 0, notes: '' }]);\r\n    };\r\n\r\n    const getTotalEstimated = (budget: ProjectBudget) => budget.items.reduce((sum, item) => sum + item.estimatedCost, 0);\r\n    const getTotalActual = (budget: ProjectBudget) => budget.items.reduce((sum, item) => sum + item.actualCost, 0);\r\n    const getTotalEarnedValue = (budget: ProjectBudget) => budget.items.reduce((sum, item) => sum + item.earnedValue, 0);\r\n    \r\n    // EVM Calculations\r\n    const getScheduleVariance = (budget: ProjectBudget) => {\r\n        const ev = getTotalEarnedValue(budget);\r\n        const pv = getTotalEstimated(budget);\r\n        return ev - pv; // SV = EV - PV\r\n    };\r\n    \r\n    const getCostVariance = (budget: ProjectBudget) => {\r\n        const ev = getTotalEarnedValue(budget);\r\n        const ac = getTotalActual(budget);\r\n        return ev - ac; // CV = EV - AC\r\n    };\r\n    \r\n    const getSchedulePerformanceIndex = (budget: ProjectBudget) => {\r\n        const ev = getTotalEarnedValue(budget);\r\n        const pv = getTotalEstimated(budget);\r\n        return pv > 0 ? ev / pv : 0; // SPI = EV / PV\r\n    };\r\n    \r\n    const getCostPerformanceIndex = (budget: ProjectBudget) => {\r\n        const ev = getTotalEarnedValue(budget);\r\n        const ac = getTotalActual(budget);\r\n        return ac > 0 ? ev / ac : 0; // CPI = EV / AC\r\n    };\r\n\r\n    return (\r\n        <div className=\"bg-white p-6 rounded-2xl shadow-xl border border-gray-200\">\r\n            <h2 className=\"text-2xl font-bold text-blue-700 mb-6 text-center\">Project Budget Calculator</h2>\r\n            \r\n            <form onSubmit={handleSubmit} className=\"mb-8\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\">\r\n                    <InputField label=\"Project Name\" type=\"text\" value={projectName} onChange={setProjectName} required />\r\n                    <InputField label=\"Budget at Completion (BAC)\" type=\"number\" value={totalBudget} onChange={setTotalBudget} placeholder=\"$0.00\" required />\r\n                </div>\r\n\r\n                <h3 className=\"text-xl font-semibold text-gray-700 mb-4 border-b pb-2\">Cost Categories</h3>\r\n                {budgetItems.map((item, index) => (\r\n                    <div key={item.id} className=\"grid grid-cols-1 md:grid-cols-7 gap-4 mb-4 p-4 border border-gray-200 rounded-lg bg-gray-50 relative\">\r\n                        {budgetItems.length > 1 && (\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={() => removeBudgetItem(item.id)}\r\n                                className=\"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full text-sm hover:bg-red-600 transition duration-200 flex items-center justify-center\"\r\n                                title=\"Delete this cost category\"\r\n                            >\r\n                                ✕\r\n                            </button>\r\n                        )}\r\n                        <InputField \r\n                            label=\"Category\"\r\n                            type=\"text\" \r\n                            value={item.category} \r\n                            onChange={(val) => handleBudgetItemChange(item.id, 'category', val)}\r\n                            placeholder=\"e.g., Development\"\r\n                            required\r\n                        />\r\n                        <InputField \r\n                            label=\"Description\"\r\n                            type=\"text\" \r\n                            value={item.description} \r\n                            onChange={(val) => handleBudgetItemChange(item.id, 'description', val)}\r\n                            placeholder=\"e.g.,Frontend development tasks\"\r\n                            required\r\n                        />\r\n                        <InputField \r\n                            label=\"Planned Value\"\r\n                            type=\"number\" \r\n                            value={item.estimatedCost === 0 ? '' : item.estimatedCost.toString()} \r\n                            onChange={(val) => handleBudgetItemChange(item.id, 'estimatedCost', parseFloat(val) || 0)}\r\n                            placeholder=\"$0.00\"\r\n                            required\r\n                        />\r\n                        <InputField \r\n                            label=\"Actual Cost\"\r\n                            type=\"number\" \r\n                            value={item.actualCost === 0 ? '' : item.actualCost.toString()} \r\n                            onChange={(val) => handleBudgetItemChange(item.id, 'actualCost', parseFloat(val) || 0)}\r\n                            placeholder=\"$0.00\"\r\n                            required\r\n                        />\r\n                        <InputField \r\n                            label=\"Earned Value\"\r\n                            type=\"number\" \r\n                            value={item.earnedValue === 0 ? '' : item.earnedValue.toString()} \r\n                            onChange={(val) => handleBudgetItemChange(item.id, 'earnedValue', parseFloat(val) || 0)}\r\n                            placeholder=\"$0.00\"\r\n                        />\r\n                        <div className=\"md:col-span-2\">\r\n                            <InputField \r\n                                label=\"Notes\"\r\n                                type=\"text\" \r\n                                value={item.notes} \r\n                                onChange={(val) => handleBudgetItemChange(item.id, 'notes', val)}\r\n                                placeholder=\"Additional notes\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n                \r\n                <div className=\"flex justify-center gap-4 mb-6\">\r\n                    <button type=\"button\" onClick={addBudgetItem} className=\"bg-green-500 text-white px-4 py-2 rounded-full font-semibold shadow-md hover:bg-green-600 transition duration-300\">\r\n                        Add\r\n                    </button>\r\n                    <button type=\"submit\" className=\"bg-blue-600 text-white px-6 py-2 rounded-full font-semibold shadow-lg hover:bg-blue-700 transition duration-300\">\r\n                        Save\r\n                    </button>\r\n                </div>\r\n            </form>\r\n\r\n            <h2 className=\"text-2xl font-bold text-blue-700 mb-4 text-center\">Budget Overview</h2>\r\n            {budgetData.length === 0 ? (\r\n                <p className=\"text-center text-gray-600 p-4 border rounded-lg bg-gray-50\">No budgets are added yet. Add some above!</p>\r\n            ) : (\r\n                <div ref={budgetContentRef} data-pdf-content className=\"space-y-6 scrollable-content\">\r\n                    {budgetData.map((budget, index) => (\r\n                        <div key={budget.id} className=\"bg-gray-50 p-6 rounded-xl shadow-inner border border-gray-200\">\r\n                            <div className=\"flex justify-between items-center mb-4\">\r\n                                <h3 className=\"text-xl font-semibold text-blue-800\">{budget.projectName}</h3>\r\n                                <button\r\n                                    onClick={() => onDeleteBudget(budget.id)}\r\n                                    className=\"px-3 py-1 bg-red-500 text-white text-sm rounded hover:bg-red-600 transition duration-200\"\r\n                                    title=\"Delete budget\"\r\n                                >\r\n                                    🗑️ Delete\r\n                                </button>\r\n                            </div>\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6\">\r\n                                {/* Primary EVM Values */}\r\n                                <div className=\"bg-blue-100 p-4 rounded-lg text-center\">\r\n                                    <p className=\"text-sm text-blue-600 font-medium\">Budget at Completion (BAC)</p>\r\n                                    <p className=\"text-2xl font-bold text-blue-800\">${budget.totalBudget.toFixed(2)}</p>\r\n                                </div>\r\n                                <div className=\"bg-yellow-100 p-4 rounded-lg text-center\">\r\n                                    <p className=\"text-sm text-yellow-600 font-medium\">Planned Value (PV)</p>\r\n                                    <p className=\"text-2xl font-bold text-yellow-800\">${getTotalEstimated(budget).toFixed(2)}</p>\r\n                                </div>\r\n                                <div className=\"bg-purple-100 p-4 rounded-lg text-center\">\r\n                                    <p className=\"text-sm text-purple-600 font-medium\">Earned Value (EV)</p>\r\n                                    <p className=\"text-2xl font-bold text-purple-800\">${getTotalEarnedValue(budget).toFixed(2)}</p>\r\n                                </div>\r\n                                <div className=\"bg-green-100 p-4 rounded-lg text-center\">\r\n                                    <p className=\"text-sm text-green-600 font-medium\">Actual Cost (AC)</p>\r\n                                    <p className=\"text-2xl font-bold text-green-800\">${getTotalActual(budget).toFixed(2)}</p>\r\n                                </div>\r\n                                \r\n                                {/* EVM Variances */}\r\n                                <div className=\"bg-gray-100 p-4 rounded-lg text-center\">\r\n                                    <p className=\"text-sm text-gray-600 font-medium\">\r\n                                        Schedule Variance (SV)\r\n                                    </p>\r\n                                    <p className={`text-xl font-bold ${getScheduleVariance(budget) < 0 ? 'text-red-600' : 'text-black'}`}>\r\n                                        ${getScheduleVariance(budget).toFixed(2)}\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"bg-gray-100 p-4 rounded-lg text-center\">\r\n                                    <p className=\"text-sm text-gray-600 font-medium\">\r\n                                        Cost Variance (CV)\r\n                                    </p>\r\n                                    <p className={`text-xl font-bold ${getCostVariance(budget) < 0 ? 'text-red-600' : 'text-black'}`}>\r\n                                        ${getCostVariance(budget).toFixed(2)}\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                            \r\n                            {/* EVM Performance Indices */}\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\r\n                                <div className={`p-4 rounded-lg text-center ${getSchedulePerformanceIndex(budget) >= 1 ? 'bg-blue-100' : 'bg-red-100'}`}>\r\n                                    <p className={`text-sm font-medium ${getSchedulePerformanceIndex(budget) >= 1 ? 'text-blue-600' : 'text-red-600'}`}>\r\n                                        Schedule Performance Index (SPI)\r\n                                    </p>\r\n                                    <p className={`text-2xl font-bold ${getSchedulePerformanceIndex(budget) >= 1 ? 'text-blue-800' : 'text-red-800'}`}>\r\n                                        {getSchedulePerformanceIndex(budget).toFixed(3)}\r\n                                    </p>\r\n                                    <p className=\"text-xs text-gray-600 mt-1\">\r\n                                        {getSchedulePerformanceIndex(budget) >= 1 ? 'Ahead/On Schedule' : 'Behind Schedule'}\r\n                                    </p>\r\n                                </div>\r\n                                <div className={`p-4 rounded-lg text-center ${getCostPerformanceIndex(budget) >= 1 ? 'bg-purple-100' : 'bg-red-100'}`}>\r\n                                    <p className={`text-sm font-medium ${getCostPerformanceIndex(budget) >= 1 ? 'text-purple-600' : 'text-red-600'}`}>\r\n                                        Cost Performance Index (CPI)\r\n                                    </p>\r\n                                    <p className={`text-2xl font-bold ${getCostPerformanceIndex(budget) >= 1 ? 'text-purple-800' : 'text-red-800'}`}>\r\n                                        {getCostPerformanceIndex(budget).toFixed(3)}\r\n                                    </p>\r\n                                    <p className=\"text-xs text-gray-600 mt-1\">\r\n                                        {getCostPerformanceIndex(budget) >= 1 ? 'Under/On Budget' : 'Over Budget'}\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"overflow-x-auto\">\r\n                                <table className=\"min-w-full bg-white rounded-lg shadow-md\">\r\n                                    <thead className=\"bg-blue-100\">\r\n                                        <tr>\r\n                                            <th className=\"py-2 px-4 text-left text-sm font-semibold text-blue-800\">Category</th>\r\n                                            <th className=\"py-2 px-4 text-left text-sm font-semibold text-blue-800\">Description</th>\r\n                                            <th className=\"py-2 px-4 text-left text-sm font-semibold text-blue-800\">Planned Value (PV)</th>\r\n                                            <th className=\"py-2 px-4 text-left text-sm font-semibold text-blue-800\">Earned Value (EV)</th>\r\n                                            <th className=\"py-2 px-4 text-left text-sm font-semibold text-blue-800\">Actual Cost (AC)</th>\r\n                                            <th className=\"py-2 px-4 text-left text-sm font-semibold text-blue-800\">Notes</th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                        {budget.items.map(item => (\r\n                                            <tr key={item.id} className=\"border-b border-gray-200 hover:bg-gray-50\">\r\n                                                <td className=\"py-2 px-4 text-sm text-gray-800\">{item.category}</td>\r\n                                                <td className=\"py-2 px-4 text-sm text-gray-800\">{item.description}</td>\r\n                                                <td className=\"py-2 px-4 text-sm text-gray-800\">${item.estimatedCost.toFixed(2)}</td>\r\n                                                <td className=\"py-2 px-4 text-sm text-gray-800\">${item.earnedValue.toFixed(2)}</td>\r\n                                                <td className=\"py-2 px-4 text-sm text-gray-800\">${item.actualCost.toFixed(2)}</td>\r\n                                                <td className=\"py-2 px-4 text-sm text-gray-800\">{item.notes}</td>\r\n                                            </tr>\r\n                                        ))}\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n\r\n            <div className=\"flex flex-col sm:flex-row justify-center gap-4 mt-6\">\r\n                <ActionButton\r\n                    onClick={budgetData.length > 0 ? downloadPdf : () => alert('Please add budgets first')}\r\n                    label=\"Download PDF\"\r\n                    icon=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\"\r\n                    color=\"green\"\r\n                />\r\n                <ActionButton\r\n                    onClick={budgetData.length > 0 ? downloadExcel : () => alert('Please add budgets first')}\r\n                    label=\"Download Excel\"\r\n                    icon=\"M13 14l-4-4m0 0l-4 4m4-4v12\"\r\n                    color=\"blue\"\r\n                />\r\n                <ActionButton\r\n                    onClick={budgetData.length > 0 ? () => sendEmail(budgetData, 'Project Budget', 'ProjectBudget') : () => alert('Please add budgets first')}\r\n                    label=\"Send Email\"\r\n                    icon=\"M3 8l4 4 4-4m0 6l-4 4-4-4\"\r\n                    color=\"orange\"\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n// Risk Register Component\r\ninterface RiskRegisterProps {\r\n    onAddRiskRegister: (newRiskRegister: Omit<RiskRegister, 'id'>) => void;\r\n    onDeleteRiskRegister: (id: number) => void;\r\n    riskRegisterData: RiskRegister[];\r\n    riskRegisterContentRef: React.RefObject<HTMLDivElement>;\r\n    downloadPdf: () => void;\r\n    downloadExcel: () => void;\r\n    sendEmail: (content: RiskRegister[], subject: string, filename: string) => void;\r\n}\r\n\r\nconst RiskRegisterComponent: React.FC<RiskRegisterProps> = ({ onAddRiskRegister, onDeleteRiskRegister, riskRegisterData, riskRegisterContentRef, downloadPdf, downloadExcel, sendEmail }) => {\r\n    const [projectName, setProjectName] = useState('');\r\n    const [risks, setRisks] = useState<Risk[]>([\r\n        { id: 1, riskDescription: '', probability: 'Medium', impact: 'Medium', category: '', mitigation: '', owner: '', status: 'Open' }\r\n    ]);\r\n\r\n    const addRisk = () => {\r\n        setRisks(prev => [...prev, { \r\n            id: Date.now(), riskDescription: '', probability: 'Medium', impact: 'Medium', \r\n            category: '', mitigation: '', owner: '', status: 'Open' \r\n        }]);\r\n    };\r\n\r\n    const handleRiskChange = (id: number, field: keyof Risk, value: string) => {\r\n        setRisks(prev => prev.map(risk =>\r\n            risk.id === id ? { ...risk, [field]: value } : risk\r\n        ));\r\n    };\r\n\r\n    const handleSubmit = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        onAddRiskRegister({ projectName, risks });\r\n        setProjectName('');\r\n        setRisks([{ id: 1, riskDescription: '', probability: 'Medium', impact: 'Medium', category: '', mitigation: '', owner: '', status: 'Open' }]);\r\n    };\r\n\r\n    const getRiskLevel = (probability: string, impact: string) => {\r\n        const levels = { Low: 1, Medium: 2, High: 3 };\r\n        const score = levels[probability as keyof typeof levels] * levels[impact as keyof typeof levels];\r\n        if (score >= 6) return { level: 'High', color: 'bg-red-200 text-red-800' };\r\n        if (score >= 4) return { level: 'Medium', color: 'bg-yellow-200 text-yellow-800' };\r\n        return { level: 'Low', color: 'bg-green-200 text-green-800' };\r\n    };\r\n\r\n    return (\r\n        <div className=\"bg-white p-6 rounded-2xl shadow-xl border border-gray-200\">\r\n            <h2 className=\"text-2xl font-bold text-blue-700 mb-6 text-center\">Risk Register</h2>\r\n            \r\n            <form onSubmit={handleSubmit} className=\"mb-8\">\r\n                <div className=\"mb-6\">\r\n                    <InputField label=\"Project Name\" type=\"text\" value={projectName} onChange={setProjectName} required />\r\n                </div>\r\n\r\n                <h3 className=\"text-xl font-semibold text-gray-700 mb-4 border-b pb-2\">Project Risks</h3>\r\n                {risks.map((risk, index) => (\r\n                    <div key={risk.id} className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4 p-4 border border-gray-200 rounded-lg bg-gray-50\">\r\n                        <div className=\"md:col-span-2\">\r\n                            <TextareaField\r\n                                label=\"Description\"\r\n                                value={risk.riskDescription}\r\n                                onChange={(val) => handleRiskChange(risk.id, 'riskDescription', val)}\r\n                                rows={2}\r\n                                placeholder=\"Describe the risk...\"\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Probability</label>\r\n                            <select \r\n                                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm\"\r\n                                value={risk.probability}\r\n                                onChange={(e) => handleRiskChange(risk.id, 'probability', e.target.value)}\r\n                            >\r\n                                <option value=\"Low\">Low</option>\r\n                                <option value=\"Medium\">Medium</option>\r\n                                <option value=\"High\">High</option>\r\n                            </select>\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Impact</label>\r\n                            <select \r\n                                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm\"\r\n                                value={risk.impact}\r\n                                onChange={(e) => handleRiskChange(risk.id, 'impact', e.target.value)}\r\n                            >\r\n                                <option value=\"Low\">Low</option>\r\n                                <option value=\"Medium\">Medium</option>\r\n                                <option value=\"High\">High</option>\r\n                            </select>\r\n                        </div>\r\n                        <InputField \r\n                            label=\"Category\"\r\n                            type=\"text\" \r\n                            value={risk.category} \r\n                            onChange={(val) => handleRiskChange(risk.id, 'category', val)}\r\n                            placeholder=\"e.g., Technical, Financial\"\r\n                        />\r\n                        <InputField \r\n                            label=\"Risk Owner\"\r\n                            type=\"text\" \r\n                            value={risk.owner} \r\n                            onChange={(val) => handleRiskChange(risk.id, 'owner', val)}\r\n                            placeholder=\"e.g., John Doe\"\r\n                        />\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Status</label>\r\n                            <select \r\n                                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm\"\r\n                                value={risk.status}\r\n                                onChange={(e) => handleRiskChange(risk.id, 'status', e.target.value)}\r\n                            >\r\n                                <option value=\"Open\">Open</option>\r\n                                <option value=\"Mitigated\">Mitigated</option>\r\n                                <option value=\"Closed\">Closed</option>\r\n                            </select>\r\n                        </div>\r\n                        <div className=\"md:col-span-1\">\r\n                            <TextareaField\r\n                                label=\"Mitigation Strategy\"\r\n                                value={risk.mitigation}\r\n                                onChange={(val) => handleRiskChange(risk.id, 'mitigation', val)}\r\n                                rows={2}\r\n                                placeholder=\"How to mitigate...\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n                \r\n                <div className=\"flex justify-center gap-4 mb-6\">\r\n                    <button type=\"button\" onClick={addRisk} className=\"bg-green-500 text-white px-4 py-2 rounded-full font-semibold shadow-md hover:bg-green-600 transition duration-300\">\r\n                        Add New Risk\r\n                    </button>\r\n                    <button type=\"submit\" className=\"bg-blue-600 text-white px-6 py-2 rounded-full font-semibold shadow-lg hover:bg-blue-700 transition duration-300\">\r\n                        Save\r\n                    </button>\r\n                </div>\r\n            </form>\r\n\r\n            <h2 className=\"text-2xl font-bold text-blue-700 mb-4 text-center\">Risk Register</h2>\r\n            {riskRegisterData.length === 0 ? (\r\n                <p className=\"text-center text-gray-600 p-4 border rounded-lg bg-gray-50\">No risk registers are added yet. Add some above!</p>\r\n            ) : (\r\n                <div ref={riskRegisterContentRef} data-pdf-content className=\"space-y-6 scrollable-content\">\r\n                    {riskRegisterData.map((register, index) => (\r\n                        <div key={register.id} className=\"bg-gray-50 p-6 rounded-xl shadow-inner border border-gray-200\">\r\n                            <div className=\"flex justify-between items-center mb-4\">\r\n                                <h3 className=\"text-xl font-semibold text-blue-800\">{register.projectName} Risk Register</h3>\r\n                                <button\r\n                                    onClick={() => onDeleteRiskRegister(register.id)}\r\n                                    className=\"px-3 py-1 bg-red-500 text-white text-sm rounded hover:bg-red-600 transition duration-200\"\r\n                                    title=\"Delete risk register\"\r\n                                >\r\n                                    🗑️ Delete\r\n                                </button>\r\n                            </div>\r\n                            <div className=\"overflow-x-auto\">\r\n                                <table className=\"min-w-full bg-white rounded-lg shadow-md\">\r\n                                    <thead className=\"bg-blue-100\">\r\n                                        <tr>\r\n                                            <th className=\"py-2 px-4 text-left text-sm font-semibold text-blue-800\">Risk Description</th>\r\n                                            <th className=\"py-2 px-4 text-left text-sm font-semibold text-blue-800\">Category</th>\r\n                                            <th className=\"py-2 px-4 text-left text-sm font-semibold text-blue-800\">Probability</th>\r\n                                            <th className=\"py-2 px-4 text-left text-sm font-semibold text-blue-800\">Impact</th>\r\n                                            <th className=\"py-2 px-4 text-left text-sm font-semibold text-blue-800\">Risk Level</th>\r\n                                            <th className=\"py-2 px-4 text-left text-sm font-semibold text-blue-800\">Owner</th>\r\n                                            <th className=\"py-2 px-4 text-left text-sm font-semibold text-blue-800\">Status</th>\r\n                                            <th className=\"py-2 px-4 text-left text-sm font-semibold text-blue-800\">Mitigation</th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                        {register.risks.map(risk => {\r\n                                            const riskLevel = getRiskLevel(risk.probability, risk.impact);\r\n                                            return (\r\n                                                <tr key={risk.id} className=\"border-b border-gray-200 hover:bg-gray-50\">\r\n                                                    <td className=\"py-2 px-4 text-sm text-gray-800\">{risk.riskDescription}</td>\r\n                                                    <td className=\"py-2 px-4 text-sm text-gray-800\">{risk.category}</td>\r\n                                                    <td className=\"py-2 px-4 text-sm text-gray-800\">{risk.probability}</td>\r\n                                                    <td className=\"py-2 px-4 text-sm text-gray-800\">{risk.impact}</td>\r\n                                                    <td className=\"py-2 px-4 text-sm text-gray-800\">\r\n                                                        <span className={`px-2 py-1 rounded-full text-xs font-semibold ${riskLevel.color}`}>\r\n                                                            {riskLevel.level}\r\n                                                        </span>\r\n                                                    </td>\r\n                                                    <td className=\"py-2 px-4 text-sm text-gray-800\">{risk.owner}</td>\r\n                                                    <td className=\"py-2 px-4 text-sm text-gray-800\">\r\n                                                        <span className={`px-2 py-1 rounded-full text-xs font-semibold ${\r\n                                                            risk.status === 'Open' ? 'bg-red-200 text-red-800' :\r\n                                                            risk.status === 'Mitigated' ? 'bg-yellow-200 text-yellow-800' :\r\n                                                            'bg-green-200 text-green-800'\r\n                                                        }`}>\r\n                                                            {risk.status}\r\n                                                        </span>\r\n                                                    </td>\r\n                                                    <td className=\"py-2 px-4 text-sm text-gray-800\">{risk.mitigation}</td>\r\n                                                </tr>\r\n                                            );\r\n                                        })}\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n\r\n            <div className=\"flex flex-col sm:flex-row justify-center gap-4 mt-6\">\r\n                <ActionButton\r\n                    onClick={riskRegisterData.length > 0 ? downloadPdf : () => alert('Please add risk register first')}\r\n                    label=\"Download PDF\"\r\n                    icon=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\"\r\n                    color=\"red\"\r\n                />\r\n                <ActionButton\r\n                    onClick={riskRegisterData.length > 0 ? downloadExcel : () => alert('Please add risk register first')}\r\n                    label=\"Download Excel\"\r\n                    icon=\"M13 14l-4-4m0 0l-4 4m4-4v12\"\r\n                    color=\"blue\"\r\n                />\r\n                <ActionButton\r\n                    onClick={riskRegisterData.length > 0 ? () => sendEmail(riskRegisterData, 'Risk Register', 'RiskRegister') : () => alert('Please add risk register first')}\r\n                    label=\"Send Email\"\r\n                    icon=\"M3 8l4 4 4-4m0 6l-4 4-4-4\"\r\n                    color=\"pink\"\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}